(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-22296c74"],{"1b77":function(e,t,i){},"24c0":function(e,t,i){},"2c94":function(e,t,i){"use strict";var s=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{directives:[{name:"show",rawName:"v-show",value:e.visible,expression:"visible"}],staticClass:"select-member-panel",style:{left:e.left,top:e.top}},[i("div",{staticClass:"member-panel-header"},[i("el-row",[i("el-col",{staticStyle:{"border-right":"solid 1px #ddd"},attrs:{span:12}},[i("div",{staticClass:"button",class:{active:"team"===e.type},on:{click:function(t){return e.setType("team")}}},[e._v("团队")])]),i("el-col",{attrs:{span:12}},[i("div",{staticClass:"button",class:{active:"dept"===e.type},on:{click:function(t){return e.setType("dept")}}},[e._v("部门")])])],1),i("i",{directives:[{name:"show",rawName:"v-show",value:e.closeBtn,expression:"closeBtn"}],staticClass:"iconfont icon-guanbi",on:{click:function(t){return e.close(e.xKey)}}})],1),i("div",{staticClass:"member-panel-body"},[i("el-input",{directives:[{name:"show",rawName:"v-show",value:"team"===e.type,expression:"type==='team'"}],attrs:{placeholder:"搜索成员","prefix-icon":"el-icon-search",size:"mini"},on:{input:function(t){return e.setType(e.type,!0)}},model:{value:e.searchKey,callback:function(t){e.searchKey=t},expression:"searchKey"}}),i("el-scrollbar",{staticClass:"scrollbar",style:{height:"team"!==e.type?"424px":"392px"}},[i("el-tree",{attrs:{data:e.tree,props:e.defaultProps,"node-key":"id","default-expanded-keys":["topTree"]},on:{"node-click":e.handleNodeClick},scopedSlots:e._u([{key:"default",fn:function(t){var s=t.node,o=t.data;return i("div",{staticClass:"custom-tree-node"},[o.noAvatar?e._e():i("div",{staticClass:"short"},[i("avatar",{attrs:{user:o}})],1),i("div",{staticClass:"name",staticStyle:{"margin-right":"auto",position:"relative"}},[e._v(e._s(s.label)+" "),i("span",{directives:[{name:"show",rawName:"v-show",value:o.deptId&&e.canSelectDept,expression:"data.deptId && canSelectDept"}],staticClass:"add",on:{click:function(e){e.stopPropagation()}}},[i("i",{staticClass:"iconfont icon-tianjia2",on:{click:function(t){return e.selectDept(o)}}})])]),i("div",{directives:[{name:"show",rawName:"v-show",value:o.checked,expression:"data.checked"}],staticClass:"checked"},[i("i",{staticClass:"iconfont icon-check"})])])}}])})],1)],1)])},o=[],r=i("7150"),a=i("26aa"),l={name:"MemberPanel",components:{avatar:r["a"]},props:{member:Array,xKey:String,top:String,left:String,visible:{type:Boolean,default:function(){return!1}},multi:{type:Boolean,default:function(){return!1}},closeBtn:{type:Boolean,default:function(){return!0}},disabled:{type:Boolean,default:function(){return!1}},canSelectDept:{type:Boolean,default:function(){return!1}}},computed:{userList:function(){return this.$store.getters.userList},userDeptList:function(){return this.$store.getters.userDeptList}},data:function(){return{searchKey:"",type:"team",tree:[],curMember:[],defaultProps:{children:"children",label:"userName"},color:["inverse-blue","inverse-indigo","inverse-purple","inverse-pink","inverse-red","inverse-orange","inverse-yellow","inverse-green","inverse-teal","inverse-cyan","inverse-gray","inverse-gray-dark"]}},watch:{member:function(e){this.curMember=e,this.tree[0]&&this.setTreeCheck()}},created:function(){this.setType("team")},methods:{setType:function(e,t){var i=this;if(this.type=e,"team"===e)if(this.userList&&!t){for(var s in this.tree=[{userName:"所有人员",id:"topTree",children:JSON.parse(this.userList),noAvatar:!0}],this.tree[0].children)this.$set(this.tree[0].children[s],"checked",!1);this.member[0]&&(this.curMember=this.member,this.setTreeCheck())}else{var o={filter:this.searchKey};a["a"].userSearch(o).then((function(e){if(200===e.code){for(var s in e.data.map((function(e){e.id=e.userId})),t||i.$store.dispatch("SetUserList",JSON.stringify(e.data)),i.defaultProps={children:"children",label:"userName"},i.tree=[{userName:"所有人员",id:"topTree",children:e.data,noAvatar:!0}],i.tree[0].children)i.$set(i.tree[0].children[s],"checked",!1);i.member[0]&&(i.curMember=i.member,i.setTreeCheck())}else i.$message.warning({message:e.msg,duration:1500})})).catch((function(e){console.log(e)}))}else this.userDeptList&&!t?(this.tree=this.setDeptTree(JSON.parse(this.userDeptList)),console.log(this.tree)):a["a"].userDeptTree({}).then((function(e){200===e.code?(t||i.$store.dispatch("SetUserDeptList",JSON.stringify(e.data)),i.tree=i.setDeptTree(e.data),console.log(i.tree)):i.$message.warning({message:e.msg,duration:1500})})).catch((function(e){console.log(e)}))},setDeptTree:function(e){var t=[];for(var i in e)if(e[i].subDepts&&e[i].subDepts.length>0&&(e[i].subDepts=this.setDeptTree(e[i].subDepts)),t.push({userName:e[i].deptName,noAvatar:!0,children:e[i].subDepts,deptId:e[i].deptId}),e[i].users&&e[i].users.length>0)for(var s in e[i].users)t[i].children.unshift(e[i].users[s]);return t},setTreeCheck:function(){this.curMember&&this.curMember.length>0?this.tree=this.setTree(this.tree,this.curMember):this.setType(this.type)},setTree:function(e,t){if(e[0]&&t[0]){for(var i in e)for(var s in t){if(e[i].children&&(e[i].children=this.setTree(e[i].children,t)),e[i].id&&(e[i].id===t[s].userId||e[i].id===t[s].id)){e[i].checked=!0;break}e[i].checked=!1}return e}},handleNodeClick:function(e){if(!e.noAvatar){var t=this.member;if(e.id=e.id||e.userId,!e.checked&&e.id)e.checked=!0,t.push(e),this.$emit("setMember",{data:t});else for(var i in t)if(t[i].id===e.id||t[i].userId===e.id){t.splice(i,1),this.$emit("setMember",{data:t});break}}},selectDept:function(e){this.$emit("selectDept",e)},close:function(e){this.$emit("close",e)}}},n=l,c=(i("86b6"),i("4ac2")),u=Object(c["a"])(n,s,o,!1,null,null,null);t["a"]=u.exports},5451:function(e,t,i){},"6d1f":function(e,t,i){"use strict";i("5451")},"70eb":function(e,t,i){"use strict";i.r(t);var s=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("el-container",[s("el-header",{staticClass:"header",nativeOn:{click:function(t){return e.clickEvent.apply(null,arguments)}}},[s("div",{staticClass:"header-wrap"},[s("div",{staticClass:"title gray"},[s("i",{staticClass:"iconfont icon-juseguanli gray fs-32"}),e._v(" 权限管理\n        ")])])]),s("el-main",{staticClass:"main",nativeOn:{click:function(t){return e.clickEvent.apply(null,arguments)}}},[s("el-row",{attrs:{gutter:20}},[s("el-col",{staticStyle:{"overflow-y":"auto"},attrs:{span:6}},[s("el-scrollbar",{style:{height:e.height-100+"px"}},[s("div",{staticClass:"w-100p"},[s("el-button",{staticClass:"mr-10",attrs:{type:"text"},on:{click:e.showCreateRolePanel}},[s("i",{staticClass:"iconfont icon-roles pr-10"}),e._v("新建角色\n              ")])],1),s("el-tree",{staticClass:"dept-tree",attrs:{data:e.tree,props:e.defaultProps,"expand-on-click-node":!0,"highlight-current":!0,"node-key":"id","default-expanded-keys":["role-user"]},on:{"node-click":e.getInfo},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.node,o=t.data;return s("div",{staticClass:"custom-tree-node",class:{on:e.curRole.id===o.id&&!o.roles},style:{marginLeft:"-42px",paddingLeft:"42px"}},[s("i",{staticClass:"iconfont icon-department"}),s("span",[e._v(e._s(i.label))]),s("span",{directives:[{name:"show",rawName:"v-show",value:o.editable,expression:"data.editable"}],staticClass:"ml-10",on:{click:function(e){e.stopPropagation()}}},[s("i",{staticClass:"iconfont",class:{"icon-zhankai":!o.operationVisible,"icon-shouqi1":o.operationVisible},on:{click:function(t){return e.showPanel(o)}}})]),o.operationVisible?s("div",{staticClass:"panel",style:{marginLeft:"42px"},on:{click:function(e){e.stopPropagation()}}},[s("div",{directives:[{name:"show",rawName:"v-show",value:!o.roles,expression:"!data.roles"}],staticClass:"button",on:{click:function(t){return e.operateRole("members",o)}}},[e._v("添加成员")]),s("div",{directives:[{name:"show",rawName:"v-show",value:!o.roles,expression:"!data.roles"}],staticClass:"button",on:{click:function(t){return e.operateRole("edit",o)}}},[e._v("修改角色")]),s("div",{directives:[{name:"show",rawName:"v-show",value:!o.roles,expression:"!data.roles"}],staticClass:"button",on:{click:function(t){return e.operateRole("del",o)}}},[e._v("删除角色")]),s("div",{directives:[{name:"show",rawName:"v-show",value:o.roles,expression:"data.roles"}],staticClass:"button",on:{click:function(t){return e.operateRole("add",o)}}},[e._v("新增角色")]),s("div",{directives:[{name:"show",rawName:"v-show",value:o.roles,expression:"data.roles"}],staticClass:"button",on:{click:function(t){return e.operateRole("rename",o)}}},[e._v("重命名")])]):e._e()])}}])})],1)],1),s("el-col",{attrs:{span:18}},[s("div",{staticClass:"side-header gray"},[s("span",{staticClass:"fs-18"},[e._v(e._s(e.curRole.roleName))]),e._v(e._s(e.curRole.remark)+"\n          ")]),s("div",{staticClass:"header-wrap"},[s("div",{staticClass:"tabs",staticStyle:{float:"left","border-bottom":"solid 1px #eee",width:"100%"}},[s("span",{directives:[{name:"show",rawName:"v-show",value:e.curRole&&e.curRole.viewUser,expression:"curRole && curRole.viewUser"}],staticClass:"item",class:{active:"members"===e.views},staticStyle:{"line-height":"54px"},on:{click:function(t){e.views="members"}}},[e._v("角色成员")]),s("span",{directives:[{name:"show",rawName:"v-show",value:e.curRole&&e.curRole.viewConfig,expression:"curRole && curRole.viewConfig"}],staticClass:"item",class:{active:"limits"===e.views},staticStyle:{"line-height":"54px"},on:{click:function(t){e.views="limits"}}},[e._v("功能权限")]),s("span",{directives:[{name:"show",rawName:"v-show",value:e.curRole&&e.curRole.viewConfig,expression:"curRole && curRole.viewConfig"}],staticClass:"item",class:{active:"data"===e.views},staticStyle:{"line-height":"54px"},on:{click:function(t){e.views="data"}}},[e._v("数据范围")]),s("el-button",{directives:[{name:"show",rawName:"v-show",value:e.curRole.editable||e.curRole.addable,expression:"curRole.editable || curRole.addable"}],staticStyle:{float:"right","margin-top":"15px"},attrs:{type:"primary",plain:"",size:"mini"},on:{click:function(t){return e.operateRole("members",e.curRole)}}},[e._v("添加成员\n              ")]),s("el-button",{directives:[{name:"show",rawName:"v-show",value:e.multipleSelection.length>0,expression:"multipleSelection.length>0"}],staticStyle:{float:"right","margin-top":"15px","margin-right":"10px"},attrs:{type:"primary",plain:"",size:"mini"},on:{click:e.removeMembers}},[e._v("批量移除\n              ")])],1)]),s("div",{staticClass:"w-100p gray",staticStyle:{padding:"20px 0"}},[s("span",{directives:[{name:"show",rawName:"v-show",value:"members"===e.views,expression:"views==='members'"}]},[e._v("全部成员，共"+e._s(e.members.length)+"人")]),s("span",{directives:[{name:"show",rawName:"v-show",value:"limits"===e.views,expression:"views==='limits'"}]},[e._v("\n              设置角色对应的功能操作、应用管理、后台管理权限\n               "),s("el-checkbox",{staticClass:"fr",attrs:{disabled:e.curRole&&!e.curRole.canConfig},on:{change:e.setCheckedAll},model:{value:e.checkedAll,callback:function(t){e.checkedAll=t},expression:"checkedAll"}},[e._v("全选")])],1),s("span",{directives:[{name:"show",rawName:"v-show",value:"data"===e.views,expression:"views==='data'"}]},[e._v("设置该角色的查看、管理数据范围")])]),s("el-scrollbar",{style:{height:e.height-255+"px"}},[s("div",{directives:[{name:"show",rawName:"v-show",value:"members"===e.views,expression:"views==='members'"}]},[e.curMembers.list&&e.curMembers.list.length>0?s("el-table",{directives:[{name:"show",rawName:"v-show",value:e.curMembers.list&&e.curMembers.list.length>0,expression:"curMembers.list && curMembers.list.length>0"}],staticClass:"w-100p",attrs:{data:e.curMembers.list},on:{"selection-change":e.handleSelectionChange}},[s("el-table-column",{attrs:{type:"selection",width:"55"}}),s("el-table-column",{attrs:{label:"姓名"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.curMembers.list[t.$index]?s("div",{staticClass:"flex",staticStyle:{"line-height":"32px"}},[s("avatar",{attrs:{user:e.curMembers.list[t.$index]}}),e._v("   "+e._s(e.curMembers.list[t.$index].userName)+"\n                    ")],1):e._e()]}}],null,!1,2374042934)}),s("el-table-column",{attrs:{prop:"userCode",label:"工号",width:"120"}}),s("el-table-column",{attrs:{prop:"mobileNo",label:"手机号",width:"120"}}),s("el-table-column",{attrs:{prop:"email",label:"邮箱",width:"300"}})],1):e._e(),s("div",{staticClass:"txt-right"},[e.curMembers.list&&e.curMembers.list.length>0?s("el-pagination",{staticStyle:{"margin-top":"20px"},attrs:{"page-size":e.curMembers.pageSize,layout:"total, prev, pager, next, jumper",total:e.curMembers.total},on:{"current-change":e.handleCurrentChange}}):e._e()],1),s("div",{directives:[{name:"show",rawName:"v-show",value:e.curMembers.list&&0===e.curMembers.list.length,expression:"curMembers.list && curMembers.list.length===0"}],staticClass:"w-100p gray",staticStyle:{"text-align":"center","margin-top":"30px"}},[s("img",{attrs:{src:i("c069")}}),s("br"),s("span",{staticStyle:{"font-size":"14px"}},[e._v("暂无数据")]),s("br"),s("br"),s("el-button",{directives:[{name:"show",rawName:"v-show",value:e.curRole.addable,expression:"curRole.addable"}],attrs:{type:"primary"},on:{click:function(t){return e.operateRole("members",e.curRole)}}},[e._v("添加成员")])],1)],1),s("div",{directives:[{name:"show",rawName:"v-show",value:"limits"===e.views,expression:"views==='limits'"}]},[s("table",{staticClass:"table"},e._l(e.resources,(function(t){return s("tr",[s("td",{staticStyle:{width:"180px"}},[s("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:t.remark,placement:"top-start",disabled:!t.remark}},[s("el-checkbox",{attrs:{disabled:e.curRole&&!e.curRole.canConfig},model:{value:t.isSelected,callback:function(i){e.$set(t,"isSelected",i)},expression:"item.isSelected"}},[e._v(e._s(t.resName))])],1)],1),s("td",e._l(t.subRes,(function(t){return s("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:t.remark,placement:"top-start",disabled:!t.remark}},[s("el-checkbox",{attrs:{disabled:e.curRole&&!e.curRole.canConfig},model:{value:t.isSelected,callback:function(i){e.$set(t,"isSelected",i)},expression:"child.isSelected"}},[e._v(e._s(t.resName)+"\n                      ")])],1)})),1)])})),0),s("el-button",{directives:[{name:"show",rawName:"v-show",value:e.curRole&&e.curRole.canConfig,expression:"curRole && curRole.canConfig"}],staticStyle:{"margin-top":"30px"},attrs:{type:"primary",size:"mini",round:""},on:{click:e.saveResources}},[e._v("保存\n              ")])],1),s("div",{directives:[{name:"show",rawName:"v-show",value:"data"===e.views,expression:"views==='data'"}]},[s("table",{staticClass:"table"},[s("thead",{staticStyle:{"font-size":"14px",color:"#666"}},[s("tr",[s("td",[e._v("应用名")]),s("td",[e._v("查看数据范围")]),s("td",[e._v("管理数据范围")])])]),e._l(e.scope,(function(t){return s("tr",[s("td",{staticStyle:{width:"180px","font-size":"14px",color:"#666"}},[e._v("\n                    "+e._s(t.appName)+"\n                  ")]),s("td",[e._l(t.viewScopes,(function(i){return[s("el-radio",{attrs:{disabled:e.curRole&&!e.curRole.canConfig,label:i.value},model:{value:t.viewScopesVal,callback:function(i){e.$set(t,"viewScopesVal",i)},expression:"item.viewScopesVal"}},[e._v(e._s(i.name))])]}))],2),s("td",e._l(t.adminScopes,(function(t){return s("el-checkbox",{attrs:{disabled:e.curRole&&!e.curRole.canConfig},model:{value:t.isSelected,callback:function(i){e.$set(t,"isSelected",i)},expression:"child.isSelected"}},[e._v(e._s(t.name)+"\n                    ")])})),1)])}))],2),s("el-button",{directives:[{name:"show",rawName:"v-show",value:e.curRole&&e.curRole.canConfig,expression:"curRole && curRole.canConfig"}],staticStyle:{"margin-top":"30px"},attrs:{type:"primary",size:"mini",round:""},on:{click:e.saveScope}},[e._v("保存\n              ")])],1)])],1)],1)],1),s("el-dialog",{attrs:{visible:e.roleOperation.add.dialogVisible,width:"600px",top:"50px","show-close":!1},on:{"update:visible":function(t){return e.$set(e.roleOperation.add,"dialogVisible",t)}}},[s("div",{attrs:{slot:"title"},slot:"title"},[s("div",{staticClass:"title"},[s("i",{staticClass:"iconfont icon-roles"}),e._v(" 添加角色\n        ")]),s("div",{staticClass:"options"},[s("i",{staticClass:"iconfont icon-guanbi pointer fs-22",on:{click:function(t){return e.closeDialog("add")}}})]),s("div",{staticClass:"clear"})]),s("div",{staticClass:"dialog-wrap"},[s("el-form",{ref:"form",attrs:{model:e.roleOperation.add.form,"label-width":"80px"}},[s("el-form-item",{attrs:{label:"角色名称",prop:"name",rules:{required:!0,message:"角色名称",trigger:"blur"}}},[s("el-input",{model:{value:e.roleOperation.add.form.name,callback:function(t){e.$set(e.roleOperation.add.form,"name",t)},expression:"roleOperation.add.form.name"}})],1),s("el-form-item",{attrs:{label:"角色组"}},[s("el-select",{attrs:{placeholder:"请选择分组"},model:{value:e.roleOperation.add.form.groupId,callback:function(t){e.$set(e.roleOperation.add.form,"groupId",t)},expression:"roleOperation.add.form.groupId"}},e._l(e.tree,(function(t){return s("el-option",{key:t.groupId,attrs:{label:t.groupName,value:t.groupId}},[s("span",[e._v(e._s(t.groupName))])])})),1)],1),s("el-form-item",{attrs:{label:"描述",prop:"name"}},[s("el-input",{model:{value:e.roleOperation.add.form.remark,callback:function(t){e.$set(e.roleOperation.add.form,"remark",t)},expression:"roleOperation.add.form.remark"}})],1),s("el-form-item",[s("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.createRole}},[e._v("立即创建")]),s("el-button",{attrs:{size:"mini"},on:{click:function(t){e.roleOperation.add.dialogVisible=!1}}},[e._v("取消")])],1)],1)],1)]),s("el-dialog",{attrs:{visible:e.roleOperation.groups.dialogVisible,width:"600px",top:"50px","show-close":!1},on:{"update:visible":function(t){return e.$set(e.roleOperation.groups,"dialogVisible",t)}}},[s("div",{attrs:{slot:"title"},slot:"title"},[s("div",{staticClass:"title"},[s("i",{staticClass:"iconfont icon-menber"}),e._v(" 添加分组\n        ")]),s("div",{staticClass:"options"},[s("i",{staticClass:"iconfont icon-guanbi pointer fs-22",on:{click:function(t){return e.closeDialog("groups")}}})]),s("div",{staticClass:"clear"})]),s("div",{staticClass:"dialog-wrap"},[s("el-form",{ref:"form",attrs:{model:e.roleOperation.groups.form,"label-width":"80px"}},[s("el-form-item",{attrs:{label:"分组名称",prop:"name",rules:{required:!0,message:"分组名称",trigger:"blur"}}},[s("el-input",{model:{value:e.roleOperation.groups.form.name,callback:function(t){e.$set(e.roleOperation.groups.form,"name",t)},expression:"roleOperation.groups.form.name"}})],1),s("el-form-item",[s("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.createGroups}},[e._v("立即创建")]),s("el-button",{attrs:{size:"mini"},on:{click:function(t){e.roleOperation.groups.dialogVisible=!1}}},[e._v("取消")])],1)],1)],1)]),s("members-transfer",{ref:"transfer",attrs:{multi:!0,role:!1,step:!1,users:e.roleOperation.members.form.toList},on:{SAVE_USERS:e.saveMembers}}),s("el-dialog",{attrs:{visible:e.roleOperation.edit.dialogVisible,width:"600px",top:"50px","show-close":!1},on:{"update:visible":function(t){return e.$set(e.roleOperation.edit,"dialogVisible",t)}}},[s("div",{attrs:{slot:"title"},slot:"title"},[s("div",{staticClass:"title"},[s("i",{staticClass:"iconfont icon-roles"}),e._v(" 编辑角色\n        ")]),s("div",{staticClass:"options"},[s("i",{staticClass:"iconfont icon-guanbi pointer fs-22",on:{click:function(t){return e.closeDialog("edit")}}})]),s("div",{staticClass:"clear"})]),s("div",{staticClass:"dialog-wrap"},[s("el-form",{ref:"form",attrs:{model:e.roleOperation.edit.form,"label-width":"80px"}},[s("el-form-item",{attrs:{label:"角色名称",prop:"roleName",rules:{required:!0,message:"角色名称",trigger:"blur"}}},[s("el-input",{model:{value:e.roleOperation.edit.form.roleName,callback:function(t){e.$set(e.roleOperation.edit.form,"roleName",t)},expression:"roleOperation.edit.form.roleName"}})],1),s("el-form-item",{attrs:{label:"所属部门"}},[s("el-select",{attrs:{placeholder:"请选择所属部门"},model:{value:e.roleOperation.edit.form.roleGroup,callback:function(t){e.$set(e.roleOperation.edit.form,"roleGroup",t)},expression:"roleOperation.edit.form.roleGroup"}},e._l(e.tree,(function(t){return s("el-option",{key:t.groupId,attrs:{label:t.groupName,value:t.groupId}},[s("span",[e._v(e._s(t.groupName))])])})),1)],1),s("el-form-item",{attrs:{label:"描述",prop:"name"}},[s("el-input",{model:{value:e.roleOperation.edit.form.remark,callback:function(t){e.$set(e.roleOperation.edit.form,"remark",t)},expression:"roleOperation.edit.form.remark"}})],1),s("el-form-item",[s("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.editRole}},[e._v("保存")]),s("el-button",{attrs:{size:"mini"},on:{click:function(t){e.roleOperation.edit.dialogVisible=!1}}},[e._v("取消")])],1)],1)],1)]),s("el-dialog",{attrs:{visible:e.roleOperation.move.dialogVisible,width:"600px",top:"50px","show-close":!1},on:{"update:visible":function(t){return e.$set(e.roleOperation.move,"dialogVisible",t)}}},[s("div",{attrs:{slot:"title"},slot:"title"},[s("div",{staticClass:"title"},[s("i",{staticClass:"iconfont icon-roles-list"}),e._v(" 移动分组\n        ")]),s("div",{staticClass:"options"},[s("i",{staticClass:"iconfont icon-guanbi pointer fs-22",on:{click:function(t){return e.closeDialog("move")}}})]),s("div",{staticClass:"clear"})]),s("div",{staticClass:"dialog-wrap"},[s("el-form",{ref:"form",attrs:{model:e.roleOperation.move.form,"label-width":"80px"}},[s("el-form-item",{attrs:{label:"所属部门"}},[s("el-select",{attrs:{placeholder:"请选择所属部门"},model:{value:e.roleOperation.move.form.roleGroup,callback:function(t){e.$set(e.roleOperation.move.form,"roleGroup",t)},expression:"roleOperation.move.form.roleGroup"}},e._l(e.tree,(function(t){return s("el-option",{key:t.groupId,attrs:{label:t.groupName,value:t.groupId}},[s("span",[e._v(e._s(t.groupName))])])})),1)],1),s("el-form-item",[s("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.moveRole}},[e._v("保存")]),s("el-button",{attrs:{size:"mini"},on:{click:function(t){e.roleOperation.move.dialogVisible=!1}}},[e._v("取消")])],1)],1)],1)]),s("el-dialog",{attrs:{visible:e.roleOperation.rename.dialogVisible,width:"600px",top:"50px","show-close":!1},on:{"update:visible":function(t){return e.$set(e.roleOperation.rename,"dialogVisible",t)}}},[s("div",{attrs:{slot:"title"},slot:"title"},[s("div",{staticClass:"title"},[s("i",{staticClass:"iconfont icon-roles-list"}),e._v(" 重命名分组\n        ")]),s("div",{staticClass:"options"},[s("i",{staticClass:"iconfont icon-guanbi pointer fs-22",on:{click:function(t){return e.closeDialog("rename")}}})]),s("div",{staticClass:"clear"})]),s("div",{staticClass:"dialog-wrap"},[s("el-form",{ref:"form",attrs:{model:e.roleOperation.rename.form,"label-width":"80px"}},[s("el-form-item",{attrs:{label:"分组名称",prop:"name",rules:{required:!0,message:"分组名称",trigger:"blur"}}},[s("el-input",{model:{value:e.roleOperation.rename.form.name,callback:function(t){e.$set(e.roleOperation.rename.form,"name",t)},expression:"roleOperation.rename.form.name"}})],1),s("el-form-item",[s("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.renameGroup}},[e._v("保存")]),s("el-button",{attrs:{size:"mini"},on:{click:function(t){e.roleOperation.rename.dialogVisible=!1}}},[e._v("取消")])],1)],1)],1)])],1)},o=[],r=(i("a450"),i("2c94")),a=i("7150"),l=i("3528"),n=i("8995"),c={components:{memberPanel:r["a"],avatar:a["a"],membersTransfer:n["a"]},computed:{},data:function(){return{height:"",searchKey:"",defaultProps:{children:"roles",label:"groupName"},tree:[],manageTree:[],manageTreeOption:{add:!1,addBtn:!1,rename:!1,renameBtn:!1,up:!1,upBtn:!1,down:!1,downBtn:!1,del:!1,delBtn:!1},curManageTreeNode:{},deptList:[],curRole:"",deptOperation:{add:{dialogVisible:!1,form:{manager:[],panelVisible:!1}},edit:{dialogVisible:!1,form:{manager:[],panelVisible:!1}},members:{dialogVisible:!1,form:{manager:[],panelVisible:!1,toList:[]}},move:{dialogVisible:!1,form:{id:"",deptName:"",dept:""}},moveDept:{dialogVisible:!1,form:{id:"",deptName:"",dept:""}},manage:{dialogVisible:!1}},members:"",curMembers:{list:"",pageSize:10,pageNum:1,total:0},roleOperation:{add:{dialogVisible:!1,form:{}},groups:{dialogVisible:!1,form:{}},edit:{dialogVisible:!1,form:{}},move:{dialogVisible:!1,form:{}},rename:{dialogVisible:!1,form:{}},members:{dialogVisible:!1,form:{manager:[],panelVisible:!1,toList:[]}}},jobs:[],multipleSelection:[],views:"",resources:"",scope:"",checkedAll:!1}},mounted:function(){var e=this;e.height=document.documentElement.clientHeight,window.onresize=function(){e.height=document.documentElement.clientHeight},this.getRoleTree()},methods:{getRoleTree:function(){var e=this;l["a"].roleTree({fullTree:!0}).then((function(t){200===t.code&&(e.tree=e.setTreeLabel(t.data),e.curRole||e.getInfo(t.data[0].roles[0]))})).catch((function(e){console.log(e)}))},setTreeLabel:function(e){for(var t in e)e[t].groupName=e[t].groupName||e[t].roleName,e[t].id=e[t].id||e[t].groupId,e[t].roles&&e[t].roles.length>0&&this.setTreeLabel(e[t].roles);return e},showCreateRolePanel:function(){this.roleOperation.add={dialogVisible:!0,form:{}}},createRole:function(){var e=this,t={remark:this.roleOperation.add.form.remark,roleGroupId:this.roleOperation.add.form.groupId,roleName:this.roleOperation.add.form.name};l["a"].roleAdd(t).then((function(t){200===t.code&&(e.$message.success({message:"新增角色成功！",duration:1500}),e.roleOperation.add.dialogVisible=!1,e.getRoleTree())})).catch((function(e){console.log(e)}))},showCreateGroupsPanel:function(){this.roleOperation.groups={dialogVisible:!0,form:{}}},createGroups:function(){var e=this,t={groupName:this.roleOperation.groups.form.name};l["a"].roleAddGroup(t).then((function(t){200===t.code&&(e.$message.success({message:"新增分组成功！",duration:1500}),e.roleOperation.groups.dialogVisible=!1,e.getRoleTree())})).catch((function(e){console.log(e)}))},closeDialog:function(e){switch(e){case"add":this.roleOperation.add.dialogVisible=!1;break;case"groups":this.roleOperation.groups.dialogVisible=!1;break;case"members":this.roleOperation.members.dialogVisible=!1;break;case"edit":this.roleOperation.edit.dialogVisible=!1;break;case"move":this.roleOperation.move.dialogVisible=!1;break;case"rename":this.roleOperation.rename.dialogVisible=!1;break}},showPanel:function(e){e.operationVisible?this.$set(e,"operationVisible",!1):(this.tree=this.closeAllPanel(this.tree),this.$set(e,"operationVisible",!0))},closePanel:function(e){this.$set(e,"operationVisible",!1)},closeAllPanel:function(e){for(var t in e)e[t].roles&&(e[t].roles=this.closeAllPanel(e[t].roles)),this.$set(e[t],"operationVisible",!1);return e},operateRole:function(e,t){var i=this;switch(e){case"edit":l["a"].roleDetail(t.id).then((function(e){200===e.code&&(i.roleOperation.edit={dialogVisible:!0,form:{id:e.data.id,remark:e.data.remark,roleName:e.data.roleName,roleGroup:e.data.roleGroup}})})).catch((function(e){console.log(e)}));break;case"members":this.roleOperation.members={dialogVisible:!1,form:{id:t.id,panelVisible:!1,toList:[],defaultProps:{children:"children",label:"userName"}}},this.getRoleMembers(t.id);break;case"move":l["a"].roleDetail(t.id).then((function(e){200===e.code&&(i.roleOperation.move={dialogVisible:!0,form:{id:e.data.id,roleGroup:e.data.roleGroup.roleGroupId}})})).catch((function(e){console.log(e)}));break;case"del":this.$confirm("即将删除角色, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){i.deleteRole(t.id)})).catch((function(){}));break;case"add":this.roleOperation.add={dialogVisible:!0,form:{remark:"",name:"",groupId:t.groupId}};break;case"rename":this.roleOperation.rename={dialogVisible:!0,form:{id:t.groupId,name:t.groupName}};break;case"deleteGroup":this.$confirm("即将删除分组区域以及该分组下面存在"+t.roles.length+"个角色,是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){i.deleteGroup(t.groupId)})).catch((function(){}));break}},editRole:function(){var e=this,t={remark:this.roleOperation.edit.form.remark,roleGroupId:this.roleOperation.edit.form.roleGroup.roleGroupId,roleName:this.roleOperation.edit.form.roleName};l["a"].roleEdit(t,this.roleOperation.edit.form.id).then((function(t){200===t.code&&(e.$message.success({message:"编辑角色成功！",duration:1500}),e.roleOperation.edit.dialogVisible=!1,e.getRoleTree())})).catch((function(e){console.log(e)}))},deleteRole:function(e){var t=this;l["a"].roleDelete(e).then((function(e){200===e.code&&(t.$message.success({message:"角色删除成功",duration:1500}),t.getRoleTree())})).catch((function(e){console.log(e)}))},moveRole:function(){var e=this,t={roleGroupId:this.roleOperation.move.form.roleGroup};l["a"].roleMove(t,this.roleOperation.move.form.id).then((function(t){200===t.code&&(e.$message.success({message:"编辑角色成功！",duration:1500}),e.roleOperation.move.dialogVisible=!1,e.getRoleTree())})).catch((function(e){console.log(e)}))},renameGroup:function(){var e=this,t={groupName:this.roleOperation.rename.form.name};l["a"].groupRename(t,this.roleOperation.rename.form.id).then((function(t){200===t.code&&(e.$message.success({message:"分组重命名成功！",duration:1500}),e.roleOperation.rename.dialogVisible=!1,e.getRoleTree())})).catch((function(e){console.log(e)}))},deleteGroup:function(e){var t=this;l["a"].groupDelete(e).then((function(e){200===e.code&&(t.$message.success({message:"分组删除成功",duration:1500}),t.getRoleTree())})).catch((function(e){console.log(e)}))},getRoleMembers:function(e){var t=this;l["a"].roleUser(e).then((function(e){if(200===e.code){for(var i in e.data)e.data[i].color="inverse-blue",e.data[i].short=e.data[i].userName.substring(e.data[i].userName.length-2);t.roleOperation.members.form.toList=e.data,setTimeout((function(){t.$refs.transfer.show()}),50)}})).catch((function(e){console.log(e)}))},pickMembers:function(e){this.roleOperation.members.form.toList=e.data||[]},removePickMembers:function(e){this.roleOperation.members.form.toList.splice(e,1)},saveMembers:function(e){var t=this;this.roleOperation.members.form.toList=e;var i={userIds:function(){var e=[];for(var i in t.roleOperation.members.form.toList)e.push(t.roleOperation.members.form.toList[i].id||t.roleOperation.members.form.toList[i].userId);return e}()};l["a"].roleMembers(i,this.roleOperation.members.form.id).then((function(e){200===e.code&&(t.$message.success({message:"编辑成员成功！",duration:1500}),t.getInfo(t.curRole))})).catch((function(e){console.log(e)}))},removeMembers:function(){var e=this;this.$confirm("即将移除选中成员, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var t={userIds:function(){var t=[];for(var i in e.multipleSelection)t.push(e.multipleSelection[i].id);return t}()};l["a"].roleMembersRemove(t,e.curRole.id).then((function(t){200===t.code&&(e.$message.success({message:"成员批量移除成功！",duration:1500}),e.getRoleTree(),e.getInfo(e.curRole),e.roleOperation.members.dialogVisible=!1)})).catch((function(e){console.log(e)}))})).catch((function(){}))},getMembers:function(e){var t=this;l["a"].roleUser(e.id).then((function(e){200===e.code&&(t.members=e.data,t.setCurMembers(1))})).catch((function(e){console.log(e)}))},setCurMembers:function(e){var t=this;this.curMembers={list:function(){for(var i=[],s=t.curMembers.pageSize*(e-1);s<t.curMembers.pageSize*e;s++)t.members[s]&&i.push(t.members[s]);return i}(),pageSize:10,pageNum:e,total:this.members.length}},handleCurrentChange:function(e){this.setCurMembers(e)},getResources:function(e){var t=this;l["a"].roleResources(e.id).then((function(e){200===e.code&&(t.resources=e.data)})).catch((function(e){console.log(e)}))},getScope:function(e){var t=this;l["a"].roleScope(e.id).then((function(e){if(200===e.code){for(var i in e.data)for(var s in e.data[i].viewScopesVal="",e.data[i].viewScopes)if(e.data[i].viewScopes[s].isSelected){e.data[i].viewScopesVal=e.data[i].viewScopes[s].value;break}t.scope=e.data,console.log(t.scope)}})).catch((function(e){console.log(e)}))},getInfo:function(e){!e.roles&&e&&e.id&&(this.curRole=e||this.curRole,e.viewUser?(this.views="members",this.getResources(e),this.getMembers(e),this.getScope(e)):(this.views="limits",this.getResources(e),this.getScope(e)))},saveResources:function(){var e=this,t=[];for(var i in this.resources)for(var s in this.resources[i].isSelected&&t.push(this.resources[i].resId),this.resources[i].subRes)this.resources[i].subRes[s].isSelected&&t.push(this.resources[i].subRes[s].resId);l["a"].saveResources({resIds:t},this.curRole.id).then((function(t){200===t.code&&e.$message.success({message:"资源保存成功",duration:1500})})).catch((function(e){console.log(e)}))},saveScope:function(){var e=this,t=[];for(var i in this.scope)for(var s in t[i]={},t[i].appCode=this.scope[i].appCode,t[i].viewScope=this.scope[i].viewScopesVal,t[i].adminScopes=[],this.scope[i].adminScopes)this.scope[i].adminScopes[s].isSelected&&t[i].adminScopes.push(this.scope[i].adminScopes[s].value);l["a"].saveScope({id:this.curRole.id,scopes:t},this.curRole.id).then((function(t){200===t.code&&e.$message.success({message:"数据范围成功",duration:1500})})).catch((function(e){console.log(e)}))},handleSelectionChange:function(e){this.multipleSelection=e},setCheckedAll:function(){for(var e in this.resources)for(var t in this.resources[e].isSelected=this.checkedAll,this.resources[e].subRes)this.resources[e].subRes[t].isSelected=this.checkedAll},clickEvent:function(){this.tree=this.closeAllPanel(this.tree)}}},u=c,d=(i("6d1f"),i("ca41"),i("4ac2")),m=Object(d["a"])(u,s,o,!1,null,"37e8ee1b",null);t["default"]=m.exports},"86b6":function(e,t,i){"use strict";i("1b77")},c069:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAABQCAYAAACOEfKtAAAAAXNSR0IArs4c6QAAC9pJREFUeAHtm1lsVNcZx689NsNiMBiz2BBsjF2C1DRtUoK6YJSHiqRtoLKtVCRd0yfoQ6qkQWrlqpVArdS0UtKHVJVS2qZKIkUUsUUoT1WIWomQRSStUmSzOzYOIWCbxcaecX//6b3W+M7d5w7jSvdIx+fec77zff/zP/t3x4aRhISBhIGEgYSBhIGEgYSBhIEgDFy4cGFFb2/vrsnJyVlB5JF979SpU9sCyt5/+vTpHwSRjUumMi5FQfVMTEyshLxuSPlRkDrI3pXNZtf6yV66dGk+Mi8j2+UnG2f5bSdw9erVxyoqKg6KREbLsrgaMzQ09DN0LSF2x6UziJ7bTqAJ6knSdCaT+WUQkH4yTPNWOuRx4p9bW1vf9pOPs7wsBNLIXkbhM8Tv0fh7Y2jQb9ExlkqlfhqDrlAqykKgENbW1u4muURUGjmcOXNmAyNvC52xu6WlZTCyoogVy0bgkiVLRsC8rbKycq8Xdoh5H5mTbjJVVVV9Im/NmjXPuMkk+QkDCQMJAwkDpWGgojRqi9PKznonZ8Svo6WNHbZR2tgo+kl6OKoc5jD+H+XNhDCjCOR61wFhu4nrIGyS3TdTXV2dwzg+Pj7JNS1FGUUVHxC72Xn3lZvEGUGgrnSMuFcgoz2dTmc4I6bmzZtnMNqm8YOMcf36dYNrW2ZsbEyFR5F5uBznPwtY2QnkJvJpwLzGiFrG2TA1f758Av5hZGTEwIGQYUTq8LyZ282//GvFL1FyAmlgFeRMOEHXyGNavsMoWtbY2JiaNSuQh2tK1a1bt4z+/n4GZmaQ6X6P20j0wjClLOJDyW4ici8xup4mXu/p6fmCEz5NW428KORJnwhXXemQLicbsi0MwmK6vJzEIueVhEBG1kbWKV2/niA+z/R6x46QDaOTvHZN27AjL1+X6kqHdGkTyi/Ts2n7eR6fECZhs8sU8x47gRxBPsu0PASoT7infr6tre2HjJAxO0im1S5tGEHXPHv9/HfpkC50FjgmZFsYhEWYhE0Y8+sX8xwrgeZueoSGiLyvNDc3v+sE7uzZs+uQWafd1qk8Sp50SafOkE71hUWYhI3pfkRYneTC5sVKIL37JADr2RQeBPCAGxjc+l9jZEzqqBJXkC7phBwdwB2DMEHiV4VRWB2FQmbGRiAfi+oAtp1GvMhu6Op+MvG16ZBsP+eFxD5NXLqkk8y2aQW2F91ihFFYhdlWHPo1NgI52D6E9RrAyTvsGQDfaN0wPAVDFkqndPtVMzHWgNl1tPrpsMpjIxBQa4mjjL5/W8pnaiqMwkp0XC/D4I6NQNaUT2FY3zqyfgCQ6dfd1k8ubLl0SrdfPRNjr4nZT9yzPDYCsZImFhxXXKz3AD7Fgu9SHD5buqSTmj0BawurMBcVYiPQ7Pk7gqBhJ3yVtapCjoG4gnRJJ5vJ4YA67wgyWv10xUngMRqwlNvAXX5GOU7IHfWBvCp+skHLpUs6g/gKhVFYkT8WVL+bXGwEAugwgDJMo8fcjOXnI9stl5S8KsUG6ZAu6QyiSxiFde7cuboxFRViI5A750cg2UPcTg97nsWE2HSGHpVLSl6VqEF1pYP6R4M4WE1s25H/Y0NDg75LFxViI1AoWNt+TjJCD+8HaK0fMtarhxm5g3JJRSHRcmdJh3T52RMmYRNGsP7CTz5IeawE6qpEQzox3ArQf/qNRNN/t5kddLCvry8TZjpLVnVUF3ubTV2ubRYWYRI2YfS6aroqcSgoiUOVi3o7Dfsb9uYTf88Vaw/T630H+7ks0wlREpc+xOnncVqXNW1HIK8Dst9wwxI2vyQECgQelwaA/4r4baZYJYv2TbJ19jrIevldydgDjdVHpaeJLcjrUKzDtoWR7Eld1ciuOE18ym3Nw3n6F+ptIaaRn4Nslk78K/EncY08C3uV9RBXCuA0I+oxPC5akzbyLvKypGq5oxmNWIgWeZ3ElZYQDda6mntFn8Gozj0j08LDsxDVjsw+RtRRq05+ipxsynYl+r9FbKKTXkF+D/lBD/35KguenVtUIOafIawQ8QipPks2U+MEcT8X/ANNTU3vAbjgzIfvbgOkaMRthAgdKypxS1XMmTNniji7ZRF58+ZNfZ2bvHHjBpxkdXx5g6n5FGfAgnMdulPnzp37DNe8rej6BvFu5M8SuyHyJdKirpSxEMguWk+D9gJuE4DeIt3JNP07qWM4f/58I+e2ZynsouETixcvrpJXmbqO8m6ZkGNoM7l8+fIEHaGhuhfP9OOrVq1yvQ8zau9H7tfUlYf6dTqsi+8qH7vZ8MsPh9hBmxZpwBykaClxB+vSC169ivx65A8hU79o0aLUwoULQxNnhyEir169aly5ckVu/Y/R/RA4jtvlrHdkKsDxHd6fI36E/BavTc6q55QWRaDIYwr9A8VDxK18eyj4eJRvFPltgP8T61qKXq9ieucXF/3MNNVnTmb5hK5134eUl72U8sXuHsoPEGtZQr4UhcTIBGrasgYdh5Aqps0Gr2mjRkDeI5D9Iutcdvny5eCN9QgqE7mADePixYtZsMnGo5DyklXmlJrLiX74PgG29WGnc6RWaAqYa56m7dYA5Gna7hF5ACwZeSJIHSMbsiWbdNx6J+KsPBO7NpilapPaZpUFSSMRyO75KMo3EXf4TVv1MKAOadpq5AUBFYeMbMmmbAuDl06zDTuQ2aSThJesvSx0gwCUZprsYsi/xfR4wa7Q/s5u+ztk67XmaXTcrmCORP2spN7c8T1Nqy1qE+3TMSywozV0i3RIxkAzaHZi0PMMpXMecp3abePeMDzZMAtlU7Z57TKxuFYz27JTbVMbXQVtBaEJZPR9Ex0nvM55lg0dknXO01GlXEG2hUFY/DCYbTphttFPPFceikC8H4vpqS9TUy4hz0AvttObG3VIpo6nbCkLZVsYhEWYAtjarzaqrQFkjVAEspY8ABBNR52dPAO92Mk6FMtvXzwNBSjULUdYhMlPXG1TG9VWP1mVhyIQ+VZ6J6u7bQDlHRwl5EgIIFpaEWEQFqx0+Fky7+1Z5Fr9ZFUeikB6RseBQQAVOAbyjTFV7kZ2pRwD+fnlfBYWYRI2Lxxm2wbNtnqJ5sqiEOh6UbesYfyLeqbXrayyp/LwKDCN7wsApj8ogaH8gfSOnAa5gIEFXJfWkt6pSKai/i1hBSf6umvXrhX8SPx/NcvzV35F8OsXYbvw4Gh904+McpGOPsnzcB6yP/Ce9+r+GEgKUlL44O6l9zbxrB68j3SVm9rh4WFDH3zwz7mJlCWfs2DuZ8ELFixwsn8O0o4T32TDeZ0R+zbPnkuVlLiOQAhKM4p0R+ygxx4kdbQqJfYA0UW7qOw643iHEE1hN1VNtFmxSzK0eZh4BOF9NTU1B6jr6MEuGIEoqIW4H5PqbljnZs0rnylsaArjpTH49urqXfbSEWeZvNgDAwP6+G5AhsE0Dqv+Ewh8jrq/IZXrbipMI5CGfw72D0Le1HeJKcmQDwKrqazAxb5sGwrrtNxbORyauurUqAHy+pjeW+iAdy0d0wikwfoftLVWYbEp1yf9V5EhR+fs2bN1L43S+5FgaBbgoTZGR0cN3Yn5DXVcm9pJOkIbZi64roGWQDEpd1Cjrq7O0ChQ1DTSbqj7qaaRGhZnUEeJOLn3NW1lX7eQUh6npo3AOKewEzGa1iLS+hkH0yE3MjU6FUWoGq18r6BFXqNbhGmEWdHaIPS/IyKtmOnqZN93CqtSHJuIk/H8PDVeJIoARY0WewBsjkiLTJGjCD67aG5Ui3xFkadOiDkE20TyjQJ06hjDc6hjTL6eIM8iRSSKWD3nk6V3BRGaT6qeRZR5QA5iJqzMMDbCH2OcrNCIUAdpJx0zPQ+yzoPxTdJQB+lpa2CYRkKq61UOPZHOj2HsR5TVVPyQuvodtddVLrD6yAR6WYDc2SzsDaxvKwDcSGwgbxF1aklrea+1nkl1w0mTpy25mnKdDKqtd54VxskfV0q+FkzrXbcDTTUdboeQGbKeSa/wPkDsZ238kE1qgLxR5JKQMJAwkDCQMJAwkDCQMJAwkDCQMJAw8H/OwH8BqNAhE16s7HoAAAAASUVORK5CYII="},ca41:function(e,t,i){"use strict";i("24c0")}}]);