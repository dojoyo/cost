(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6061b722","chunk-2d2082c4"],{3505:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-container",{staticStyle:{background:"#fff",margin:"0",padding:"0"}},[a("el-main",{staticClass:"main",staticStyle:{"overflow-x":"hidden",position:"relative",margin:"0 0 0 -1px",padding:"2px 0 0"}},[a("div",{staticClass:"title"},[a("i",{staticClass:"iconfont icon-richeng_normal",staticStyle:{"padding-right":"10px"}}),e._v("节假日管理")]),a("div",{staticClass:"side-border"}),e.showCalendar?a("FullCalendar",{ref:"fullCalendar",attrs:{height:e.viewHeight,defaultView:"dayGridMonth",locale:"zh-cn",timeZone:e.timeZone,rerenderDelay:100,editable:!0,dropabble:!0,dragRevertDuration:0,plugins:e.calendarPlugins,slotLabelFormat:e.options.slotLabelFormat,header:e.options.header,allDayText:"全天",buttonText:e.options.buttonText,selectable:!0,events:e.curEvents,"custom-buttons":e.customButtons,columnHeaderHtml:e.renderHeader,slotEventOverlap:!0,nowIndicator:!0},on:{eventClick:e.eventClick,datesRender:e.datesRender,select:e.datesSelected}}):e._e()],1),a("el-dialog",{staticClass:"target-wrap table-wrap",attrs:{visible:e.dialogVisible,width:"450px","show-close":!1,top:"50px","close-on-click-modal":!1,"close-on-press-escape":!1},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("div",{staticClass:"header",attrs:{slot:"title"},slot:"title"},[a("div",{staticClass:"title"},[a("i",{staticClass:"iconfont icon-zhishiguanli primary"}),e._v(" 公休假设置\n      ")]),a("div",{staticClass:"options"},[a("i",{staticClass:"iconfont icon-guanbi pointer fs-22",on:{click:function(t){e.dialogVisible=!1}}})]),a("div",{staticClass:"clear"})]),a("el-form",{ref:"form",attrs:{model:e.form,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"日期",prop:"date"}},[a("el-input",{attrs:{placeholder:"",disabled:""},model:{value:e.form.date,callback:function(t){e.$set(e.form,"date",t)},expression:"form.date"}})],1),a("el-form-item",{attrs:{label:"节日名称",prop:"mainTitle"}},[a("el-input",{attrs:{placeholder:"请输入节日名称",disabled:e.form.dateNameDisabled},model:{value:e.form.dateName,callback:function(t){e.$set(e.form,"dateName",t)},expression:"form.dateName"}})],1),a("el-form-item",{attrs:{label:"法定节假日",prop:"dateType"}},[a("el-radio-group",{on:{change:e.setDateName},model:{value:e.form.dateType,callback:function(t){e.$set(e.form,"dateType",t)},expression:"form.dateType"}},e._l(e.enumType.ScheduleDateType,(function(t,n){return a("el-radio",{key:n,attrs:{label:t.value}},[e._v(e._s(t.name))])})),1)],1),a("el-form-item",{attrs:{label:""}},[a("div",{staticClass:"w-100p",staticStyle:{"text-align":"right"}},[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.save()}}},[e._v("保存")]),e.form.canRemove?a("el-button",{attrs:{type:"default",size:"mini"},on:{click:function(t){return e.remove()}}},[e._v("移除")]):e._e(),a("el-button",{attrs:{type:"text"},on:{click:function(t){e.dialogVisible=!1}}},[e._v("取消")])],1)])],1)],1)],1)},i=[],s=a("bee64"),o=s["a"],r=(a("a926"),a("ac8e"),a("4ac2")),l=Object(r["a"])(o,n,i,!1,null,"5ee4f941",null);t["default"]=l.exports},"7da1":function(e,t,a){},a450:function(e,t,a){var n=a("bb8b").f,i=Function.prototype,s=/^\s*function ([^ (]*)/,o="name";o in i||a("26df")&&n(i,o,{configurable:!0,get:function(){try{return(""+this).match(s)[1]}catch(e){return""}}})},a926:function(e,t,a){"use strict";a("f46e")},ac8e:function(e,t,a){"use strict";a("7da1")},bee64:function(e,t,a){"use strict";(function(e){a("a450"),a("e5b4");var n=a("32f0"),i=a("56b8"),s=a("4f23"),o=a("f91b"),r=a("6c86"),l=a("d61d"),d=a("6f3b"),c=a.n(d);t["a"]={components:{FullCalendar:i["a"]},data:function(){var e=this;return{calendarPlugins:[s["d"],o["a"],r["a"]],options:{header:{left:"",center:"",right:"prev,title,next"},droppable:!1},customButtons:{prev:{text:"prev",click:function(t){var a=e.$refs.fullCalendar.getApi(),n=a.getDate();e.setEventTimeRange(c()(n).tz(e.timeZone).valueOf(),""),e.getEvents(),a.prev()}},next:{text:"next",click:function(){var t=e.$refs.fullCalendar.getApi(),a=t.getDate();e.setEventTimeRange("",c()(a).tz(e.timeZone).valueOf()),e.getEvents(),t.next()}}},curEvents:[],eventTimeRange:{min:"",max:"",change:!1},timeZone:"",showCalendar:!1,viewHeight:"",getEventsTimer:"",dateInfos:[],dialogVisible:!1,form:{},enumType:{ScheduleDateType:[]}}},mounted:function(){this.timeZone=c.a.tz.guess(),this.setEventTimeRange(),this.viewHeight=document.body.clientHeight-3,this.init(),this.getEnum("ScheduleDateType")},methods:{getEnum:function(e,t){var a=this;n["a"].getEnum(e).then((function(n){200===n.code&&(console.log(n),t&&n.data.unshift({name:"全部",value:""}),a.$set(a.enumType,e,n.data))})).catch((function(e){console.log(e)}))},setEventTimeRange:function(e,t){var a,n;a=e?c()(e).month(c()(e).month()-1).startOf("month").valueOf():c()().month(c()().month()-1).startOf("month").valueOf(),n=t?c()(t).month(c()(t).month()+1).endOf("month").valueOf():c()().month(c()().month()+1).endOf("month").valueOf(),this.eventTimeRange.min&&(a=a<this.eventTimeRange.min?a:this.eventTimeRange.min),this.eventTimeRange.max&&(n=n>this.eventTimeRange.max?n:this.eventTimeRange.max),this.eventTimeRange={min:a,max:n,change:a===this.eventTimeRange.min||n===this.eventTimeRange.max}},init:function(){this.showCalendar=!1,this.curEvents=[],this.getEvents()},renderHeader:function(e){var t="",a=c()(e).tz(this.timeZone)._d.getDay();switch(parseInt(a)){case 0:t="周日";break;case 1:t="周一";break;case 2:t="周二";break;case 3:t="周三";break;case 4:t="周四";break;case 5:t="周五";break;case 6:t="周六";break}return'<div style="height: 30px;line-height: 30px">'+t+"</div>"},datesRender:function(e){this.setLunar()},setLunar:function(){for(var t=0;t<7;t++)for(var a=0;a<7;a++){var n=e(".fc-day-grid .fc-row").eq(t).find(".fc-day-top").eq(a).attr("data-date");if(n){var i=n.substring(0,4),s=n.substring(5,7),o=n.substring(8,10),r=l["a"].solar2lunar(i,s,o),d="",c="",m="";this.dateInfos[n+""]&&this.dateInfos[n+""].map((function(e){"holiday"!==e.dateType.value&&"festival"!==e.dateType.value&&"solarTerm"!==e.dateType.value||(d+=e.dateName+"、")})),d=d.length>0?d.substring(0,d.length-1):r.IDayCn,e(".fc-day-grid .fc-row").eq(t).find(".fc-day-top").eq(a).append('<span style="float: left; font-size: 12px; color: #999; padding-top: 4px; display: flex; justify-content: flex-start"><span>'+d+"</span>"+c+'</span><span style="margin-left: auto">'+m+"</span>")}}},eventClick:function(e){this.showDetail(e.event.id)},datesSelected:function(e){this.showDetail(e.startStr)},showDetail:function(e){var t=this,a={date:e};n["a"].getDate(a).then((function(e){e&&200===e.code&&(e.data.dateType=e.data.dateType?e.data.dateType.value:"",e.data.canRemove=""!==e.data.dateType,t.form=e.data,t.dialogVisible=!0,console.log(t.form))}))},save:function(){var e=this,t={date:this.form.date,dateName:this.form.dateName,dateType:this.form.dateType};n["a"].setDate(t).then((function(t){t&&200===t.code&&(e.$message.success({message:"操作成功！",duration:1500}),e.dialogVisible=!1,e.getEvents(!0))}))},setDateName:function(){switch(this.form.dateType){case"duty":this.form.dateNameDisabled=!0,this.form.dateName="班";break;case"vacation":this.form.dateNameDisabled=!0,this.form.dateName="休";break;case"holiday":this.form.dateNameDisabled=!1,this.form.dateName="";break;case"festival":this.form.dateNameDisabled=!1,this.form.dateName="";break}},remove:function(){var e=this;this.$confirm("即将移除节假日信息,是否继续？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var t={date:e.form.date,dateName:e.form.dateName,dateType:e.form.dateType};n["a"].removeDate(t).then((function(t){t&&200===t.code&&(e.$message.success({message:"操作成功！",duration:1500}),e.dialogVisible=!1,e.getEvents(!0))}))})).catch((function(e){}))},getEvents:function(e){var t=this;if(!this.getEventsTimer){this.getEventsTimer=!0;var a={startTime:parseInt(this.eventTimeRange.min/1e3),endTime:parseInt(this.eventTimeRange.max/1e3)};n["a"].getDateInfos({startTime:a.startTime,endTime:a.endTime}).then((function(a){var n={},i=[];a.data.map((function(e){n[e.date+""]=e.infos,e.infos&&e.infos.length>0&&e.infos.map((function(a){"vacation"!==a.dateType.value&&"duty"!==a.dateType.value||i.push({id:e.date,title:a.dateType.name,start:c()(e.date).tz(t.timeZone).format(),end:c()(e.date).add(1,"days").tz(t.timeZone).format(),allDay:!0,classNames:function(){var n="";return c()().tz(t.timeZone).valueOf()>1e3*e.endTime&&(n="event-pass "),n+="event-"+a.dateType.value,n}()})}))})),t.dateInfos=n,t.getEventsTimer=!1,t.curEvents=i,t.showCalendar=!0,e&&(setTimeout((function(){t.$refs.fullCalendar.getApi().changeView("timeGridDay")}),50),setTimeout((function(){t.$refs.fullCalendar.getApi().changeView("dayGridMonth")}),100))}))}}}}}).call(this,a("c65b"))},f46e:function(e,t,a){}}]);