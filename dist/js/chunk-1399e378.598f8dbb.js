(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1399e378","chunk-89bdc268","chunk-8810ab2c","chunk-30d28ada","chunk-45d2ce54","chunk-cc7f4570","chunk-56130ed5","chunk-2a71b743","chunk-2d22c102"],{"09d2":function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-dialog",{staticClass:"target-wrap table-wrap",attrs:{visible:e.dialogVisible,width:"1280px","show-close":!1,"append-to-body":!0,"close-on-click-modal":!1,"close-on-press-escape":!1,"before-close":e.viewClose,top:"50px"},on:{"update:visible":function(t){e.dialogVisible=t}}},[i("div",{staticClass:"header",attrs:{slot:"title"},slot:"title"},[i("div",{staticClass:"title"},[e._v("\n      日程统计\n    ")]),i("div",{staticClass:"options"},[i("i",{staticClass:"iconfont icon-guanbi pointer fs-22",on:{click:function(t){e.dialogVisible=!1}}})])]),i("div",{staticClass:"project-wrap"},[i("div",{staticClass:"tabs"},e._l(e.viewList,(function(t,a){return i("div",{key:a,staticClass:"button",class:{on:t.value===e.view},on:{click:function(i){return e.setView(t.value)}}},[e._v(e._s(t.name)+"\n      ")])})),0),"catering"===e.view?i("catering"):e._e()],1)])},s=[],n=i("8cdb"),o={components:{catering:n["default"]},props:{},data:function(){return{dialogVisible:!1,view:"catering",viewList:[{name:"餐补统计",value:"catering",width:"1280px"}]}},mounted:function(){},methods:{show:function(){var e=this;this.dialogVisible=!1,setTimeout((function(){e.dialogVisible=!0}))},viewClose:function(){this.dialogVisible=!1},setView:function(e){this.view=e}}},l=o,r=(i("ab99"),i("4ac2")),c=Object(r["a"])(l,a,s,!1,null,"5bffc3b0",null);t["default"]=c.exports},"11e0":function(e,t,i){},2450:function(e,t,i){},"32f0":function(e,t,i){"use strict";var a=i("b775");t["a"]={getEnum:function(e){return Object(a["a"])({url:"/enum/"+e,method:"get"})},userList:function(e){return Object(a["a"])({url:"/schedule/event/userSearch",method:"get",params:e})},getMyCalendars:function(e){return Object(a["a"])({url:"/schedule/calendar/myCalendars",method:"post",data:e})},getMyAllCalendars:function(e){return Object(a["a"])({url:"/schedule/calendar/allMyCalendars",method:"post",data:e})},getSubscribesCalendars:function(e){return Object(a["a"])({url:"/schedule/calendar/subscribes",method:"post",data:e})},createCalendar:function(e){return Object(a["a"])({url:"/schedule/calendar/create",method:"post",data:e})},editCalendar:function(e,t){return Object(a["a"])({url:"/schedule/calendar/"+t+"/edit",method:"post",data:e})},deleteCalendar:function(e){return Object(a["a"])({url:"/schedule/calendar/"+e+"/delete",method:"post"})},getCalendarDetail:function(e){return Object(a["a"])({url:"/schedule/calendar/"+e,method:"post"})},setCalendar:function(e){return Object(a["a"])({url:"/schedule/calendar/setting",method:"post",data:e})},getAllCalendars:function(e){return Object(a["a"])({url:"/schedule/calendar/query",method:"post",data:e})},subscriptionCalendars:function(e){return Object(a["a"])({url:"/schedule/calendar/subscribe",method:"post",data:e})},selectCalendars:function(e,t){return Object(a["a"])({url:"/schedule/calendar/"+t+"/select",method:"post",data:e})},getEventList:function(e,t){return Object(a["a"])({url:t,method:"post",data:e})},createEvent:function(e){return Object(a["a"])({url:"/schedule/event/create",method:"post",data:e})},editEvent:function(e,t){return Object(a["a"])({url:"/schedule/event/"+t+"/edit",method:"post",data:e})},getEventDetail:function(e,t){return Object(a["a"])({url:"/schedule/event/"+t,method:"get",params:e})},deleteEvent:function(e){return Object(a["a"])({url:"/schedule/event/"+e+"/delete",method:"post"})},setReminder:function(e,t){return Object(a["a"])({url:"/schedule/event/"+t+"/remindSetting",method:"post",data:e})},setReceiveState:function(e,t){return Object(a["a"])({url:"/schedule/event/"+t+"/receiveState/update",method:"post",data:e})},setCompleteState:function(e,t){return Object(a["a"])({url:"/schedule/event/"+t+"/completeState/update",method:"post",data:e})},shareEvent:function(e,t){return Object(a["a"])({url:"/schedule/event/"+t+"/share",method:"post",data:e})},getFile:function(e,t){return Object(a["a"])({url:"https://dev-oss.cgvcap.com/file/"+e+"/"+t,method:"get",responseType:"arraybuffer"})},getFileWithMark:function(e,t){return Object(a["a"])({url:"/schedule/event/"+e+"/attach/"+t,method:"get",responseType:"arraybuffer"})},getMeetingRoom:function(e){return Object(a["a"])({url:"/schedule/meetingRoom/reservation/getEnableMeetingRoom",method:"get",params:e})},saveScore:function(e,t){return Object(a["a"])({url:"/schedule/event/"+t+"/scoring",method:"post",data:e})},addComment:function(e,t){return Object(a["a"])({url:"/comment/"+t+"/add",method:"post",data:e})},deleteComment:function(e){return Object(a["a"])({url:"/comment/"+e+"/delete",method:"post"})},commentList:function(e,t){return Object(a["a"])({url:"/comment/"+t+"/page",method:"post",data:e})},deleteBookMeetingRoom:function(e){return Object(a["a"])({url:"/schedule/meetingRoom/reservation/"+e+"/cancel",method:"post"})},updateEventTime:function(e,t){return Object(a["a"])({url:"/schedule/event/"+t+"/updateTime",method:"post",data:e})},selectAllSchedule:function(){return Object(a["a"])({url:"/schedule/calendar/showAll",method:"post"})},getLikeList:function(e,t){return Object(a["a"])({url:"/like/"+t,method:"post",data:e})},getHasLike:function(e,t){return Object(a["a"])({url:"/like/"+t+"/hasLiked",method:"post",data:e})},setLike:function(e,t,i){return Object(a["a"])({url:e?"/like/"+i+"/add":"/like/"+i+"/delete",method:"post",data:t})},getScheduleEvent:function(e){return Object(a["a"])({url:"/schedule/event/query",method:"post",data:e})},getLocation:function(e){return Object(a["a"])({url:"/schedule/map/regeo",method:"get",params:e})},deptTree:function(e){return Object(a["a"])({url:"/contacts/deptTree",method:"get",params:e})},getStatUserList:function(e){return Object(a["a"])({url:"/schedule/stat/cb/user/list",method:"post",data:e})},confirmStatUserList:function(e,t){return Object(a["a"])({url:"/schedule/stat/cb/user/"+t+"/confirm",method:"post",data:e})},getStatUserDetail:function(e){return Object(a["a"])({url:"/schedule/stat/cb/user/"+e+"/detail",method:"post"})},revokeStatUser:function(e){return Object(a["a"])({url:"/schedule/stat/cb/user/"+e+"/revoke",method:"post"})},getStatDeptList:function(e){return Object(a["a"])({url:"/schedule/stat/cb/dept/list",method:"post",data:e})},confirmStatDeptList:function(e,t){return Object(a["a"])({url:"/schedule/stat/cb/dept/"+t+"/confirm",method:"post",data:e})},getStatDeptDetail:function(e){return Object(a["a"])({url:"/schedule/stat/cb/dept/"+e+"/detail",method:"post"})},getStatFinanceList:function(e){return Object(a["a"])({url:"/schedule/stat/cb/finance/list",method:"post",data:e})},updateStatFinanceList:function(e,t){return Object(a["a"])({url:"/schedule/stat/cb/finance/"+t+"/update",method:"post",data:e})},exportExcelCateringSelf:function(e){return Object(a["a"])({url:"/schedule/stat/cb/user/export",method:"get",params:e,responseType:"arraybuffer"})},exportExcelCateringDept:function(e){return Object(a["a"])({url:"/schedule/stat/cb/dept/export",method:"get",params:e,responseType:"arraybuffer"})},getCateringBatchList:function(e){return Object(a["a"])({url:"/schedule/stat/cb/gen/batchList",method:"post",data:e})},confirmCbStat:function(e){return Object(a["a"])({url:"/schedule/stat/cb/gen/confirmCbStat",method:"post",data:e})},confirmDeptCbStat:function(e){return Object(a["a"])({url:"/schedule/stat/cb/gen/confirmDeptCbStat",method:"post",data:e})},genCbStat:function(e){return Object(a["a"])({url:"/schedule/stat/cb/gen/genCbStat",method:"post",data:e})},getDateInfos:function(e){return Object(a["a"])({url:"/schedule/date/infos",method:"get",params:e})},getDate:function(e){return Object(a["a"])({url:"/schedule/date/get",method:"get",params:e})},setDate:function(e){return Object(a["a"])({url:"/schedule/date/set",method:"post",data:e})},removeDate:function(e){return Object(a["a"])({url:"/schedule/date/delete",method:"post",data:e})},queryCity:function(e){return Object(a["a"])({url:"/sys/region/city/query",method:"get",params:e})}}},"42f7":function(e,t,i){"use strict";i("11e0")},4500:function(e,t,i){},"4e09":function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADMAAAA2CAYAAABqbKGZAAAAAXNSR0IArs4c6QAABYVJREFUaAXVWl1oXEUUnjObbSqtUC1pwDYVGkNNgtRircXGh0hNNiCYNE2pfyBV0qDYihYfWizBN5GIj1W01gdFCE22D9ImJg1UagtGg0gaqVBQQh+qoUXbkr2bneM3t17YbO7embt7l93cl9k5c36+b87M3Jm5S6KED491b+J05mNB4kmEuUhVsUO069TVUoWkUjnmiZ7VnHIuMYtmLwaRmKbqFTuodfCWJ4uylFE6W+TLcfqyieg2t55KH1ikF2GlJGR4or+KmQ764WTBB3W7X1uxspKQEc4ve5i5zg8csrNROFPdfm3FykpChhW/HQQMWQtsD7INaoucDH/X1YKh9HhQUGRtO4/u3hmkU0hb9GQWlFWvs7LTC0Mq0qWZxzvr2RFXkBljJ5EgRfFYQ5TvHWPQMD2jHHHIhoj2qfVUOvNWGP8m3cgywxOdazjFs1itVpmCeu1EdIuqRR21Jm96smLK6DKT4gNhiGjQWAhWi5ToLYZAtm0kZHiyNw4ib2Y7tv2t7aJ6iUZCRsz9tZeFWG9LIFsPc2eDSE3tzZYV+rvoOcMTr6zk+Rs/gUxTwSDcDeh926j15HyhPrRdUZnhsedrVerml8UQ0SAw1JrV/I0veKRrna4X+lhlBhOVxLnujSLNjTibNCpWjcRuJraBSHWhwXPtcERAZuhHkJuRJC6jq2fAdEa0JWex8iFU8LOIjDsRnV8fEgTQzE1KATRRI/puMwJYL7nBIcO36iUceH5johkJoi7JGF0WsS1XqbV/wfPokuGzXX2YiH0QNiELca+x0kvsIhx09DRJOk7tyU+JR3bvUSozWOnATfikkN2SVeY9k+JyaGfiY1IQ1SwHsBYY1+ml+ZqF4nJQuSZJiiN6O74c0ObD6B4nmI9KakuOkuDX8ykuBzmW7jeo4/SIuwPAj08weY4sB+C5GPFyPUqJ4eNavuilmTnT9aEQ6nCuQcXWiT6KJZLvePgWkdHCzNnOz/G23e8pVGxJdFK2D+/P3uYs2WjK9ngvFIYqlgSAAV8SOF/LJqLxLiFDNJih+roXsEKMVyIh4DoHfPs0zlx8S4aZp3D34js9ru+4PFm5S4CdpHvXPk0tJ/71w5KXjFbmsa61nFbniz2v+AUOK8OQmqEqeop2Dc/lsw0ko414vGc9O+kL2FU/mM9JqeUYWn/QStlCrUOzQbGMZLQxj3Y3sFqYKseZBgDvUFxuRUauBBHRbUsWAD8Dajv1O4bagF9bqWU4kA3YENE4rMjcVaz6vtTA/fxLIuu41mRwlMaprgwPCeu49mSY68tABRNWWMe1JqMEP1wOMkoo67jWZHBMsHYaJWl8+LCOa00GADdHCTKEL+u4VmT0xTiCW4/dEEDNqsSb/o9v1LUiI+bm6vHCLMnnbhNCNy7im/R0ux0ZVtaptgkaXidjNW/syIRYUcIDtbGwWwSsyODqpqyZUcxW8a3IYNdqlWa/PsZGMYXt+8+69Gu3kRHbvRasyOBOIDQZfJ647d6c1NTeLxPJx0iXuAHSchsCOTpWmTEeAfh8T4267VzPcZ63CrA4nIqvZeyed6ntmyW3pTy67wGVmf8An1tehJ4xvhdISllL7cOBOMyZueNYZwXIJonlzljH6Zf8iGhgWh7rSL6s9bS+B9Zcmoe6mQzTBlMgzInr6LlXKZHcTh3DF036ul3rUWLrE64d7I02nDHiMJOR9He+QCCRxr3PAK1Z1YAhcAJ146e6bF9E/cq1g73rR/vL9wTg8EzMZFZsmQDIHzwDr4TsDHH8EdwoHqYdX/3jyQsptb3rB/6031wfGI6XRPzRc7ny3LrVBOSR5+pY0Wc4oOFvVTRNQr5PiaFvc51FVcdX52fxn7VjOMw0I2MXKIYLv2cG/zT5/w/Mkso9Pks0kgAAAABJRU5ErkJggg=="},"50fa":function(e,t,i){"use strict";i("b873")},"56f9":function(e,t,i){},"69b0":function(e,t){e.exports=Object.is||function(e,t){return e===t?0!==e||1/e===1/t:e!=e&&t!=t}},"6ce0":function(e,t,i){"use strict";i("4500")},"789f":function(e,t,i){},"8cdb":function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"content"},[a("el-tabs",{attrs:{type:"card"},on:{"tab-click":e.handleClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"我的",name:"my"}},[a("div",{staticClass:"wrap"},[a("div",{staticClass:"w-100p"},[a("el-select",{staticStyle:{width:"70px"},attrs:{placeholder:"请选择流程类型"},on:{change:function(t){e.search.month=""}},model:{value:e.search.type,callback:function(t){e.$set(e.search,"type",t)},expression:"search.type"}},[a("el-option",{attrs:{label:"年",value:"year"}}),a("el-option",{attrs:{label:"月",value:"month"}})],1),a("el-date-picker",{staticStyle:{width:"200px","margin-right":"20px"},attrs:{"value-format":"year"===e.search.type?"yyyy":"yyyy-MM",type:e.search.type,placeholder:"选择周期"},model:{value:e.search.month,callback:function(t){e.$set(e.search,"month",t)},expression:"search.month"}}),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){return e.getDetail()}}},[e._v("查询")]),a("el-button",{staticStyle:{float:"right"},attrs:{type:"text"},on:{click:function(t){return e.exportExcel()}}},[a("i",{staticClass:"iconfont icon-xiazai fs-12"}),e._v(" 导出数据")])],1),a("el-table",{directives:[{name:"show",rawName:"v-show",value:e.list&&e.list.length>0,expression:"list && list.length > 0"}],staticStyle:{width:"100%","margin-top":"20px"},attrs:{data:e.list,height:e.height>800?e.height-450:350,border:"","show-summary":""}},[a("el-table-column",{attrs:{prop:"statUser.userName",label:"姓名",width:"120"}}),a("el-table-column",{attrs:{prop:"deptName",label:"部门",width:"120"}}),a("el-table-column",{attrs:{prop:"statPeriod",label:"时间",width:"120"}}),a("el-table-column",{attrs:{prop:"tripHours",label:"出差时长（小时）",width:"150"}}),a("el-table-column",{attrs:{prop:"cbCount",label:"餐补次数（次）",width:"120"}}),a("el-table-column",{attrs:{prop:"cbAmt",label:"餐补金额（元）",width:"120"}}),a("el-table-column",{attrs:{prop:"remark",label:"个人备注",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticStyle:{position:"relative"}},[e._v("\n                "+e._s(t.row.remark)+"\n                "),a("div",{staticStyle:{position:"absolute",top:"0",left:"0",width:"3px",height:"20px",background:"#fff"}})])]}}])}),a("el-table-column",{attrs:{prop:"cbState.name",label:"状态",width:"80"}}),a("el-table-column",{attrs:{fixed:"right",label:"操作",width:"120",align:"center","header-align":"center"},scopedSlots:e._u([{key:"default",fn:function(t){return["CF"===t.row.cbState.value||"TC"===t.row.cbState.value?a("el-button",{attrs:{type:"text"},on:{click:function(i){return e.showDetailSelf(t.row)}}},[e._v("查看")]):e._e(),"UC"===t.row.cbState.value?a("el-button",{attrs:{type:"text"},on:{click:function(i){return e.showDetailSelf(t.row)}}},[e._v("确认")]):e._e(),"TC"===t.row.cbState.value?a("el-button",{attrs:{type:"text"},on:{click:function(i){return e.revokeSelf(t.row)}}},[e._v("撤销")]):e._e()]}}])})],1),a("div",{directives:[{name:"show",rawName:"v-show",value:e.list&&0===e.list.length,expression:"list && list.length === 0"}],staticClass:"w-100p gray",staticStyle:{"text-align":"center"}},[a("img",{attrs:{src:i("f244")}}),a("br"),a("span",{staticStyle:{"font-size":"14px"}},[e._v("暂无数据")]),a("br"),a("br")])],1)]),a("el-tab-pane",{attrs:{label:"团队",name:"team"}},[a("div",{staticClass:"wrap"},[a("div",{staticClass:"w-100p"},[a("el-select",{staticStyle:{width:"70px"},attrs:{placeholder:"请选择流程类型"},on:{change:function(t){e.search.month=""}},model:{value:e.search.type,callback:function(t){e.$set(e.search,"type",t)},expression:"search.type"}},[a("el-option",{attrs:{label:"年",value:"year"}}),a("el-option",{attrs:{label:"月",value:"month"}})],1),a("el-date-picker",{staticStyle:{width:"200px","margin-right":"20px"},attrs:{"value-format":"year"===e.search.type?"yyyy":"yyyy-MM",type:e.search.type,placeholder:"选择周期"},model:{value:e.search.month,callback:function(t){e.$set(e.search,"month",t)},expression:"search.month"}}),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){return e.getDetail()}}},[e._v("查询")]),a("el-button",{staticStyle:{float:"right"},attrs:{type:"text"},on:{click:function(t){return e.exportExcel()}}},[a("i",{staticClass:"iconfont icon-xiazai fs-12"}),e._v(" 导出数据")])],1),a("el-table",{directives:[{name:"show",rawName:"v-show",value:e.list&&e.list.length>0,expression:"list && list.length > 0"}],staticStyle:{width:"100%","margin-top":"20px"},attrs:{data:e.list,height:e.height>800?e.height-450:350,border:"","show-summary":""}},[a("el-table-column",{attrs:{prop:"deptName",label:"所属部门",width:"150"}}),a("el-table-column",{attrs:{prop:"statPeriod",label:"时间",width:"100"}}),a("el-table-column",{attrs:{prop:"tripHours",label:"出差总时长（小时）",width:"150"}}),a("el-table-column",{attrs:{prop:"cbCount",label:"餐补总次数（次）",width:"140"}}),a("el-table-column",{attrs:{prop:"cbAmt",label:"餐补总金额（元）",width:"140"}}),a("el-table-column",{attrs:{prop:"remark",label:"部门总备注",width:"240"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticStyle:{position:"relative"}},[e._v("\n                "+e._s(t.row.remark)+"\n                "),a("div",{staticStyle:{position:"absolute",top:"0",left:"0",width:"3px",height:"20px",background:"#fff"}})])]}}])}),a("el-table-column",{attrs:{prop:"cbState.name",label:"状态",width:"80"}}),a("el-table-column",{attrs:{fixed:"right",label:"操作",width:"80",align:"center","header-align":"center"},scopedSlots:e._u([{key:"default",fn:function(t){return["CF"===t.row.cbState.value?a("el-button",{attrs:{type:"text"},on:{click:function(i){return e.showDetailTeam(t.row)}}},[e._v("查看")]):e._e(),"UC"===t.row.cbState.value?a("el-button",{attrs:{type:"text"},on:{click:function(i){return e.showDetailTeam(t.row)}}},[e._v("确认")]):e._e()]}}])})],1),a("div",{directives:[{name:"show",rawName:"v-show",value:e.list&&0===e.list.length,expression:"list && list.length === 0"}],staticClass:"w-100p gray",staticStyle:{"text-align":"center"}},[a("img",{attrs:{src:i("f244")}}),a("br"),a("span",{staticStyle:{"font-size":"14px"}},[e._v("暂无数据")]),a("br"),a("br")])],1)]),e.isAdmin?a("el-tab-pane",{attrs:{label:"操作",name:"operation"}},[a("div",{staticClass:"wrap"},[a("div",{staticClass:"w-100p"},[a("el-date-picker",{staticStyle:{width:"200px","margin-right":"20px"},attrs:{"value-format":"yyyy-MM-dd",type:"date",placeholder:"选择时间"},model:{value:e.history.time,callback:function(t){e.$set(e.history,"time",t)},expression:"history.time"}}),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){return e.genCbStat()}}},[e._v("生成出差记录表")]),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){return e.confirmCbStat()}}},[e._v("确认个人餐补统计")]),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){return e.confirmDeptCbStat()}}},[e._v("确认部门餐补统计")])],1),a("el-table",{directives:[{name:"show",rawName:"v-show",value:e.history.list&&e.history.list.length>0,expression:"history.list && history.list.length > 0"}],staticStyle:{width:"100%","margin-top":"20px"},attrs:{data:e.history.list}},[a("el-table-column",{attrs:{prop:"statDate",label:"统计日期"}}),a("el-table-column",{attrs:{prop:"createTime",label:"创建时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n              "+e._s(e._f("DateTimeEn")(t.row.createTime))+"\n            ")]}}],null,!1,2642064063)}),a("el-table-column",{attrs:{prop:"batchType.name",label:"类型"}}),a("el-table-column",{attrs:{prop:"batchCount",label:"统计数"}})],1),a("div",{staticClass:"w-100p",staticStyle:{"text-align":"right"}},[e.history.list&&e.history.list.length>0?a("el-pagination",{staticStyle:{"margin-top":"20px"},attrs:{"current-page":e.history.pageNum,"page-sizes":[5,10,20],"page-size":e.history.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.history.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}):e._e()],1),a("div",{directives:[{name:"show",rawName:"v-show",value:e.history.list&&0===e.history.list.length,expression:"history.list && history.list.length === 0"}],staticClass:"w-100p gray",staticStyle:{"text-align":"center"}},[a("img",{attrs:{src:i("f244")}}),a("br"),a("span",{staticStyle:{"font-size":"14px"}},[e._v("暂无数据")]),a("br"),a("br")])],1)]):e._e()],1),a("self",{ref:"self",on:{refresh:function(t){return e.getDetail()}}}),a("team",{ref:"team"})],1)},s=[],n=(i("d91d"),i("32f0")),o=i("ed08"),l=i("9edc"),r=i("f276"),c={components:{self:l["default"],team:r["default"]},props:{},data:function(){return{activeName:"my",current:{detailView:!1},enumType:{},search:{month:"",type:"year"},list:[],height:"",isAdmin:!1,history:{pageSize:10,pageNum:1,list:[],total:0,time:""}}},watch:{},mounted:function(){this.height=document.body.clientHeight,this.isAdmin=o["a"].hasRight(this.$store.state.user.user.jwtClaims.ar,292),this.getDetail()},methods:{getDetail:function(){var e=this;if("my"===this.activeName){var t={statPeriod:this.search.month};n["a"].getStatUserList(t).then((function(t){200===t.code&&(t.data.map((function(e){e.remark="|"+e.remark})),e.list=t.data)})).catch((function(e){console.log(e)}))}else n["a"].getStatDeptList().then((function(t){200===t.code&&(t.data.map((function(e){e.remark="|"+e.remark})),e.list=t.data)})).catch((function(e){console.log(e)}))},getHistory:function(){var e=this,t={pageSize:this.history.pageSize,pageNum:this.history.pageNum};n["a"].getCateringBatchList(t).then((function(t){200===t.code&&(e.history.list=t.data.list,e.history.total=t.data.total)})).catch((function(e){console.log(e)}))},confirmCbStat:function(){var e=this;if(this.history.time){var t={statDate:this.history.time};n["a"].confirmCbStat(t).then((function(t){200===t.code&&(e.history.time="",e.$message.success({message:"操作成功!",duration:1500}),e.getHistory())})).catch((function(e){console.log(e)}))}else this.$message.warning({message:"请选择日期!",duration:1500})},confirmDeptCbStat:function(){var e=this;if(this.history.time){var t={statDate:this.history.time};n["a"].confirmDeptCbStat(t).then((function(t){200===t.code&&(e.history.time="",e.$message.success({message:"操作成功!",duration:1500}),e.getHistory())})).catch((function(e){console.log(e)}))}else this.$message.warning({message:"请选择日期!",duration:1500})},genCbStat:function(){var e=this;if(this.history.time){var t={statDate:this.history.time};n["a"].genCbStat(t).then((function(t){200===t.code&&(e.history.time="",e.$message.success({message:"操作成功!",duration:1500}),e.getHistory())})).catch((function(e){console.log(e)}))}else this.$message.warning({message:"请选择日期!",duration:1500})},handleClick:function(e){switch(e.paneName){case"my":this.getDetail();break;case"team":this.getDetail();break;case"operation":this.getHistory();break}},handleCurrentChange:function(e){this.history.pageNum=e,this.getHistory()},handleSizeChange:function(e){this.history.pageSize=e,this.history.pageNum=1,this.getHistory()},showDetailSelf:function(e){this.$refs.self.show(e.statId,e.statPeriod)},showDetailTeam:function(e){this.$refs.team.show(e.deptStatId,e.statPeriod)},revokeSelf:function(e){var t=this;this.$confirm("即将撤销《"+e.statPeriod+"餐补统计》，是否继续？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){n["a"].revokeStatUser(e.statId).then((function(e){200===e.code&&(t.$message.success({message:"操作成功!",duration:1500}),t.getDetail())})).catch((function(e){console.log(e)}))})).catch((function(e){console.log(e)}))},exportExcel:function(){var e={statPeriod:this.search.month};"my"===this.activeName?n["a"].exportExcelCateringSelf(e).then((function(e){var t=e.headers,i=decodeURIComponent(t["x-file-name"])||"个人餐补数据.xlsx",a=new Blob([e.data],{type:t["content-type"]}),s=document.createElement("a");s.href=window.URL.createObjectURL(a),s.download=i,s.click()})).catch((function(e){console.log(e)})):n["a"].exportExcelCateringDept(e).then((function(e){var t=e.headers,i=decodeURIComponent(t["x-file-name"])||"团队餐补数据.xlsx",a=new Blob([e.data],{type:t["content-type"]}),s=document.createElement("a");s.href=window.URL.createObjectURL(a),s.download=i,s.click()})).catch((function(e){console.log(e)}))}}},d=c,m=(i("50fa"),i("4ac2")),u=Object(m["a"])(d,a,s,!1,null,"15217d34",null);t["default"]=u.exports},"91ae":function(e,t,i){"use strict";i("afd2")},"9edc":function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-dialog",{staticClass:"target-wrap table-wrap",attrs:{visible:e.dialogVisible,width:"800px","show-close":!1,"append-to-body":!0,"close-on-click-modal":!1,"close-on-press-escape":!1,"before-close":e.viewClose,top:"50px"},on:{"update:visible":function(t){e.dialogVisible=t}}},[i("div",{staticClass:"header",attrs:{slot:"title"},slot:"title"},[i("div",{staticClass:"title"},[e._v("\n      "+e._s(e.name)+e._s(e.time)+"餐补统计("+e._s(e.detail.statState&&e.detail.statState.name)+")\n    ")]),i("div",{staticClass:"options"},[i("i",{staticClass:"iconfont icon-guanbi pointer fs-22",on:{click:function(t){e.dialogVisible=!1}}})])]),e.detail.statTotal?i("div",{staticClass:"w-100p flex space-between"},[i("div",{staticStyle:{width:"450px"}},[i("div",{staticClass:"title-block"},[e._v("合计")]),i("div",{staticClass:"statistics"},[i("div",[i("span",{staticClass:"tips"},[e._v("出差时长")]),i("br"),i("span",{staticClass:"label"},[e._v(e._s(e.detail.statTotal.totalTripHours)+"小时")])]),i("div",{staticClass:"text-center"},[i("span",{staticClass:"tips"},[e._v("餐补次数")]),i("br"),i("span",{staticClass:"label"},[e._v(e._s(e.detail.statTotal.totalCbCount)+"次")])]),i("div",{staticClass:"text-right"},[i("span",{staticClass:"tips"},[e._v("餐补金额")]),i("br"),i("span",{staticClass:"label"},[e._v(e._s(e.detail.statTotal.totalCbAmt)+"元")])])]),i("div",{staticClass:"title-block",staticStyle:{"margin-top":"24px"}},[e._v("明细")]),i("el-scrollbar",{staticStyle:{width:"100%","margin-top":"14px"},style:{height:e.height-450+"px"}},e._l(e.detail.statDetails,(function(t,a){return i("div",{key:a,staticClass:"statistics"},[i("div",{staticClass:"w-100p w-100p flex space-between"},[i("div",[e._v(e._s(e._f("DateTime")(t.cbDate)))]),i("div",{staticClass:"operation"},[i("span",{staticClass:"info"},[e._v("餐补次数")]),i("span",{directives:[{name:"show",rawName:"v-show",value:t.statCbCount!==t.actualCbCount&&"UC"===e.detail.statState.value||"UC"!==e.detail.statState.value,expression:"(item.statCbCount!==item.actualCbCount && detail.statState.value==='UC') || detail.statState.value!=='UC'"}],class:{change:"UC"===e.detail.statState.value&&t.statCbCount!==t.actualCbCount}},[e._v(e._s(t.statCbCount))]),"UC"===e.detail.statState.value?i("span",{staticClass:"icn",on:{click:function(t){return e.reduceCount(a)}}},[e._v("-")]):e._e(),"UC"===e.detail.statState.value?i("span",{staticClass:"num"},[e._v(e._s(t.actualCbCount))]):e._e(),"UC"===e.detail.statState.value?i("span",{staticClass:"icn",staticStyle:{"margin-right":"0"},on:{click:function(t){return e.addCount(a)}}},[e._v("+")]):e._e()])]),e._l(t.statItems,(function(t,a){return i("div",{key:a,staticClass:"w-100p flex mt-10 pointer",on:{click:function(i){return e.showSchedule(t)}}},[i("div",{staticStyle:{width:"120px"}},[e._v(e._s(t.itemTime))]),i("div",{staticStyle:{overflow:"hidden","white-space":"nowrap","text-overflow":"ellipsis"}},[e._v("【"+e._s(t.eventType)+"】"+e._s(t.eventTitle))]),i("div",{staticStyle:{"margin-left":"auto","flex-shrink":"0"}},[e._v(e._s(t.eventCity))])])}))],2)})),0)],1),i("div",{staticStyle:{width:"300px"}},[i("div",{staticClass:"title-block"},[e._v("个人备注")]),"UC"!==e.detail.statState.value||e.name?i("div",{staticClass:"remark-wrap"},[e._v(e._s(e.detail.remark||"无"))]):i("el-input",{staticStyle:{"margin-top":"15px"},attrs:{type:"textarea",autosize:{minRows:3,maxRows:6},placeholder:"请输入内容"},model:{value:e.detail.remark,callback:function(t){e.$set(e.detail,"remark",t)},expression:"detail.remark"}})],1)]):e._e(),i("div",{directives:[{name:"show",rawName:"v-show",value:e.detail.statState&&"UC"===e.detail.statState.value&&!e.name,expression:"detail.statState && detail.statState.value==='UC' && !name"}],staticClass:"footer-block"},[i("el-button",{attrs:{type:"text"},on:{click:e.save}},[i("i",{staticClass:"iconfont icon-queren1",staticStyle:{"margin-right":"10px"}}),e._v(" 确认\n    ")])],1),i("schedule-detail",{ref:"scheduleDetail",on:{REFRESH_CALENDAR:function(t){return e.getMyCalendars(!0)}}}),i("schedule-info",{ref:"scheduleInfo"})],1)},s=[],n=i("32f0"),o=i("cd5c"),l=i("f9a1"),r={components:{scheduleDetail:o["default"],scheduleInfo:l["default"]},props:{},data:function(){return{dialogVisible:!1,time:"",detail:{},name:"",height:""}},mounted:function(){},methods:{show:function(e,t,i){var a=this;this.height=document.body.clientHeight,this.time=t||"",this.name=i||"",this.dialogVisible=!1,setTimeout((function(){n["a"].getStatUserDetail(e).then((function(e){200===e.code&&(a.dialogVisible=!0,a.detail=e.data)})).catch((function(e){console.log(e)}))}))},addCount:function(e){this.detail.statDetails[e].actualCbCount=3===this.detail.statDetails[e].actualCbCount?3:this.detail.statDetails[e].actualCbCount+1},reduceCount:function(e){this.detail.statDetails[e].actualCbCount=0===this.detail.statDetails[e].actualCbCount?0:this.detail.statDetails[e].actualCbCount-1},save:function(){var e=this,t={remark:this.detail.remark,statId:this.detail.statId};this.detail.statDetails.map((function(e,i){t["changeItems["+i+"].actualCbCount"]=e.actualCbCount,t["changeItems["+i+"].cbCode"]=e.cbCode})),n["a"].confirmStatUserList(t).then((function(t){200===t.code&&(e.$message.success({message:"操作成功！",duration:1500}),e.$emit("refresh"),e.viewClose())})).catch((function(e){console.log(e)}))},viewClose:function(){this.dialogVisible=!1},showSchedule:function(e){console.log(e);var t={event:{extendedProps:{isSubscribe:!1},id:e.eventId}};this.$refs.scheduleInfo.showDialog(t)}}},c=r,d=(i("91ae"),i("4ac2")),m=Object(d["a"])(c,a,s,!1,null,"4afbd9c8",null);t["default"]=m.exports},ab99:function(e,t,i){"use strict";i("56f9")},afd2:function(e,t,i){},b873:function(e,t,i){},cd5c:function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-dialog",{staticClass:"target-wrap table-wrap",attrs:{visible:e.detailVisible,width:"450px","append-to-body":!0,"show-close":!1,top:"50px","close-on-click-modal":!1,"close-on-press-escape":!1},on:{"update:visible":function(t){e.detailVisible=t}}},[i("div",{staticClass:"header",attrs:{slot:"title"},slot:"title"},[i("div",{staticClass:"title"},[i("i",{staticClass:"iconfont icon-LPku"}),e._v(" "+e._s(e.detail.id?"编辑":"创建新")+"日历\n    ")]),i("div",{staticClass:"options"},[i("i",{staticClass:"iconfont icon-guanbi pointer fs-22",on:{click:function(t){return e.hideScheduleViewDetail()}}})]),i("div",{staticClass:"clear"})]),i("el-row",[i("el-col",{attrs:{span:24}},[i("el-form",{ref:"detail",staticStyle:{"margin-top":"20px"},attrs:{model:e.detail,"label-width":"80px"}},[i("el-form-item",{attrs:{label:"日历名称",prop:"calendarName",rules:{required:!0,message:"请输入日历名称",trigger:"blur"}}},[i("el-input",{attrs:{placeholder:"日历名称"},model:{value:e.detail.calendarName,callback:function(t){e.$set(e.detail,"calendarName",t)},expression:"detail.calendarName"}})],1),i("el-form-item",{attrs:{label:"日历描述",prop:"calendarDesc"}},[i("el-input",{attrs:{placeholder:"日历描述",type:"textarea",autosize:{minRows:2,maxRows:4}},model:{value:e.detail.calendarDesc,callback:function(t){e.$set(e.detail,"calendarDesc",t)},expression:"detail.calendarDesc"}})],1),i("el-form-item",{attrs:{label:"编辑权限",prop:"members"}},[i("div",{staticStyle:{"font-size":"14px",color:"#999"}},[e._v("(谁可以在此日历下新建及修改日程？)")]),i("div",{staticStyle:{width:"100%",display:"flex","flex-wrap":"wrap"}},[e._l(e.detail.calendarMembers,(function(t,a){return i("div",{key:a,staticClass:"avatar",staticStyle:{"margin-bottom":"15px"}},[i("span",{staticClass:"close",on:{click:function(e){e.stopPropagation()}}},[i("i",{staticClass:"iconfont icon-guanbi",on:{click:function(t){return e.removeMyScheduleDetailMembers(a)}}})]),i("avatar",{attrs:{user:t}})],1)})),i("div",[i("i",{staticClass:"iconfont icon-tianjia pointer fs-22",on:{click:function(t){return e.showMemberTransfer("transferCalendar")}}})])],2)]),i("el-form-item",{attrs:{label:"订阅权限",prop:"members"}},[i("div",{staticStyle:{"font-size":"14px",color:"#999"}},[e._v("(谁可以订阅此日历，默认所有人)")]),i("div",{staticStyle:{width:"100%",display:"flex","flex-wrap":"wrap"}},[e._l(e.detail.subscribeMembers,(function(t,a){return i("div",{key:a,staticClass:"avatar",staticStyle:{"margin-bottom":"15px"}},[i("span",{staticClass:"close",on:{click:function(e){e.stopPropagation()}}},[i("i",{staticClass:"iconfont icon-guanbi",on:{click:function(t){return e.removeMyScheduleDetailSubscribeMembers(a)}}})]),i("avatar",{attrs:{user:t}})],1)})),i("div",[i("i",{staticClass:"iconfont icon-tianjia pointer fs-22",on:{click:function(t){return e.showMemberTransfer("transferSubscribe")}}})])],2)]),i("el-form-item",{attrs:{label:""}},[i("div",{staticClass:"w-100p",staticStyle:{"text-align":"left"}},[i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.submitScheduleDetail()}}},[e._v("确认")]),i("el-button",{attrs:{type:"default",size:"mini"},on:{click:function(t){return e.hideScheduleViewDetail()}}},[e._v("取消")])],1)])],1)],1)],1),i("members-transfer",{ref:"transferCalendar",attrs:{users:e.detail.calendarMembers},on:{SAVE_USERS:e.setCalendarMembers}}),i("members-transfer",{ref:"transferSubscribe",attrs:{users:e.detail.subscribeMembers},on:{SAVE_USERS:e.setSubscribeMembers}})],1)},s=[],n=i("32f0"),o=i("7150"),l=i("8995"),r={components:{avatar:o["a"],membersTransfer:l["a"]},props:{id:String},data:function(){return{detailVisible:!1,detail:{calendarMembers:[],subscribeMembers:[],calendarName:"",calendarDesc:""}}},mounted:function(){},methods:{showScheduleViewDetail:function(e){e?this.getCalendarDetail(e):(this.detail={calendarMembers:[],subscribeMembers:[],calendarName:"",calendarDesc:""},this.detailVisible=!0)},hideScheduleViewDetail:function(){this.detailVisible=!1,this.detail={members:[],name:"",desc:""}},removeMyScheduleDetailMembers:function(e){this.detail.calendarMembers.splice(e,1)},removeMyScheduleDetailSubscribeMembers:function(e){this.detail.subscribeMembers.splice(e,1)},submitScheduleDetail:function(){var e=this;this.$refs["detail"].validate((function(t){t&&(e.detail.calendarId?e.editCalendar():e.createCalendar(),console.log(e.detail),e.hideScheduleViewDetail())}))},createCalendar:function(){var e=this,t={calendarDesc:this.detail.calendarDesc,calendarMembers:function(){var t=[];for(var i in e.detail.calendarMembers)t.push(e.detail.calendarMembers[i].id||e.detail.calendarMembers[i].userId);return t}(),subscribeMembers:function(){var t=[];for(var i in e.detail.subscribeMembers)t.push(e.detail.subscribeMembers[i].id||e.detail.subscribeMembers[i].userId);return t}(),calendarName:this.detail.calendarName};n["a"].createCalendar(t).then((function(t){200===t.code&&(e.$message.success({message:"日历新建成功!",duration:1500}),e.$emit("REFRESH_CALENDAR"),e.hideScheduleViewDetail())})).catch((function(e){console.log(e)}))},editCalendar:function(){var e=this,t={calendarDesc:this.detail.calendarDesc,calendarMembers:function(){var t=[];for(var i in e.detail.calendarMembers)t.push(e.detail.calendarMembers[i].id||e.detail.calendarMembers[i].userId);return t}(),subscribeMembers:function(){var t=[];for(var i in e.detail.subscribeMembers)t.push(e.detail.subscribeMembers[i].id||e.detail.subscribeMembers[i].userId);return t}(),calendarName:this.detail.calendarName};n["a"].editCalendar(t,this.detail.calendarId).then((function(t){200===t.code&&(e.$message.success({message:"日历编辑成功!",duration:1500}),e.$emit("REFRESH_CALENDAR"),e.hideScheduleViewDetail())})).catch((function(e){console.log(e)}))},getCalendarDetail:function(e){var t=this;n["a"].getCalendarDetail(e).then((function(i){200===i.code&&(t.detail=i.data,t.detail={calendarId:e,calendarMembers:i.data.members||[],calendarName:i.data.calendarName,calendarDesc:i.data.calendarDesc,subscribeMembers:i.data.canSubscribeUser||[]},t.detailVisible=!0)})).catch((function(e){console.log(e)}))},setCalendarMembers:function(e){this.detail.calendarMembers=e},setSubscribeMembers:function(e){this.detail.subscribeMembers=e},showMemberTransfer:function(e){this.$refs[""+e].show()}}},c=r,d=i("4ac2"),m=Object(d["a"])(c,a,s,!1,null,"2f9419ec",null);t["default"]=m.exports},d0de:function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{staticClass:"target-wrap table-wrap",attrs:{visible:e.detail.dialogVisible,width:"950px","append-to-body":!0,"show-close":!1,top:"50px","close-on-click-modal":!1,"close-on-press-escape":!1},on:{"update:visible":function(t){return e.$set(e.detail,"dialogVisible",t)}}},[a("div",{staticClass:"header",attrs:{slot:"title"},slot:"title"},[a("div",{staticClass:"title"},[a("i",{staticClass:"iconfont icon-LPku"}),e._v(" "+e._s(e.detail.id?"编辑":"新建")+"日程\n      ")]),a("div",{staticClass:"options"},[a("i",{staticClass:"iconfont icon-guanbi pointer fs-22",on:{click:function(t){return e.closeEditor()}}})]),a("div",{staticClass:"clear"})]),a("el-form",{ref:"detail.form",staticStyle:{"margin-top":"20px"},attrs:{model:e.detail.form,"label-width":"70px"}},[a("div",{staticStyle:{width:"60%",float:"left"}},[a("el-form-item",{attrs:{label:"主题",prop:"eventTitle",rules:{required:!0,message:"完善主题信息",trigger:"blur"}}},[a("div",{staticClass:"w-100p"},[a("el-input",{style:{width:"VA"===e.detail.form.eventType?"445px":"380px"},attrs:{placeholder:"输入日程、会议、活动等标题"},model:{value:e.detail.form.eventTitle,callback:function(t){e.$set(e.detail.form,"eventTitle",t)},expression:"detail.form.eventTitle"}}),"VA"!==e.detail.form.eventType&&"RM"!==e.detail.form.eventType?a("el-checkbox",{staticStyle:{"margin-left":"10px"},model:{value:e.detail.form.IP,callback:function(t){e.$set(e.detail.form,"IP",t)},expression:"detail.form.IP"}},[e._v("重要\n            ")]):e._e(),"RM"===e.detail.form.eventType?a("el-checkbox",{staticStyle:{"margin-left":"10px"},model:{value:e.detail.form.EM,callback:function(t){e.$set(e.detail.form,"EM",t)},expression:"detail.form.EM"}},[e._v("紧急\n            ")]):e._e()],1),a("div",{staticClass:"w-100p mt-15"},[a("el-select",{staticStyle:{width:"100px","margin-right":"10px"},attrs:{placeholder:"选择类型"},on:{change:function(t){return e.getEnumSubType()}},model:{value:e.detail.form.eventType,callback:function(t){e.$set(e.detail.form,"eventType",t)},expression:"detail.form.eventType"}},e._l(e.enumType.ScheduleEventType,(function(e){return a("el-option",{key:e.value,attrs:{label:e.name,value:e.value}})})),1),e.enumType.ScheduleEventSubType&&e.enumType.ScheduleEventSubType.length>0?a("el-select",{staticStyle:{width:"160px","margin-right":"10px"},attrs:{placeholder:"选择类型"},model:{value:e.detail.form.subType,callback:function(t){e.$set(e.detail.form,"subType",t)},expression:"detail.form.subType"}},e._l(e.enumType.ScheduleEventSubType,(function(e){return a("el-option",{key:e.value,attrs:{label:e.name,value:e.value}})})),1):e._e(),a("el-checkbox",{directives:[{name:"show",rawName:"v-show",value:!("VA"===e.detail.form.eventType||"RM"===e.detail.form.eventType||"OT"===e.detail.form.eventType),expression:"!(detail.form.eventType==='VA' || detail.form.eventType==='RM' || detail.form.eventType==='OT')"}],staticStyle:{"margin-left":"10px"},model:{value:e.detail.form.isTravel,callback:function(t){e.$set(e.detail.form,"isTravel",t)},expression:"detail.form.isTravel"}},[e._v("\n              是否差旅\n              "),a("el-tooltip",{attrs:{content:"若选中，则此条日程会计算您的差旅/外勤误餐费。",placement:"top",effect:"dark"}},[a("i",{staticClass:"iconfont icon-shuomingtishi fs-14 color-gray"})])],1)],1)]),a("el-form-item",{attrs:{label:"时间",prop:"time",rules:{required:!0,message:"选择时间",trigger:"blur"}}},[a("el-date-picker",{staticStyle:{width:"380px","margin-right":"10px"},attrs:{type:e.detail.form.fullDay?"daterange":"datetimerange","range-separator":"~",format:(e.detail.form.fullDay,"yyyy-MM-dd HH:mm"),editable:!1,clearable:!1,"picker-options":{step:"00:15"},"start-placeholder":"开始日期","end-placeholder":"结束日期"},on:{change:e.resetInfo},model:{value:e.detail.form.time,callback:function(t){e.$set(e.detail.form,"time",t)},expression:"detail.form.time"}}),a("el-checkbox",{on:{change:e.resetTime},model:{value:e.detail.form.fullDay,callback:function(t){e.$set(e.detail.form,"fullDay",t)},expression:"detail.form.fullDay"}},[e._v("全天")])],1),"VA"!==e.detail.form.eventType?a("el-form-item",{attrs:{label:"地点",prop:"eventCity",rules:{required:e.detail.form.isTravel,message:"请选择地点",trigger:"blur"}}},[a("el-select",{ref:"eventCity",staticStyle:{width:"120px","margin-right":"10px"},attrs:{filterable:"","reserve-keyword":"",placeholder:"请输入城市","filter-method":e.filterMethod},model:{value:e.detail.form.eventCity,callback:function(t){e.$set(e.detail.form,"eventCity",t)},expression:"detail.form.eventCity"}},e._l(e.eventCityList,(function(t,i){return a("el-option",{key:i,attrs:{label:t.cityName,value:t.cityName}},[a("div",[a("span",{staticStyle:{"font-size":"14px",color:"#333"}},[e._v(e._s(t.cityName))]),a("span",{staticStyle:{"font-size":"12px",color:"#888","padding-left":"10px"}},[e._v(e._s(t.cityPath))])])])})),1),a("el-input",{staticStyle:{width:"315px"},attrs:{placeholder:"输入详细地址"},model:{value:e.detail.form.eventAddr,callback:function(t){e.$set(e.detail.form,"eventAddr",t)},expression:"detail.form.eventAddr"}},[a("template",{slot:"append"},[a("el-button",{staticStyle:{padding:"0 10px"},attrs:{type:"text"},on:{click:e.showMap}},[a("span",{staticClass:"iconfont icon-didianx"})])],1)],2)],1):e._e(),"VA"!==e.detail.form.eventType?a("el-form-item",{attrs:{label:"会议室"}},[a("el-input",{staticStyle:{width:"445px"},attrs:{disabled:!0,placeholder:"请选择会议室"},model:{value:e.meetingRoom.form.inputTips,callback:function(t){e.$set(e.meetingRoom.form,"inputTips",t)},expression:"meetingRoom.form.inputTips"}},[a("template",{slot:"append"},["RM"!==e.detail.form.eventType?a("el-button",{staticStyle:{padding:"0 10px"},attrs:{type:"text"},on:{click:e.showBookingRoom}},[a("span",{staticClass:"iconfont icon-xianshanghuiyishix"})]):e._e()],1)],2)],1):e._e(),a("el-form-item",{attrs:{label:"描述",prop:"eventDesc"}},[a("el-input",{staticStyle:{width:"445px"},attrs:{placeholder:"输入描述",type:"textarea",autosize:{minRows:4,maxRows:6}},model:{value:e.detail.form.eventDesc,callback:function(t){e.$set(e.detail.form,"eventDesc",t)},expression:"detail.form.eventDesc"}}),e._l(e.detail.form.subFiles,(function(t,i){return a("div",{key:i},[a("el-checkbox",{staticStyle:{"margin-right":"10px"},on:{change:e.setFileStatus},model:{value:t.checked,callback:function(i){e.$set(t,"checked",i)},expression:"item.checked"}}),e._v("\n            "+e._s(t.attachName)+"\n            "),a("span",{directives:[{name:"show",rawName:"v-show",value:t.canDownload,expression:"item.canDownload"}],staticStyle:{padding:"3px 5px","font-size":"12px",color:"#fff",background:"#999","border-radius":"3px","margin-left":"10px"}},[e._v("可下载")])],1)})),a("div",{staticStyle:{display:"flex","align-items":"flex-start"}},[a("el-upload",{ref:"uploadSubFiles",attrs:{action:e.uploadPDFURL,headers:e.headers,"show-file-list":!1,data:e.uploadPDFData,multiple:!0,"on-change":e.onChangeFileSubFile}},[a("el-button",{staticStyle:{color:"#3f6eb8"},attrs:{type:"text"}},[e._v("添加附件")])],1),e.detail.form.subFiles&&e.detail.form.subFiles.length>0?a("el-button",{staticStyle:{color:"#3f6eb8","margin-left":"10px"},attrs:{type:"text"},on:{click:e.removeSubFiles}},[e._v("删除附件")]):e._e(),e.detail.form.subFiles&&e.detail.form.subFiles.length>0?a("el-button",{staticStyle:{color:"#3f6eb8","margin-left":"10px"},attrs:{type:"text"},on:{click:e.setSubFilesDownload}},[e._v(e._s(e.fileStatus?"禁止下载":"允许下载"))]):e._e()],1)],2),"VA"!==e.detail.form.eventType?a("el-form-item",{attrs:{label:"提醒",prop:"name"}},[a("el-select",{staticStyle:{width:"120px","margin-right":"10px"},attrs:{placeholder:"选择时间"},model:{value:e.detail.form.remindTime,callback:function(t){e.$set(e.detail.form,"remindTime",t)},expression:"detail.form.remindTime"}},e._l(e.enumType.ScheduleReminderPeriod,(function(e){return a("el-option",{key:e.value,attrs:{label:e.name,value:e.value}})})),1),a("el-select",{directives:[{name:"show",rawName:"v-show",value:"N"!==e.detail.form.remindTime,expression:"detail.form.remindTime!=='N'"}],staticStyle:{width:"315px"},attrs:{multiple:"",placeholder:"选择提醒类型"},model:{value:e.detail.form.remindType,callback:function(t){e.$set(e.detail.form,"remindType",t)},expression:"detail.form.remindType"}},e._l(e.enumType.ScheduleReminderType,(function(e){return a("el-option",{key:e.value,attrs:{label:e.name,value:e.value}})})),1)],1):e._e(),a("el-form-item",{attrs:{label:"日历",prop:"calendar",rules:{required:!0,message:"选择日历！",trigger:"blur"}}},[a("el-select",{staticStyle:{width:"445px"},attrs:{placeholder:"选择日历"},model:{value:e.detail.form.calendar,callback:function(t){e.$set(e.detail.form,"calendar",t)},expression:"detail.form.calendar"}},e._l(e.scheduleList,(function(e){return a("el-option",{key:e.calendarId,attrs:{label:e.calendarName,value:JSON.stringify(e)}})})),1)],1),a("el-form-item",{attrs:{label:"归类",prop:"belongDept"}},[a("el-select",{staticStyle:{width:"130px","margin-right":"10px"},attrs:{placeholder:"请选择归属部门"},model:{value:e.detail.form.belongDept,callback:function(t){e.$set(e.detail.form,"belongDept",t)},expression:"detail.form.belongDept"}},e._l(e.enumType.deptList,(function(e){return a("el-option",{key:e.value,attrs:{label:e.name,value:e.value}})})),1),a("el-input",{staticStyle:{width:"305px"},attrs:{placeholder:"分类标签，如关联项目、尽调、股权交割等"},model:{value:e.detail.form.remark,callback:function(t){e.$set(e.detail.form,"remark",t)},expression:"detail.form.remark"}})],1)],1),a("div",{staticStyle:{width:"40%",float:"left","margin-left":"0"}},[a("el-form-item",{attrs:{label:"参与者",prop:"users",rules:{required:!0,message:"选择参与者",trigger:"blur"}}},[a("el-select",{staticStyle:{width:"285px"},attrs:{filterable:"",multiple:"","collapse-tags":"",placeholder:"选择参与者"},model:{value:e.userSelected,callback:function(t){e.userSelected=t},expression:"userSelected"}},e._l(e.userList,(function(e){return a("el-option",{key:e.id,attrs:{label:e.eventUser.userName+"  "+e.deptName,value:JSON.stringify(e)}})})),1),a("div",{staticStyle:{"margin-top":"10px","margin-left":"-50px"}},[e._l(e.detail.form.users,(function(t,i){return a("el-tooltip",{key:i,attrs:{effect:"dark",disabled:!t.isConflict,content:"时间冲突",placement:"top"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:i>=(e.detail.form.userPageNum-1)*e.detail.form.userPageSize&&i<e.detail.form.userPageNum*e.detail.form.userPageSize,expression:"(index>=(detail.form.userPageNum-1)*detail.form.userPageSize) && (index<detail.form.userPageNum*detail.form.userPageSize)"}],staticClass:"avatar",class:{"no-conflict":!t.isConflict,conflict:t.isConflict},staticStyle:{"margin-bottom":"15px",display:"flex","align-items":"center"}},[a("avatar",{attrs:{user:t.eventUser}}),a("span",{staticStyle:{"margin-right":"auto","margin-left":"10px"}},[e._v(e._s(t.eventUser&&t.eventUser.userName))]),a("i",{staticClass:"iconfont icon-guanbi pointer",on:{click:function(t){return e.removeScheduleDetailUsers(i)}}})],1)])})),a("el-pagination",{directives:[{name:"show",rawName:"v-show",value:e.detail.form.users.length>e.detail.form.userPageSize,expression:"detail.form.users.length>detail.form.userPageSize"}],attrs:{small:"",layout:"prev, pager, next","pager-count":5,"current-page":e.detail.form.userPageNum,"page-size":e.detail.form.userPageSize,total:e.detail.form.users.length},on:{"current-change":e.handleUsersChange}})],2)],1),a("div",{staticStyle:{"padding-left":"18px","margin-top":"10px"}},[e._v("外部参与者")]),a("div",{staticStyle:{"padding-left":"18px","margin-top":"5px"}},[a("el-input",{staticStyle:{width:"335px"},attrs:{placeholder:"输入外部参与者，多个用逗号隔开。"},model:{value:e.detail.form.outerUsers,callback:function(t){e.$set(e.detail.form,"outerUsers",t)},expression:"detail.form.outerUsers"}})],1)],1),a("div",{staticClass:"clear"}),a("el-form-item",{attrs:{label:""}},[a("div",{staticClass:"w-100p",staticStyle:{"text-align":"left"}},[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.save()}}},[e._v("确认")]),a("el-button",{attrs:{type:"default",size:"mini"},on:{click:e.closeEditor}},[e._v("取消")])],1)])],1),a("el-dialog",{attrs:{visible:e.meetingRoom.dialogVisible,width:"650px","append-to-body":!0,"show-close":!1,top:"50px","close-on-click-modal":!1,"close-on-press-escape":!1},on:{"update:visible":function(t){return e.$set(e.meetingRoom,"dialogVisible",t)}}},[a("div",{staticClass:"header",attrs:{slot:"title"},slot:"title"},[a("div",{staticClass:"title"},[a("i",{staticClass:"iconfont icon-huiyishiguanli"}),e._v(" 预订会议室--时间段："+e._s(e.meetingRoom.tips)+"\n        ")]),a("div",{staticClass:"options"},[a("i",{staticClass:"iconfont icon-guanbi pointer fs-22",on:{click:function(t){e.meetingRoom.dialogVisible=!1}}})]),a("div",{staticClass:"clear"})]),a("el-form",{ref:"meetingRoom.form",staticStyle:{"margin-top":"20px"},attrs:{model:e.meetingRoom.form,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"线上会议室"}},[a("div",{staticStyle:{display:"flex"}},[a("el-input",{staticStyle:{width:"350px","margin-right":"10px"},attrs:{placeholder:"添加视频会议号（选填）"},model:{value:e.meetingRoom.form.conferenceCode,callback:function(t){e.$set(e.meetingRoom.form,"conferenceCode",t)},expression:"meetingRoom.form.conferenceCode"}}),a("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"会议密码（选填）"},model:{value:e.meetingRoom.form.conferencePwd,callback:function(t){e.$set(e.meetingRoom.form,"conferencePwd",t)},expression:"meetingRoom.form.conferencePwd"}})],1)]),a("div",{staticStyle:{padding:"0 0 20px 18px"}},[e._v("线下会议室"),a("span",{staticStyle:{"font-weight":"bold"}},[e._v("（可用会议室）")])]),a("el-form-item",{attrs:{label:""}},[e._l(e.meetingRoom.list,(function(t,i){return a("div",{key:i,staticClass:"wrap"},[a("img",{staticClass:"avatar",attrs:{src:t.meetingRoomImg}}),a("div",{staticClass:"content"},[a("div",{staticClass:"title"},[e._v(e._s(t.meetingRoomName))]),a("div",{staticClass:"tags"},[e._v("\n                "+e._s(t.devicesStr||"无设备")+"\n              ")]),a("div",{staticClass:"tips",staticStyle:{display:"flex","align-items":"center"}},[a("i",{staticClass:"iconfont icon-huiyishiyuding",staticStyle:{"margin-right":"10px"}}),a("span",{staticStyle:{"margin-right":"20px","flex-shrink":"0"}},[e._v(e._s(t.capacity))]),a("i",{staticClass:"iconfont icon-didianx",staticStyle:{"margin-right":"10px"}}),e._v("\n                "+e._s(t.address)+"\n              ")])]),a("el-button",{attrs:{type:"text"}},[a("el-radio",{attrs:{label:t.meetingRoomId},on:{change:function(i){return e.pickMeetingRoom(t)}},model:{value:e.meetingRoom.form.meetingRoomId,callback:function(t){e.$set(e.meetingRoom.form,"meetingRoomId",t)},expression:"meetingRoom.form.meetingRoomId"}},[e._v(" \n              ")])],1)],1)})),a("div",{directives:[{name:"show",rawName:"v-show",value:e.meetingRoom.list&&0===e.meetingRoom.list.length,expression:"meetingRoom.list && meetingRoom.list.length===0"}],staticClass:"w-100p gray",staticStyle:{"text-align":"center"}},[a("img",{attrs:{src:i("f244")}}),a("br"),a("span",{staticStyle:{"font-size":"14px"}},[e._v("当前时间段无可用会议室")]),a("br"),a("br")])],2),a("el-form-item",{attrs:{label:""}},[a("div",{staticClass:"w-100p",staticStyle:{"text-align":"left"}},[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.saveMeetingRoom()}}},[e._v("确认")]),a("el-button",{attrs:{type:"default",size:"mini"},on:{click:function(t){e.meetingRoom.dialogVisible=!1}}},[e._v("取消")])],1)])],1)],1),a("el-dialog",{attrs:{visible:e.map.dialogVisible,width:"850px","append-to-body":!0,"show-close":!1,top:"50px","close-on-click-modal":!1,"close-on-press-escape":!1},on:{"update:visible":function(t){return e.$set(e.map,"dialogVisible",t)}}},[a("div",{staticClass:"header",attrs:{slot:"title"},slot:"title"},[a("div",{staticClass:"title"},[a("i",{staticClass:"iconfont icon-huiyishiguanli"}),e._v(" 地址选取\n        ")]),a("div",{staticClass:"options"},[a("i",{staticClass:"iconfont icon-guanbi pointer fs-22",on:{click:function(t){e.map.dialogVisible=!1}}})]),a("div",{staticClass:"clear"})]),e.map.dialogVisible?a("iframe",{staticStyle:{width:"100%",height:"750px",border:"0"},attrs:{id:"map",src:""}}):e._e()])],1)},s=[],n=(i("fc02"),i("a450"),i("32f0")),o=i("7150"),l=i("6f3b"),r=i.n(l),c={components:{avatar:o["a"]},props:{id:String},computed:{timeZone:function(){return this.$store.getters.timeZone}},data:function(){return{enumType:{ScheduleEventSubType:[],deptList:[]},self:"",detail:{dialogVisible:!1,form:{subType:"",coordinate:"",location:"",remark:"",users:[],userPageSize:6,userPageNum:1,loading:!1,subFiles:[],time:[],meetingStatus:!1}},userList:[],userSelected:[],scheduleList:[],baseAPI:"https://dev-api.cgvcap.com",headers:{Authorization:"Bearer "+this.$store.state.user.user.token},uploadPDFURL:"https://dev-api.cgvcap.com/file",uploadPDFData:{category:"schedule"},meetingRoom:{dialogVisible:!1,form:{reservationId:"",conferencePwd:"",conferenceCode:"",meetingRoomId:"",meetingRoomName:"",startStr:"",endStr:"",timeStr:"",tips:"",inputTips:""},list:[]},map:{setting:!1,dialogVisible:!1},eventCityFilter:"",eventCityList:[],fileStatus:!1}},watch:{userSelected:function(e,t){var i=[];this.userSelected.map((function(e){i.push(JSON.parse(e))})),this.detail.form.users=i,this.userSelected.length<=(this.detail.form.userPageNum-1)*this.detail.form.userPageSize&&(this.detail.form.userPageNum--,this.detail.form.userPageNum=this.detail.form.userPageNum>0?this.detail.form.userPageNum:1)}},mounted:function(){this.getScheduleList(),this.getEnum("ScheduleReminderPeriod",!1),this.getEnum("ScheduleEventState",!1),this.getEnum("ScheduleEventType",!1),this.getEnum("ScheduleReminderType",!1),this.getDeptTree(),this.userSelected=[],this.userList=[];var e=this.$store.getters.user;this.self=e.user.jwtClaims.un},methods:{getEnum:function(e,t){var i=this;n["a"].getEnum(e).then((function(a){200===a.code&&(t&&a.data.unshift({name:"全部",value:""}),i.$set(i.enumType,e,a.data))})).catch((function(e){console.log(e)}))},getEnumSubType:function(){var e=this;n["a"].getEnum("ScheduleEventType."+this.detail.form.eventType).then((function(t){200===t.code&&(e.$set(e.enumType,"ScheduleEventSubType",t.data),t.data&&t.data.length>0?e.detail.form.subType=t.data[0].value:e.detail.form.subType="")})).catch((function(e){console.log(e)}))},getDeptTree:function(){var e=this,t={withEntRoot:!0};n["a"].deptTree(t).then((function(t){200===t.code&&e.$set(e.enumType,"deptList",e.setSelectDept(t.data))})).catch((function(e){console.log(e)}))},setSelectDept:function(e){var t=[];for(var i in e)(!e[i].isVirtualDept&&0===e[i].subDepts.length||"CGVC"===e[i].deptName)&&t.push({name:e[i].deptName,value:e[i].deptId}),e[i].subDepts&&(e[i].subDepts=this.setSelectDept(e[i].subDepts)),t=t.concat(e[i].subDepts);return t},getMeetingRoom:function(){var e=this,t={endTime:r()(this.detail.form.time[1]).valueOf()/1e3,startTime:r()(this.detail.form.time[0]).valueOf()/1e3,isFullDay:this.detail.form.fullDay||!1,eventId:this.detail.form.id};n["a"].getMeetingRoom(t).then((function(i){if(200===i.code){for(var a in i.data)for(var s in i.data[a].devicesStr="",i.data[a].devices)i.data[a].devices[s].isSelected&&(i.data[a].devicesStr+=i.data[a].devicesStr?" / "+i.data[a].devices[s].deviceName:i.data[a].devices[s].deviceName);e.meetingRoom.list=i.data||[],e.meetingRoom.dialogVisible=!0,e.meetingRoom.tips=r()(1e3*t.startTime).format("YYYY年MM月DD日 HH:mm")+"~"+r()(1e3*t.endTime).format("YYYY年MM月DD日 HH:mm")}})).catch((function(e){console.log(e)}))},saveMeetingRoom:function(){this.detail.form.meetingStatus=!0;var e="";this.meetingRoom.form.meetingRoomId&&(e+=this.meetingRoom.form.meetingRoomName+"("+this.meetingRoom.form.timeStr+") "),this.meetingRoom.form.conferenceCode&&(e+="视频会议号："+this.meetingRoom.form.conferenceCode+" 密码："+(this.meetingRoom.form.conferencePwd||"无")),this.meetingRoom.form.inputTips=e,this.meetingRoom.dialogVisible=!1},closeMeetingRoom:function(){var e=this;this.meetingRoom.form.reservationId?this.$confirm("即将取消预约的会议室，是否继续？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.$message.success({message:"预取消成功，点击保存按钮将取消已经预约的会议室!",duration:1500});var t=e.meetingRoom.form;e.meetingRoom={dialogVisible:!1,form:{loading:!1,lastReservationId:t.reservationId,reservationId:"",conferencePwd:t.conferencePwd,conferenceCode:t.conferenceCode,meetingRoomId:"",meetingRoomName:"",startStr:"",endStr:"",timeStr:""},list:[]},e.detail.form.meetingStatus=!0})).catch((function(e){console.log(e)})):(this.meetingRoom.form.meetingRoomId="",this.detail.form.meetingStatus=!0)},closeConferenceCode:function(){this.meetingRoom.form.conferenceCode="",this.meetingRoom.form.conferencePwd="",this.detail.form.meetingStatus=!0},getScheduleList:function(){var e=this,t={};n["a"].getMyCalendars(t).then((function(t){if(200===t.code){e.scheduleList=t.data;var i="";e.scheduleList.map((function(e){"UC"===e.calendarType.value&&(i=JSON.stringify(e))})),e.detail.form.calendar=i}})).catch((function(e){console.log(e)}))},getUserList:function(){var e=this,t={filter:"",startTime:r()(this.detail.form.time[0]).tz(this.timeZone).valueOf(),endTime:r()(this.detail.form.time[1]).tz(this.timeZone).valueOf(),eventId:this.detail.form.id||""};n["a"].userList(t).then((function(t){200===t.code&&(e.userList=t.data,e.initUserSelected())})).catch((function(t){e.$message.error({message:JSON.stringify(t),duration:1500})}))},showEditor:function(e,t,i){var a=this;if(this.scheduleList=[],this.getScheduleList(),t){var s={isSubscribe:e};n["a"].getEventDetail(s,t).then((function(e){if(200===e.code){if(a.detail.form={id:t,userPageSize:6,userPageNum:1,eventTitle:e.data.eventTitle,fullDay:e.data.fullDay,isTravel:e.data.isTravel,outerUsers:e.data.outerUsers,eventDesc:e.data.eventDesc,time:[r()(1e3*e.data.startTime).tz(a.timeZone).format("YYYY-MM-DD HH:mm"),r()(1e3*e.data.endTime).tz(a.timeZone).format("YYYY-MM-DD HH:mm")],timeStr:"",startTime:1e3*e.data.startTime,endTime:1e3*e.data.endTime,eventAddr:e.data.eventAddr,eventCity:e.data.eventCity,coordinate:e.data.coordinate,location:e.data.location,eventType:e.data.eventType.value,subType:e.data.subType&&e.data.subType.value||"",belongDept:e.data.belongDept&&e.data.belongDept.deptId,remark:e.data.remark,calendar:function(){for(var t in a.scheduleList)if(a.scheduleList[t].calendarId===e.data.eventCalendar.calendarId)return console.log(a.scheduleList[t]),JSON.stringify(a.scheduleList[t])}(),remindTime:e.data.eventReminder&&e.data.eventReminder.reminderPeriod&&e.data.eventReminder.reminderPeriod.value||"N",remindType:function(){var t=[];if(e.data.eventReminder)for(var i in e.data.eventReminder.reminderTypes)t.push(e.data.eventReminder.reminderTypes[i].value);return t}(),users:e.data.eventUsers||[],subFiles:function(){var t=[];return e.data.eventAttaches.map((function(e){t.push({accessCode:e.accessCode,fileId:e.fileId,attachId:e.attachId,attachName:e.fileName,canDownload:e.canDownload})})),t}(),meetingStatus:!1},e.data.eventConference){a.detail.form.eventConference=e.data.eventConference,a.meetingRoom.form={reservationId:e.data.eventConference.reservationId,conferencePwd:e.data.eventConference.conferencePwd,conferenceCode:e.data.eventConference.conferenceCode,meetingRoomId:e.data.eventConference.meetingRoomId,meetingRoomName:e.data.eventConference.meetingRoomName,startStr:r()(1e3*e.data.eventConference.startTime).format("YYYY-MM-DD HH:mm"),endStr:r()(1e3*e.data.eventConference.endTime).format("YYYY-MM-DD HH:mm"),timeStr:r()(1e3*e.data.eventConference.startTime).format("YYYY-MM-DD HH:mm")+" ~ "+r()(1e3*e.data.eventConference.endTime).format("HH:mm")};var i="";a.meetingRoom.form.meetingRoomId&&(i+=a.meetingRoom.form.meetingRoomName+"("+a.meetingRoom.form.timeStr+") "),a.meetingRoom.form.conferenceCode&&(i+="视频会议号："+a.meetingRoom.form.conferenceCode+" 密码："+(a.meetingRoom.form.conferencePwd||"无")),a.meetingRoom.form.inputTips=i,a.detail.form.timeStr=r()(1e3*e.data.eventConference.startTime).tz(a.timeZone).format("YYYY-MM-DD HH:mm")+" ~ "+r()(1e3*e.data.eventConference.endTime).tz(a.timeZone).format("HH:mm")}switch(e.data.eventState&&e.data.eventState.value){case"IP":a.detail.form.IP=!0;break;case"EM":a.detail.form.EM=!0;break}a.getUserList(),a.getEnumSubType(),a.detail.dialogVisible=!0}})).catch((function(e){console.log(e)}))}else{var o=i.allDay?r()(r()(i.startStr).valueOf()+324e5):i.startStr,l=i.allDay?r()(r()(i.endStr).valueOf()+324e5):i.endStr;this.detail.form={fullDay:!1,users:[],userPageSize:6,userPageNum:1,loading:!1,subFiles:[],time:[o,l],timeStr:r()(o).tz(this.timeZone).format("YYYY-MM-DD HH:mm")+" ~ "+r()(l).tz(this.timeZone).format("HH:mm"),meetingStatus:!1,eventType:"CF",subType:"CF_01",remindTime:"15",remindType:["SM","SR"],calendar:"",coordinate:"",belongDept:this.$store.state.user.user.jwtClaims.di+"",remark:""},this.meetingRoom.form={reservationId:"",conferencePwd:"",conferenceCode:"",meetingRoomId:"",meetingRoomName:"",startStr:"",endStr:"",timeStr:""},this.userSelected=[],this.getUserList(),this.getEnumSubType(),this.detail.dialogVisible=!0}},initUserSelected:function(){if(this.userSelected=[],this.detail.form.users.length>0)for(var e in this.detail.form.users)for(var t in this.userList)this.userList[t].eventUser.userId===this.detail.form.users[e].eventUser.userId&&this.userSelected.push(JSON.stringify(this.userList[t]));else for(var i in this.userList)this.userList[i].eventUser.userName===this.self&&(this.userSelected.push(JSON.stringify(this.userList[i])),this.detail.form.users=[this.userList[i]])},closeEditor:function(){this.detail.dialogVisible=!1},save:function(){var e=this;this.$refs["detail.form"].validate((function(t){if(t){var i={"calendar.calendarId":"","calendar.calendarType":"",startTime:"",endTime:"",eventAddr:e.detail.form.eventAddr||"",eventCity:e.detail.form.eventCity||"",coordinate:e.detail.form.coordinate||"",location:e.detail.form.location||"",remark:e.detail.form.remark||"",belongDept:e.detail.form.belongDept||"",eventDesc:e.detail.form.eventDesc||"","eventReminder.reminderPeriod":e.detail.form.remindTime||"","eventReminder.reminderTypes":e.detail.form.remindTime&&"N"!==e.detail.form.remindTime?e.detail.form.remindType:"",eventState:"NS",eventTitle:e.detail.form.eventTitle||"",eventType:e.detail.form.eventType||"",subType:e.detail.form.subType||"",eventUsers:function(){var t=[];return e.detail.form.users.map((function(e){t.push(e.eventUser.userId)})),t}(),fullDay:!!e.detail.form.fullDay,isTravel:"VA"!==e.detail.form.eventType&&"RM"!==e.detail.form.eventType&&"OT"!==e.detail.form.eventType&&!!e.detail.form.isTravel,outerUsers:e.detail.form.outerUsers||""};if(e.detail.form.calendar&&(i["calendar.calendarId"]=JSON.parse(e.detail.form.calendar).calendarId,i["calendar.calendarType"]=JSON.parse(e.detail.form.calendar).calendarType.value),e.detail.form.subFiles.length>0)for(var a in e.detail.form.subFiles)i["eventAttaches["+a+"].accessCode"]=e.detail.form.subFiles[a].accessCode,i["eventAttaches["+a+"].attachId"]=e.detail.form.subFiles[a].attachId,i["eventAttaches["+a+"].fileId"]=e.detail.form.subFiles[a].fileId,i["eventAttaches["+a+"].fileName"]=e.detail.form.subFiles[a].attachName,i["eventAttaches["+a+"].canDownload"]=e.detail.form.subFiles[a].canDownload;if(e.detail.form.meetingStatus?(console.log("CHANGE"),i["eventConference.conferenceCode"]=e.meetingRoom.form.conferenceCode+"",i["eventConference.conferencePwd"]=e.meetingRoom.form.conferencePwd+"",i["eventConference.meetingRoomId"]=e.meetingRoom.form.meetingRoomId,i["eventConference.reservationId"]=""):e.detail.form.eventConference&&(i["eventConference.conferenceCode"]=e.detail.form.eventConference.conferenceCode+"",i["eventConference.conferencePwd"]=e.detail.form.eventConference.conferencePwd+"",i["eventConference.meetingRoomId"]=e.detail.form.eventConference.meetingRoomId,i["eventConference.reservationId"]=e.detail.form.eventConference.reservationId),i.fullDay){var s=r()(e.detail.form.time[0]).tz(e.timeZone).format("YYYY-MM-DD");i.startTime=r()(s+" 00:00:00").tz(e.timeZone).valueOf()/1e3;var o=r()(e.detail.form.time[1]).tz(e.timeZone).format("YYYY-MM-DD");i.endTime=r()(o+" 00:00:00").tz(e.timeZone).valueOf()/1e3}else i.startTime=r()(e.detail.form.time[0]).tz(e.timeZone).valueOf()/1e3,i.endTime=r()(e.detail.form.time[1]).tz(e.timeZone).valueOf()/1e3;if(e.detail.form.IP?i.eventState="IP":e.detail.form.EM?i.eventState="EM":i.eventState="NS",console.log(i.endTime,i.startTime,r()(i.startTime).format("X"),r()(i.endTime).format("X"),r()(i.endTime).diff(r()(i.startTime))),r()(i.endTime).diff(r()(i.startTime))<=0)return void e.$message.warning({message:"结束时间需要大于开始开始时间!",duration:1500});console.log(i),e.detail.form.id?(e.meetingRoom.form.lastReservationId&&n["a"].deleteBookMeetingRoom(e.meetingRoom.form.lastReservationId).then((function(e){e.code})).catch((function(e){console.log(e)})),n["a"].editEvent(i,e.detail.form.id).then((function(t){200===t.code&&(e.$emit("REFRESH_EVENT"),e.$message.success({message:"编辑日程成功!",duration:1500}),e.detail.dialogVisible=!1)})).catch((function(e){console.log(e)}))):n["a"].createEvent(i).then((function(t){200===t.code&&(e.$emit("REFRESH_EVENT"),e.$message.success({message:"新增日程成功!",duration:1500}),e.detail.dialogVisible=!1)})).catch((function(e){console.log(e)})),console.log(i)}}))},showBookingRoom:function(){this.getMeetingRoom()},removeScheduleDetailUsers:function(e){this.detail.form.users.splice(e,1);var t=[];this.detail.form.users.map((function(e){t.push(JSON.stringify(e))})),this.userSelected=t,this.userSelected.length<=(this.detail.form.userPageNum-1)*this.detail.form.userPageSize&&(this.detail.form.userPageNum--,this.detail.form.userPageNum=this.detail.form.userPageNum>0?this.detail.form.userPageNum:1)},handleUsersChange:function(e){this.detail.form.userPageNum=e},onChangeFileSubFile:function(e){var t=this;this.detail.form.loading=!0;var i=setTimeout((function(){t.detail.form.loading=!1}),1e4);e.response&&200===e.response.code&&e.response.data?(clearTimeout(i),this.detail.form.subFiles=this.detail.form.subFiles||[],this.detail.form.subFiles.push({accessCode:e.response.data[0].accessCode,fileId:e.response.data[0].fileId,attachId:e.response.data[0].attachId,attachName:e.name,checked:!1,canDownload:!1}),setTimeout((function(){t.$refs.uploadSubFiles.clearFiles(),t.$set(t.detail.form,"loading",!1)}),300)):e.response&&200!==e.response.code&&(this.$message.error("上传失败！"),this.detail.form.loading=!1)},removeSubFiles:function(e){var t=[];this.detail.form.subFiles.map((function(e){e.checked||t.push(e)})),this.detail.form.subFiles=t},setSubFilesDownload:function(){var e=this;this.detail.form.subFiles.map((function(t){t.checked&&!e.fileStatus?t.canDownload=!0:t.checked&&e.fileStatus&&(t.canDownload=!1),t.checked=!1})),this.fileStatus=!1},setFileStatus:function(){var e=!0;this.detail.form.subFiles.map((function(t){t.checked&&!t.canDownload&&(e=!1)})),this.fileStatus=e},pickMeetingRoom:function(e){this.meetingRoom.form.meetingRoomId=e.meetingRoomId,this.meetingRoom.form.meetingRoomName=e.meetingRoomName,this.meetingRoom.form.startStr=r()(this.detail.form.time[0]).format("YYYY-MM-DD HH:mm"),this.meetingRoom.form.endStr=r()(this.detail.form.time[1]).format("YYYY-MM-DD HH:mm"),this.meetingRoom.form.timeStr=r()(this.detail.form.time[0]).format("YYYY-MM-DD HH:mm")+" ~ "+r()(this.detail.form.time[1]).format("HH:mm")},resetInfo:function(){this.getUserList(),this.detail.form.timeStr=r()(this.detail.form.time[0]).format("YYYY-MM-DD HH:mm")+" ~ "+r()(this.detail.form.time[1]).format("HH:mm")},showMap:function(){var e=this;this.map.dialogVisible=!0;var t=this;setTimeout((function(){var i="113.268653",a="22.924228";navigator&&navigator.geolocation&&navigator.geolocation.getCurrentPosition((function(e){i=e.coords.latitude,a=e.coords.longitude}),(function(e){}),{timeout:5e3,enableHighAccuracy:!0}),e.detail.form.coordinate&&(i=e.detail.form.coordinate.split(",")[0],a=e.detail.form.coordinate.split(",")[1]),document.getElementById("map").src=i&&a?"https://apis.map.qq.com/tools/locpicker?search=1&type=1&policy=1&coord="+a+","+i+"&key=U5FBZ-26DCR-3D2WP-WKWUQ-RL5KT-QZFX5&referer=PC":"https://apis.map.qq.com/tools/locpicker?search=1&type=1&policy=1&key=U5FBZ-26DCR-3D2WP-WKWUQ-RL5KT-QZFX5&referer=PC";document.getElementById("map").contentWindow;function s(e){t.map.setting||(t.map.setting=!0,t.setMap(e.data))}e.map.listener||(window.addEventListener("message",s,!0),e.map.listener=!0)}),300)},setMap:function(e){var t=this;console.log(e),e.latlng&&(e.location=e.latlng.lng+","+e.latlng.lat,e.name=e.poiname,e.address=e.poiaddress.split(e.cityname)[1],n["a"].queryCity({cityName:e.cityname}).then((function(i){console.log(i),i&&200===i.code&&i.data&&i.data.length>0?t.$set(t.detail.form,"eventCity",i.data[0].cityName):t.$set(t.detail.form,"eventCity",e.cityname),t.detail.form.eventAddr=e.address+e.name,t.detail.form.coordinate=e.latlng.lng+","+e.latlng.lat,t.detail.form.location=e.name+","+e.address,t.map.dialogVisible=!1}))),setTimeout((function(){t.map.setting=!1}),300)},resetTime:function(){this.detail.form.fullDay&&this.detail.form.time&&this.detail.form.time[1]?(this.detail.form.time[0]=r()(r()(this.detail.form.time[0]).tz(this.timeZone).format("YYYY-MM-DD")).utc().format(),this.detail.form.time[1]=r()(r()(this.detail.form.time[1]).tz(this.timeZone).add(1,"days").format("YYYY-MM-DD")).utc().format()):this.detail.form.fullDay&&!this.detail.form.time&&(this.$message.warning({message:"请先选择时间!",duration:1500}),this.detail.form.fullDay=!1)},filterMethod:function(e){e&&(this.eventCityFilter=e,this.getEentCityList())},getEentCityList:function(){var e=this;n["a"].queryCity({cityName:this.eventCityFilter}).then((function(t){t&&200===t.code&&t.data&&t.data.length>0&&(e.eventCityList=t.data)}))}}},d=c,m=(i("d596"),i("4ac2")),u=Object(m["a"])(d,a,s,!1,null,"54577665",null);t["default"]=u.exports},d1da:function(e,t){e.exports="data:image/png;base64,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"},d596:function(e,t,i){"use strict";i("789f")},d91d:function(e,t,i){"use strict";var a=i("a86f"),s=i("69b0"),n=i("f417");i("c46f")("search",1,(function(e,t,i,o){return[function(i){var a=e(this),s=void 0==i?void 0:i[t];return void 0!==s?s.call(i,a):new RegExp(i)[t](String(a))},function(e){var t=o(i,e,this);if(t.done)return t.value;var l=a(e),r=String(this),c=l.lastIndex;s(c,0)||(l.lastIndex=0);var d=n(l,r);return s(l.lastIndex,c)||(l.lastIndex=c),null===d?-1:d.index}]}))},dbef:function(e,t){e.exports="data:image/png;base64,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"},e443:function(e,t,i){"use strict";i("2450")},f244:function(e,t){e.exports="data:image/png;base64,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"},f276:function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-dialog",{staticClass:"target-wrap table-wrap",attrs:{visible:e.dialogVisible,width:"600px","show-close":!1,"append-to-body":!0,"close-on-click-modal":!1,"close-on-press-escape":!1,"before-close":e.viewClose,top:"50px"},on:{"update:visible":function(t){e.dialogVisible=t}}},[i("div",{staticClass:"header",attrs:{slot:"title"},slot:"title"},[i("div",{staticClass:"title"},[e._v("\n      "+e._s(e.time)+"团队餐补统计("+e._s(e.detail.statState&&e.detail.statState.name)+")\n    ")]),i("div",{staticClass:"options"},[i("i",{staticClass:"iconfont icon-guanbi pointer fs-22",on:{click:function(t){e.dialogVisible=!1}}})])]),i("div",{staticClass:"w-100p"},[i("div",{staticClass:"title-block"},[e._v("合计")]),i("div",{staticClass:"statistics"},[i("div",[i("span",{staticClass:"tips"},[e._v("出差时长")]),i("br"),i("span",{staticClass:"label"},[e._v(e._s(e.detail.statTotal&&e.detail.statTotal.totalTripHours)+"小时")])]),i("div",{staticClass:"text-center"},[i("span",{staticClass:"tips"},[e._v("餐补次数")]),i("br"),i("span",{staticClass:"label"},[e._v(e._s(e.detail.statTotal&&e.detail.statTotal.totalCbCount)+"次")])]),i("div",{staticClass:"text-right"},[i("span",{staticClass:"tips"},[e._v("餐补金额")]),i("br"),i("span",{staticClass:"label"},[e._v(e._s(e.detail.statTotal&&e.detail.statTotal.totalCbAmt)+"元")])])]),i("div",{staticClass:"title-block",staticStyle:{"margin-top":"20px"}},[e._v("成员差旅明细")]),i("el-table",{staticStyle:{width:"100%","margin-top":"20px"},attrs:{data:e.detail.statDetails,border:"",height:e.height-450,"cell-style":{cursor:"pointer"},"header-cell-style":{background:"#fdfdfd"}},on:{"row-click":e.showDetailSelf}},[i("el-table-column",{attrs:{prop:"cbUser.userName",label:"姓名",width:"80"}}),i("el-table-column",{attrs:{prop:"tripHours",label:"出差时长(小时)",width:"120"}}),i("el-table-column",{attrs:{prop:"cbCount",label:"餐补次数(次)",width:"120"}}),i("el-table-column",{attrs:{prop:"cbAmt",label:"餐补金额(元)",width:"120"}}),i("el-table-column",{attrs:{prop:"remark",label:"个人备注"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("div",{staticStyle:{position:"relative"}},[e._v("\n            "+e._s(t.row.remark)+"\n            "),i("div",{staticStyle:{position:"absolute",top:"0",left:"0",width:"3px",height:"20px",background:"#fff"}})])]}}])})],1),e.detail.statState&&"UC"===e.detail.statState.value?i("div",{staticClass:"title-block flex",staticStyle:{"align-items":"center","margin-top":"20px"}},[i("span",[e._v("确认无误")]),i("el-radio-group",{staticStyle:{"margin-left":"50px"},model:{value:e.hasRemark,callback:function(t){e.hasRemark=t},expression:"hasRemark"}},[i("el-radio",{attrs:{label:"Y"}},[e._v("是")]),i("el-radio",{attrs:{label:"N"}},[e._v("否")])],1)],1):e._e(),i("el-input",{directives:[{name:"show",rawName:"v-show",value:"N"===e.hasRemark&&e.detail.statState&&"UC"===e.detail.statState.value,expression:"hasRemark==='N' && detail.statState && detail.statState.value==='UC'"}],staticStyle:{"margin-top":"15px"},attrs:{type:"textarea",autosize:{minRows:3,maxRows:6},placeholder:"请输入内容"},model:{value:e.detail.remark,callback:function(t){e.$set(e.detail,"remark",t)},expression:"detail.remark"}}),e.detail.statState&&"UC"!==e.detail.statState.value?i("div",{staticClass:"title-block",staticStyle:{"margin-top":"20px"}},[e._v("团队备注")]):e._e(),e.detail.statState&&"UC"!==e.detail.statState.value?i("div",{staticClass:"remark-wrap"},[e._v(e._s(e.detail.remark||"无"))]):e._e()],1),e.detail.statState&&"UC"===e.detail.statState.value?i("div",{staticClass:"footer-block"},[i("el-button",{attrs:{type:"text"},on:{click:e.save}},[i("i",{staticClass:"iconfont icon-queren1",staticStyle:{"margin-right":"10px"}}),e._v(" 确认\n    ")])],1):e._e(),i("self",{ref:"self"})],1)},s=[],n=i("32f0"),o=i("9edc"),l={components:{self:o["default"]},props:{},data:function(){return{dialogVisible:!1,time:"",detail:{},textarea:"",hasRemark:"Y",height:""}},mounted:function(){},methods:{show:function(e,t){var i=this;this.height=document.body.clientHeight,this.time=t||"",this.dialogVisible=!1,setTimeout((function(){n["a"].getStatDeptDetail(e).then((function(e){200===e.code&&(i.dialogVisible=!0,e.data.statDetails.map((function(e){e.remark="|"+e.remark})),i.detail=e.data)})).catch((function(e){console.log(e)}))}))},save:function(){var e=this,t={remark:this.detail.remark};n["a"].confirmStatDeptList(t,this.detail.deptStatId).then((function(t){200===t.code&&(e.$message.success({message:"操作成功！",duration:1500}),e.$emit("refresh"),e.viewClose())})).catch((function(e){console.log(e)}))},viewClose:function(){this.dialogVisible=!1},showDetailSelf:function(e){this.$refs.self.show(e.statId,this.time,e.cbUser.userName)}}},r=l,c=(i("6ce0"),i("4ac2")),d=Object(c["a"])(r,a,s,!1,null,"9fb070a8",null);t["default"]=d.exports},f7d2:function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{"element-loading-text":"数据传输中("+e.loadProgress.toFixed(0)+"%)","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(0, 0, 0, 0.8)"}},[e.files&&e.files.length>0&&e.list?a("div",{staticClass:"files-wrap"},e._l(e.files,(function(t,i){return a("div",{key:i,staticClass:"item"},[a("el-tooltip",{attrs:{effect:"dark",content:"点击在新页签预览",disabled:!e.canOpenBlank(t.fileName),placement:"left"}},[a("span",{staticClass:"name",class:{"link pointer":e.canOpenBlank(t.fileName)},on:{click:function(i){return e.previewBlank(t)}}},[a("i",{staticClass:"iconfont icon-fujian fs-12"}),e._v(" "+e._s(t&&t.fileName))])]),e.view?a("span",{staticClass:"tips"},[a("el-button",{staticClass:"button",attrs:{type:"text"},on:{click:function(i){return e.preview(t)}}},[e._v("预览")])],1):e._e(),!e.edit&&e.view&&e.down&&t.canDownload?a("span",{staticClass:"tips"},[a("el-button",{staticClass:"button",attrs:{type:"text"},on:{click:function(i){return e.download(t)}}},[e._v("下载")])],1):e._e(),e.edit?a("span",{staticClass:"tips"},[a("el-button",{staticClass:"button",attrs:{type:"text"},on:{click:function(t){return e.remove(i)}}},[e._v("删除")])],1):e._e()],1)})),0):e._e(),e.files&&0===e.files.length&&e.emptyIcon&&(!e.edit||e.edit&&"none"===e.icon)?a("div",{staticStyle:{"text-align":"center"}},[a("img",{attrs:{src:i("f244")}}),a("br"),a("span",{staticStyle:{"font-size":"14px",color:"#666"}},[e._v("暂无数据")])]):e._e(),e.edit&&"none"!==e.icon?a("el-upload",{ref:"upload",attrs:{action:e.BASE_API+e.url,headers:e.headers,"show-file-list":!1,data:{category:e.tag},accept:e.accept,multiple:!0,"auto-upload":!0,"on-change":e.onChangeFile,"on-progress":e.uploadProcess}},["images"===e.icon?a("img",{staticStyle:{width:"50px",height:"50px"},attrs:{src:i("d1da")}}):e._e(),"icon"===e.icon?a("div",{staticStyle:{"padding-left":"20px"}},[a("i",{staticClass:"iconfont icon-shangchuan fs-14"}),a("span",{staticClass:"fs-14",staticStyle:{"margin-left":"10px"}},[e._v("上传附件")])]):e._e()]):e._e(),a("el-dialog",{staticClass:"preview",attrs:{visible:e.dialogVisible,"append-to-body":!0,"show-close":!1,fullscreen:!0,"close-on-click-modal":!1,"close-on-press-escape":!1},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("div",{staticClass:"header",attrs:{slot:"title"},slot:"title"},[a("div",{staticClass:"title"},[e._v("\n        "+e._s(e.fileTitle)+"\n      ")]),a("div",{staticClass:"options"},[a("i",{staticClass:"iconfont icon-guanbi pointer fs-22",on:{click:function(t){e.dialogVisible=!1}}})]),a("div",{staticClass:"clear"})]),a("div",{staticStyle:{margin:"-15px"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:"image"===e.previewType,expression:"previewType==='image'"}],staticStyle:{"text-align":"center"}},[a("img",{staticClass:"image",attrs:{src:e.image}})]),e.dialogVisible&&"file"===e.previewType?a("iframe",{staticClass:"iframe w-100p",staticStyle:{border:"0"},style:{height:e.dialogHeight-78+"px"},attrs:{allowfullscreen:"",id:"filePreviewDialogVisible",src:e.urlDialog}}):e._e()])])],1)},s=[],n=(i("4057"),i("b775"),i("ed08"),i("c24f")),o=i("caaf"),l=i.n(o);var r={name:"",components:{},props:{files:{type:Array,default:function(){return[]}},url:{type:String,default:function(){return"/file"}},tag:{type:String,default:function(){return""}},accept:{type:String,default:function(){return""}},edit:{type:Boolean,default:function(){return!0}},down:{type:Boolean,default:function(){return!0}},icon:{type:String,default:function(){return"images"}},list:{type:Boolean,default:function(){return!0}},emptyIcon:{type:Boolean,default:function(){return!0}},view:{type:Boolean,default:function(){return!0}},single:{type:Boolean,default:function(){return!1}}},data:function(){return{BASE_API:"https://dev-api.cgvcap.com",headers:{Authorization:"Bearer "+this.$store.state.user.user.token},loading:!1,dialogVisible:!1,previewType:"",image:"",pdf:"",height:document.body.scrollHeight-90+"px",curUploadCount:0,urlDialog:"https://preview.imm.aliyuncs.com/index.html",fileTitle:"",dialogHeight:"",loadProgress:0}},methods:{onChangeFile:function(e,t){if(this.loadProgress=0,this.loading=!0,e.response&&200===e.response.code&&e.response.data){var i=this.single?e.response.data:this.files.concat(e.response.data);this.$emit("UPLOAD_FILE",i),this.curUploadCount++,this.curUploadCount===t.length&&(this.$refs.upload.clearFiles(),this.curUploadCount=0,this.loading=!1)}},uploadProcess:function(e,t,i){this.loadProgress=e.percent},preview:function(e){var t=this;console.log(e),this.dialogVisible=!1,this.dialogHeight=document.body.clientHeight,this.fileTitle=e.fileName,this.urlDialog="https://preview.imm.aliyuncs.com/index.html?r="+Date.parse(new Date);var i=this.$options.filters.getFileType(e.fileName);if("pdf"===i||"ppt"===i||"excel"===i||"word"===i){this.previewType="file";var a={fileId:e.fileId,accessCode:e.accessCode};n["a"].getPreview(a).then((function(e){200===e.code&&(t.dialogVisible=!0,setTimeout((function(){t.initIframe(e.data)}),0))})).catch((function(e){console.log(e)}))}else"image"===i?(this.previewType="image",this.dialogVisible=!0,this.image="https://dev-oss.cgvcap.com/file/"+e.fileId+"/"+e.accessCode):this.$message.warning({message:"该文档暂不支持在线预览！",duration:1500})},previewBlank:function(e){var t=this.$options.filters.getFileType(e.fileName);if("pdf"===t||"ppt"===t||"excel"===t||"word"===t){this.previewType="file";var i={fileId:e.fileId,accessCode:e.accessCode};n["a"].getPreview(i).then((function(t){if(200===t.code){var i=t.data,a="../reader/index.html";a+="?accessKeyId="+encodeURIComponent(i.accessKeyId),a+="&accessKeySecret="+encodeURIComponent(i.accessKeySecret),a+="&bucket="+encodeURIComponent(i.bucket),a+="&region="+encodeURIComponent(i.region),a+="&stsToken="+encodeURIComponent(i.stsToken),a+="&url="+encodeURIComponent(i.url),a+="&watermark="+encodeURIComponent(i.watermark),a+="&title="+encodeURIComponent(e.fileName),a+="&time="+l()().format("X"),window.open(a,"_blank")}})).catch((function(e){console.log(e)}))}},canOpenBlank:function(e){var t=this.$options.filters.getFileType(e);return"pdf"===t||"ppt"===t||"excel"===t||"word"===t},initIframe:function(e){var t=this,i=this.$store.state.user.user.jwtClaims.un,a=this.$store.state.user.user.jwtClaims.id.substring(this.$store.state.user.user.jwtClaims.id.length-11),s=(new Date).getTime(),n=this.$options.filters.DateTimeSecondEn(s/1e3),o=i+"  "+a+"  "+n;window.sendMessage=function(e,i){var a="filePreviewDialogVisible",s=document.getElementById(a);s.contentWindow.postMessage(t.json2str({action:e,data:i}),"*")};var l=function t(i){try{var a=JSON.parse(i.data)}catch(s){return}switch(a.action){case"preview.ready":window.sendMessage("preview.init",{url:e.url,region:e.region,bucket:e.bucket,accessKeyId:e.accessKeyId,accessKeySecret:e.accessKeySecret,stsToken:e.stsToken,wmType:1,wmValue:o,wmFont:"14px",wmWidth:300,wmHeight:150,wmColor:"rgba(192,192,192,0.3)",wmRotate:-Math.PI/6,copy:1}),window.sendMessage("setConfig",{writerCustomStyle:function(e){return e?{}:{paginationDisplay:!1,fullScreenButtonDisplay:!1,containerMarginTop:0,containerMarginBottom:0,containerBackground:"#ffffff"}}}),window.removeEventListener("message",t,!1);break}};window.addEventListener("message",l,!1)},download:function(e){var t=this,i={expireSecond:""};n["a"].getShareUrl(i,e.fileId,e.accessCode).then((function(e){if(200===e.code){var t=document.createElement("a");t.href=e.data.shareUrl,t.target="_new",t.click()}})).catch((function(e){t.$message.error({message:JSON.stringify(e),duration:1500})}))},remove:function(e){var t=Object.assign({},this.files[e]);this.files.splice(e,1),this.$emit("UPLOAD_FILE",this.files),this.$emit("REMOVE_FILE",t)},hideDialog:function(){this.dialogVisible=!1,this.previewType="",this.image="",this.pdf=""},json2str:function(e){return JSON.stringify(e,(function(e,t){return"function"===typeof t&&(t=t.toString()),t}))}}},c=r,d=(i("42f7"),i("4ac2")),m=Object(d["a"])(c,a,s,!1,null,"980c6614",null);t["default"]=m.exports},f9a1:function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"target-wrap table-wrap",attrs:{visible:e.dialogVisible,width:"550px","append-to-body":!0,"show-close":!1,top:"50px","close-on-click-modal":!1,"close-on-press-escape":!1,"element-loading-text":"文件加载中","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(0, 0, 0, 0.8)"},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("div",{staticClass:"header",attrs:{slot:"title"},slot:"title"},[a("div",{staticClass:"title"},[a("i",{staticClass:"iconfont icon-richeng_normal"}),e._v(" "+e._s(e.detail.eventType&&e.detail.eventType.name)+e._s(e.detail.subType&&e.detail.subType.name?"-"+e.detail.subType.name:"")+"\n      ")]),a("div",{staticClass:"options"},[a("el-tooltip",{directives:[{name:"show",rawName:"v-show",value:e.detail.eventPermission&&e.detail.eventPermission.canRemind&&e.detail.eventReminder&&e.detail.eventReminder.isEnable,expression:"detail.eventPermission && detail.eventPermission.canRemind && detail.eventReminder && detail.eventReminder.isEnable"}],staticClass:"item",attrs:{effect:"dark",content:"提醒开启",placement:"top"}},[a("i",{staticClass:"iconfont icon-tixingkaiqix pointer fs-22 mr-10",on:{click:function(t){return e.setReminder(!1)}}})]),a("el-tooltip",{directives:[{name:"show",rawName:"v-show",value:e.detail.eventPermission&&e.detail.eventPermission.canRemind&&e.detail.eventReminder&&!e.detail.eventReminder.isEnable,expression:"detail.eventPermission && detail.eventPermission.canRemind && detail.eventReminder && !detail.eventReminder.isEnable"}],staticClass:"item",attrs:{effect:"dark",content:"提醒关闭",placement:"top"}},[a("i",{staticClass:"iconfont icon-tixingguanbix pointer fs-22 mr-10",on:{click:function(t){return e.setReminder(!0)}}})]),a("el-tooltip",{directives:[{name:"show",rawName:"v-show",value:e.detail.eventPermission&&e.detail.eventPermission.canShare,expression:"detail.eventPermission && detail.eventPermission.canShare"}],staticClass:"item",attrs:{effect:"dark",content:"分享",placement:"top"}},[a("i",{staticClass:"iconfont icon-fenxiangzhuanfax pointer fs-22 mr-10",on:{click:function(t){return e.showShareMembers()}}})]),a("el-tooltip",{directives:[{name:"show",rawName:"v-show",value:e.detail.eventPermission&&e.detail.eventPermission.canEdit,expression:"detail.eventPermission && detail.eventPermission.canEdit"}],staticClass:"item",attrs:{effect:"dark",content:"编辑",placement:"top"}},[a("i",{staticClass:"iconfont icon-bianjix pointer fs-22 mr-10",on:{click:function(t){return e.edit()}}})]),a("el-tooltip",{directives:[{name:"show",rawName:"v-show",value:e.detail.eventPermission&&e.detail.eventPermission.canDel,expression:"detail.eventPermission && detail.eventPermission.canDel"}],staticClass:"item",attrs:{effect:"dark",content:"删除",placement:"top"}},[a("i",{staticClass:"iconfont icon-shanchu pointer fs-22 mr-10",on:{click:function(t){return e.deleteEvent()}}})]),a("i",{staticClass:"iconfont icon-guanbi pointer fs-22",on:{click:e.closeDialog}})],1),a("div",{staticClass:"clear"})]),a("div",{staticClass:"wrap"},[a("div",{staticClass:"title"},[a("span",{directives:[{name:"show",rawName:"v-show",value:e.detail.eventState&&"NS"!==e.detail.eventState.value,expression:"detail.eventState && detail.eventState.value !=='NS'"}]},[e._v("\n          "+e._s(e.detail.eventState&&e.detail.eventState.name?"#"+e.detail.eventState.name+"#":"")+"\n        ")]),e._v("\n        "+e._s(e.detail.eventTitle)+"\n      ")]),a("div",{staticClass:"tag"},[a("span",[e._v(e._s(e.detail.eventCalendar&&e.detail.eventCalendar.calendarName))]),a("span",{directives:[{name:"show",rawName:"v-show",value:e.detail.isTravel,expression:"detail.isTravel"}],staticStyle:{"padding-left":"10px"}},[e._v("差旅")])]),a("div",{staticClass:"time"},[e._v(e._s(e.detail.time))]),a("div",{staticClass:"main"},[a("el-row",{directives:[{name:"show",rawName:"v-show",value:e.detail.eventConference&&e.detail.eventConference.conferenceCode,expression:"detail.eventConference && detail.eventConference.conferenceCode"}],staticStyle:{"margin-top":"10px"}},[a("el-col",{attrs:{span:2}},[a("i",{staticClass:"iconfont icon-xianshanghuiyishix fs-14"})]),a("el-col",{attrs:{span:22}},[e._v("会议号："+e._s(e.detail.eventConference&&e.detail.eventConference.conferenceCode)+"\n            密码："+e._s(e.detail.eventConference&&e.detail.eventConference.conferencePwd||"无")+"\n          ")])],1),a("el-row",{directives:[{name:"show",rawName:"v-show",value:e.detail.eventConference&&e.detail.eventConference.reservationId,expression:"detail.eventConference && detail.eventConference.reservationId"}],staticStyle:{"margin-top":"10px"}},[a("el-col",{attrs:{span:2}},[a("i",{staticClass:"iconfont icon-huiyishi_normal fs-14"})]),a("el-col",{attrs:{span:22}},[e._v(e._s(e.detail.eventConference&&e.detail.eventConference.meetingRoomName))])],1),a("el-row",{directives:[{name:"show",rawName:"v-show",value:e.detail.eventCity&&e.detail.eventType&&"VA"!==e.detail.eventType.value,expression:"detail.eventCity && detail.eventType && detail.eventType.value!=='VA'"}],staticStyle:{"margin-top":"10px"}},[a("el-col",{attrs:{span:2}},[a("i",{staticClass:"iconfont icon-didianx fs-14"})]),a("el-col",{attrs:{span:22}},[a("div",{class:{pointer:e.detail.coordinate},on:{click:e.showMap}},[e._v("\n              "+e._s(e.detail.eventCity)+e._s(e.detail.eventAddr)),e.detail.coordinate?a("span",{staticClass:"iconfont icon-shouqi4 pointer"}):e._e()])])],1),a("el-row",{staticStyle:{"margin-top":"10px"}},[a("el-col",{attrs:{span:2}},[a("div",{staticStyle:{display:"flex","align-items":"center",height:"32px"}},[a("i",{staticClass:"iconfont icon-zhihangzhex fs-14"})])]),a("el-col",{attrs:{span:22}},[a("div",{staticStyle:{display:"flex","align-items":"center"}},[e.detail.createUser?a("avatar",{attrs:{user:e.detail.createUser}}):e._e(),a("span",{staticStyle:{"margin-left":"10px"}},[e._v(e._s(e.detail.createUser&&e.detail.createUser.userName))]),a("span",{staticClass:"inverse-blue",staticStyle:{"margin-left":"10px",padding:"2px 4px","font-size":"12px"}},[e._v("发起者")])],1)])],1),a("el-row",{staticStyle:{"margin-top":"10px"}},[a("el-col",{attrs:{span:2}},[a("i",{staticClass:"iconfont icon-zhihangzhex fs-14"})]),a("el-col",{attrs:{span:22}},[a("div",[e._v("参与者")]),a("div",{staticStyle:{display:"flex","margin-top":"10px","flex-wrap":"wrap"}},e._l(e.detail.eventUsers,(function(t,i){return a("div",{directives:[{name:"show",rawName:"v-show",value:e.showAllUsers||i<=18,expression:"showAllUsers || index<=18"}],key:i,staticClass:"avatar",staticStyle:{"margin-bottom":"20px"}},[a("span",{directives:[{name:"show",rawName:"v-show",value:t.receiveState,expression:"item.receiveState"}],staticClass:"close",staticStyle:{display:"block"}},[a("i",{directives:[{name:"show",rawName:"v-show",value:t.receiveState&&"AC"===t.receiveState.value,expression:"item.receiveState && item.receiveState.value==='AC'"}],staticClass:"iconfont icon-wancheng_pressedx teal"}),a("i",{directives:[{name:"show",rawName:"v-show",value:t.receiveState&&"RJ"===t.receiveState.value,expression:"item.receiveState && item.receiveState.value==='RJ'"}],staticClass:"iconfont icon-weiwancheng_pressedx red"})]),a("avatar",{attrs:{user:t.eventUser,avatar:!1}})],1)})),0),a("div",[a("el-button",{directives:[{name:"show",rawName:"v-show",value:!e.showAllUsers&&e.detail.eventUsers&&e.detail.eventUsers.length>18,expression:"!showAllUsers && detail.eventUsers && detail.eventUsers.length>18"}],attrs:{type:"text"},on:{click:function(t){e.showAllUsers=!0}}},[e._v("显示全部参与者")])],1)])],1),a("el-row",{directives:[{name:"show",rawName:"v-show",value:e.detail.outerUsers,expression:"detail.outerUsers"}]},[a("el-col",{attrs:{span:2}},[e._v(" ")]),a("el-col",{attrs:{span:22}},[a("div",[e._v("外部："+e._s(e.detail.outerUsers))])])],1),a("el-row",{staticStyle:{"margin-top":"10px"}},[a("el-col",{attrs:{span:2}},[a("i",{staticClass:"iconfont icon-zhihangzhex fs-14"})]),a("el-col",{attrs:{span:22}},[a("div",[e._v("日程归类")]),a("div",{staticStyle:{display:"flex","margin-top":"10px","flex-wrap":"wrap"}},[e._v("\n              "+e._s(e.detail.belongDept&&e.detail.belongDept.deptName)+" "),e.detail.remark&&e.isSelf?a("span",{staticStyle:{"margin-left":"10px"}},[e._v(e._s(e.detail.remark))]):e._e()])])],1),a("el-row",{directives:[{name:"show",rawName:"v-show",value:e.detail.eventDesc||e.detail.eventAttaches&&e.detail.eventAttaches.length>0,expression:"detail.eventDesc || (detail.eventAttaches && detail.eventAttaches.length>0)"}],staticStyle:{"margin-top":"10px"}},[a("el-col",{attrs:{span:2}},[a("i",{staticClass:"iconfont icon-miaoshux fs-14"})]),a("el-col",{attrs:{span:22}},[a("div",{directives:[{name:"show",rawName:"v-show",value:e.detail.eventDesc,expression:"detail.eventDesc"}],staticStyle:{width:"100%","padding-bottom":"15px","white-space":"pre-line"}},e._l(e.detail.eventDescList,(function(t,i){return a("div",{key:i},[e._v(e._s(t))])})),0),a("div",{directives:[{name:"show",rawName:"v-show",value:e.detail.eventDesc&&e.detail.eventAttaches&&e.detail.eventAttaches.length>0,expression:"detail.eventDesc && detail.eventAttaches && detail.eventAttaches.length>0"}],staticStyle:{width:"100%","border-bottom":"solid 1px #e5e5e5"}}),a("div",{staticStyle:{"font-size":"14px","line-height":"26px","margin-top":"5px"}},[a("file-upload",{attrs:{edit:!1,files:e.detail.eventAttaches,view:!(!e.detail.eventPermission||!e.detail.eventPermission.canViewAttach)}})],1)])],1),e.likeList&&e.likeList.length>0?a("el-row",{staticStyle:{"margin-top":"10px"}},[a("el-col",{attrs:{span:2}},[a("i",{staticClass:"iconfont icon-zhihangzhex fs-14"})]),a("el-col",{attrs:{span:22}},[a("div",[e._v("点赞人")]),a("div",{staticStyle:{display:"flex","margin-top":"10px","flex-wrap":"wrap"}},e._l(e.likeList,(function(e,t){return a("div",{key:t,staticClass:"avatar",staticStyle:{"margin-bottom":"20px"}},[a("avatar",{attrs:{user:e.likeUser,avatar:!1}})],1)})),0)])],1):e._e(),a("el-row",{directives:[{name:"show",rawName:"v-show",value:e.detail.eventPermission&&e.detail.eventPermission.canComment,expression:"detail.eventPermission && detail.eventPermission.canComment"}],staticStyle:{"margin-top":"20px"}},[a("el-col",{attrs:{span:2}},[a("div",{staticStyle:{display:"flex","align-items":"center",height:"22px"}},[a("i",{staticClass:"iconfont icon-pinglunx fs-14"})])]),a("el-col",{attrs:{span:22}},[a("div",{staticStyle:{display:"flex","align-items":"center",height:"22px"}},[a("span",{staticStyle:{"margin-right":"auto"}},[e._v("评论")]),a("el-button",{directives:[{name:"show",rawName:"v-show",value:!e.detail.haveScore&&e.detail.eventPermission&&e.detail.eventPermission.canScore,expression:"!detail.haveScore && detail.eventPermission && detail.eventPermission.canScore"}],attrs:{type:"text"},on:{click:function(t){e.score.dialogVisible=!0}}},[e._v("去评分\n              ")]),a("span",{directives:[{name:"show",rawName:"v-show",value:e.detail.haveScore,expression:"detail.haveScore"}],staticStyle:{float:"right"}},[e._v("评分"+e._s(e.detail.averageScore)+"分")])],1),e._l(e.comment.list,(function(t,i){return a("div",{key:i,staticClass:"comment-wrap",class:{"no-border":i+1===e.comment.list.length}},[a("avatar",{staticStyle:{"margin-right":"10px"},attrs:{user:t.commentUser}}),a("div",{staticClass:"comment-list",staticStyle:{width:"90%"}},[a("div",{staticStyle:{display:"flex","align-items":"center",width:"100%"}},[e._v("\n                  "+e._s(t.commentUser.userName)+"    "+e._s(e._f("TimeSecond")(t.commentTime))+"\n                  "),a("span",{staticStyle:{"margin-right":"auto"}}),t.selfComment?e._e():a("i",{staticClass:"iconfont icon-huifu pointer",on:{click:function(i){return e.replyUser(t)}}}),t.selfComment?a("i",{staticClass:"iconfont icon-delete pointer",on:{click:function(i){return e.deleteComment(t.commentId)}}}):e._e()]),a("div",{domProps:{innerHTML:e._s(t.content)}}),a("div",{directives:[{name:"show",rawName:"v-show",value:t.replys&&t.replys.length>0,expression:"item.replys && item.replys.length>0"}],staticStyle:{padding:"10px 20px","border-radius":"5px",background:"#f5f5f5","margin-top":"10px"}},e._l(t.replys,(function(i,s){return a("el-row",{key:s,staticStyle:{"margin-top":"10px"}},[a("el-col",{attrs:{span:2}},[a("avatar",{attrs:{user:i.commentUser}})],1),a("el-col",{attrs:{span:22}},[a("div",[e._v(e._s(i.commentUser.userName)+"    "+e._s(e._f("TimeSecond")(i.replyTime))+"\n                        "),i.selfComment?e._e():a("i",{staticClass:"iconfont icon-huifu fr pointer",on:{click:function(i){return e.replyUser(t)}}}),i.selfComment?a("i",{staticClass:"iconfont icon-delete fr pointer",on:{click:function(t){return e.deleteComment(i.commentId)}}}):e._e()]),a("div",{domProps:{innerHTML:e._s(i.content)}})])],1)})),1)])],1)})),a("div",{directives:[{name:"show",rawName:"v-show",value:e.comment.total>5,expression:"comment.total>5"}],staticClass:"txt-right"},[e.comment.list&&e.comment.list.length>0?a("el-pagination",{staticStyle:{"margin-top":"20px"},attrs:{"current-page":e.comment.pageNum,"page-sizes":[5,10,20],"page-size":e.comment.pageSize,layout:"prev, pager, next",total:e.comment.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}):e._e()],1),a("div",{directives:[{name:"show",rawName:"v-show",value:e.comment.list&&0===e.comment.list.length,expression:"comment.list && comment.list.length===0"}],staticClass:"w-100p gray",staticStyle:{"text-align":"center"}},[a("img",{attrs:{src:i("3729")}}),a("br"),a("span",{staticStyle:{"font-size":"14px"}},[e._v("暂无数据")]),a("br"),a("br")])],2)],1)],1)]),e.detail.receiveState||e.detail.completeState||e.detail.eventPermission&&e.detail.eventPermission.canComment&&e.detail.eventPermission.canLike?a("div",{staticClass:"footer-wrap",attrs:{slot:"footer"},slot:"footer"},[a("div",{directives:[{name:"show",rawName:"v-show",value:e.detail.receiveState,expression:"detail.receiveState"}],staticClass:"pointer",class:{teal:e.detail.receiveState&&"AC"===e.detail.receiveState.value},staticStyle:{display:"flex","align-items":"center"},on:{click:function(t){return e.setReceiveState("AC")}}},[a("i",{staticClass:"iconfont fs-16",class:{"icon-wancheng_pressedx teal":e.detail.receiveState&&"AC"===e.detail.receiveState.value,"icon-wanchengx":e.detail.receiveState&&"AC"!==e.detail.receiveState.value},staticStyle:{"margin-right":"10px"}}),e._v("\n        "+e._s(e.detail.receiveState&&"AC"===e.detail.receiveState.value?"已":"")+"接受\n      ")]),a("div",{directives:[{name:"show",rawName:"v-show",value:e.detail.receiveState,expression:"detail.receiveState"}],staticClass:"pointer",class:{red:e.detail.receiveState&&"RJ"===e.detail.receiveState.value},staticStyle:{display:"flex","align-items":"center"},on:{click:function(t){return e.setReceiveState("RJ")}}},[a("i",{staticClass:"iconfont fs-16",class:{"icon-weiwancheng_pressedx red":e.detail.receiveState&&"RJ"===e.detail.receiveState.value,"icon-weiwanchengx":e.detail.receiveState&&"RJ"!==e.detail.receiveState.value},staticStyle:{"margin-right":"10px"}}),e._v("\n        "+e._s(e.detail.receiveState&&"RJ"===e.detail.receiveState.value?"已":"")+"拒绝\n      ")]),a("div",{directives:[{name:"show",rawName:"v-show",value:e.detail.completeState,expression:"detail.completeState"}],staticClass:"pointer",class:{teal:e.detail.completeState&&"CP"===e.detail.completeState.value},staticStyle:{display:"flex","align-items":"center"},on:{click:function(t){return e.setCompleteState("CP")}}},[a("i",{staticClass:"iconfont fs-16",class:{"icon-wancheng_pressedx teal":e.detail.completeState&&"CP"===e.detail.completeState.value,"icon-wanchengx":e.detail.completeState&&"CP"!==e.detail.completeState.value},staticStyle:{"margin-right":"10px"}}),e._v("\n        "+e._s(e.detail.completeState&&"CP"===e.detail.completeState.value?"已":"")+"完成\n      ")]),a("div",{directives:[{name:"show",rawName:"v-show",value:e.detail.completeState,expression:"detail.completeState"}],staticClass:"pointer",class:{red:e.detail.completeState&&"UC"===e.detail.completeState.value},staticStyle:{display:"flex","align-items":"center"},on:{click:function(t){return e.setCompleteState("UC")}}},[a("i",{staticClass:"iconfont fs-16",class:{"icon-weiwancheng_pressedx red":e.detail.completeState&&"UC"===e.detail.completeState.value,"icon-weiwanchengx":e.detail.completeState&&"UC"!==e.detail.completeState.value},staticStyle:{"margin-right":"10px"}}),e._v("\n        "+e._s((e.detail.completeState&&e.detail.completeState.value,""))+"未完成\n      ")]),e.detail.eventPermission&&e.detail.eventPermission.canComment?a("div",{staticClass:"pointer",staticStyle:{display:"flex","align-items":"center"},on:{click:function(t){e.footerView="comment"}}},[a("i",{staticClass:"iconfont icon-pinglunx fs-16",staticStyle:{"margin-right":"10px"}}),e._v("评论\n      ")]):e._e(),e.detail.eventPermission&&e.detail.eventPermission.canLike?a("div",{staticClass:"pointer",staticStyle:{display:"flex","align-items":"center"},on:{click:e.setLike}},[a("i",{staticClass:"iconfont icon-dianzan fs-16",class:{on:e.like},staticStyle:{"margin-right":"10px"}}),e._v("点赞\n      ")]):e._e()]):e._e(),"comment"===e.footerView?a("div",{staticClass:"footer-wrap",staticStyle:{display:"block"},attrs:{slot:"footer"},slot:"footer"},[e.detail.id?a("target-dialog",{ref:"dialog",attrs:{id:e.detail.id,type:"schedule"},on:{refreshOperation:function(t){return e.getCommentList()}}}):e._e()],1):e._e(),a("schedule-editor",{ref:"scheduleEditor",on:{REFRESH_EVENT:function(t){return e.getDetail(e.isSubscribe,e.detail.id,!0)}}}),a("el-dialog",{attrs:{visible:e.score.dialogVisible,width:"550px","append-to-body":!0,"show-close":!1,top:"50px","close-on-click-modal":!1,"close-on-press-escape":!1},on:{"update:visible":function(t){return e.$set(e.score,"dialogVisible",t)}}},[a("div",{staticClass:"header",attrs:{slot:"title"},slot:"title"},[a("div",{staticClass:"title"},[a("i",{staticClass:"iconfont icon-huiyishiguanli"}),e._v(" 评分\n        ")]),a("div",{staticClass:"options"},[a("i",{staticClass:"iconfont icon-guanbi pointer fs-22",on:{click:function(t){e.score.dialogVisible=!1}}})]),a("div",{staticClass:"clear"})]),a("div",{staticClass:"w-100p",staticStyle:{"text-align":"center","font-size":"16px",color:"#333",padding:"10px 0 20px"}},[e._v("\n        期待你的评分"),a("br"),a("span",{directives:[{name:"show",rawName:"v-show",value:0===e.score.curScore,expression:"score.curScore===0"}],staticStyle:{"font-size":"14px",color:"#999"}},[e._v(" ")]),a("span",{directives:[{name:"show",rawName:"v-show",value:1===e.score.curScore,expression:"score.curScore===1"}],staticStyle:{"font-size":"14px",color:"#999"}},[e._v("非常不满意")]),a("span",{directives:[{name:"show",rawName:"v-show",value:2===e.score.curScore,expression:"score.curScore===2"}],staticStyle:{"font-size":"14px",color:"#999"}},[e._v("不满意")]),a("span",{directives:[{name:"show",rawName:"v-show",value:3===e.score.curScore,expression:"score.curScore===3"}],staticStyle:{"font-size":"14px",color:"#999"}},[e._v("一般")]),a("span",{directives:[{name:"show",rawName:"v-show",value:4===e.score.curScore,expression:"score.curScore===4"}],staticStyle:{"font-size":"14px",color:"#999"}},[e._v("满意")]),a("span",{directives:[{name:"show",rawName:"v-show",value:5===e.score.curScore,expression:"score.curScore===5"}],staticStyle:{"font-size":"14px",color:"#999"}},[e._v("非常满意")])]),a("div",{staticClass:"score-wrap"},[a("img",{directives:[{name:"show",rawName:"v-show",value:e.score.curScore<1,expression:"score.curScore<1"}],attrs:{src:i("dbef")},on:{click:function(t){e.score.curScore=1}}}),a("img",{directives:[{name:"show",rawName:"v-show",value:e.score.curScore>.9,expression:"score.curScore>0.9"}],attrs:{src:i("4e09")},on:{click:function(t){e.score.curScore=1}}}),a("img",{directives:[{name:"show",rawName:"v-show",value:e.score.curScore<2,expression:"score.curScore<2"}],attrs:{src:i("dbef")},on:{click:function(t){e.score.curScore=2}}}),a("img",{directives:[{name:"show",rawName:"v-show",value:e.score.curScore>1.9,expression:"score.curScore>1.9"}],attrs:{src:i("4e09")},on:{click:function(t){e.score.curScore=2}}}),a("img",{directives:[{name:"show",rawName:"v-show",value:e.score.curScore<3,expression:"score.curScore<3"}],attrs:{src:i("dbef")},on:{click:function(t){e.score.curScore=3}}}),a("img",{directives:[{name:"show",rawName:"v-show",value:e.score.curScore>2.9,expression:"score.curScore>2.9"}],attrs:{src:i("4e09")},on:{click:function(t){e.score.curScore=3}}}),a("img",{directives:[{name:"show",rawName:"v-show",value:e.score.curScore<4,expression:"score.curScore<4"}],attrs:{src:i("dbef")},on:{click:function(t){e.score.curScore=4}}}),a("img",{directives:[{name:"show",rawName:"v-show",value:e.score.curScore>3.9,expression:"score.curScore>3.9"}],attrs:{src:i("4e09")},on:{click:function(t){e.score.curScore=4}}}),a("img",{directives:[{name:"show",rawName:"v-show",value:e.score.curScore<5,expression:"score.curScore<5"}],attrs:{src:i("dbef")},on:{click:function(t){e.score.curScore=5}}}),a("img",{directives:[{name:"show",rawName:"v-show",value:e.score.curScore>4.9,expression:"score.curScore>4.9"}],attrs:{src:i("4e09")},on:{click:function(t){e.score.curScore=5}}})]),a("div",{staticClass:"w-100p",staticStyle:{"margin-top":"40px","text-align":"center","margin-bottom":"20px"}},[a("el-button",{attrs:{type:"primary",disabled:!e.score.curScore},on:{click:function(t){return e.saveScore()}}},[e._v("提交")])],1)]),a("el-dialog",{attrs:{visible:e.file.dialogVisible,width:"850px","append-to-body":!0,"show-close":!1,top:"50px","close-on-click-modal":!1,"close-on-press-escape":!1},on:{"update:visible":function(t){return e.$set(e.file,"dialogVisible",t)}}},[a("div",{staticClass:"header",attrs:{slot:"title"},slot:"title"},[a("div",{staticClass:"title"},[a("i",{staticClass:"iconfont icon-huiyishiguanli"}),e._v(" 附件预览\n        ")]),a("div",{staticClass:"options"},[a("i",{staticClass:"iconfont icon-guanbi pointer fs-22",on:{click:function(t){e.file.dialogVisible=!1}}})]),a("div",{staticClass:"clear"})]),a("div",{staticClass:"w-100p"},e._l(e.file.pages,(function(e){return a("canvas",{key:e,staticStyle:{width:"100%"},attrs:{id:"canvas"+e}})})),0),a("div",{staticClass:"w-100p",staticStyle:{"margin-top":"40px","text-align":"center","margin-bottom":"20px"}},[a("el-button",{attrs:{type:"default"},on:{click:function(t){e.file.dialogVisible=!1}}},[e._v("关闭")])],1)]),a("el-dialog",{attrs:{visible:e.image.dialogVisible,fullscreen:!0,"append-to-body":!0,"show-close":!1,top:"50px","close-on-click-modal":!1,"close-on-press-escape":!1},on:{"update:visible":function(t){return e.$set(e.image,"dialogVisible",t)}}},[a("div",{staticClass:"header",attrs:{slot:"title"},slot:"title"},[a("div",{staticClass:"title"},[a("i",{staticClass:"iconfont icon-huiyishiguanli"}),e._v(" 附件预览\n        ")]),a("div",{staticClass:"options"},[a("i",{staticClass:"iconfont icon-guanbi pointer fs-22",on:{click:function(t){e.image.dialogVisible=!1}}})]),a("div",{staticClass:"clear"})]),a("div",{staticClass:"w-100p",staticStyle:{"text-align":"center"}},[a("img",{staticStyle:{"max-width":"100%"},attrs:{src:e.image.url}})]),a("div",{staticClass:"w-100p",staticStyle:{"margin-top":"40px","text-align":"center","margin-bottom":"20px"}},[a("el-button",{attrs:{type:"default"},on:{click:function(t){e.image.dialogVisible=!1}}},[e._v("关闭")])],1)]),a("el-dialog",{attrs:{visible:e.map.dialogVisible,width:"850px","append-to-body":!0,"show-close":!1,top:"50px","close-on-click-modal":!1,"close-on-press-escape":!1},on:{"update:visible":function(t){return e.$set(e.map,"dialogVisible",t)}}},[a("div",{staticClass:"header",attrs:{slot:"title"},slot:"title"},[a("div",{staticClass:"title"},[a("i",{staticClass:"iconfont icon-huiyishiguanli"}),e._v(" 地图\n        ")]),a("div",{staticClass:"options"},[a("i",{staticClass:"iconfont icon-guanbi pointer fs-22",on:{click:function(t){e.map.dialogVisible=!1}}})]),a("div",{staticClass:"clear"})]),e.map.dialogVisible?a("iframe",{staticStyle:{width:"100%",height:"650px",border:"none"},attrs:{id:"map",src:e.map.src}}):e._e()]),a("members-transfer",{ref:"transfer",attrs:{user:e.shareMembers.list},on:{SAVE_USERS:e.shareEvent}})],1)},s=[],n=(i("8dee"),i("fc02"),i("32f0")),o=i("d0de"),l=i("7150"),r=i("956b"),c=i("6f3b"),d=i.n(c),m=i("8995"),u=i("f7d2"),f={components:{scheduleEditor:o["default"],avatar:l["a"],targetDialog:r["a"],membersTransfer:m["a"],fileUpload:u["default"]},props:{id:String},data:function(){return{dialogVisible:!1,list:[],pageSize:10,pageNum:1,total:0,detail:{},shareMembers:{list:[],dialogVisible:!1},score:{dialogVisible:!1,curScore:0},file:{pdfDoc:"",dialogVisible:!1,pages:""},image:{dialogVisible:!1,url:""},comment:{pageNum:1,pageSize:5,list:[],total:0},footerView:"button",self:"",acceptButtons:!1,isSubscribe:"",loading:!1,BASE_API:"https://dev-api.cgvcap.com",like:!1,likeList:[],map:{dialogVisible:!1,src:""},isSelf:!1,showAllUsers:!1}},mounted:function(){var e=this.$store.getters.user;this.self=e.user.jwtClaims.un},methods:{showDialog:function(e){this.isSubscribe=e.event.extendedProps.isSubscribe,this.score={dialogVisible:!1,curScore:0},this.showAllUsers=!1,this.getDetail(e.event.extendedProps.isSubscribe,e.event.id)},closeDialog:function(){this.dialogVisible=!1},edit:function(){this.$refs.scheduleEditor.showEditor(this.isSubscribe,this.detail.id)},getDetail:function(e,t,i){var a=this,s={isSubscribe:e};n["a"].getEventDetail(s,t).then((function(e){200===e.code&&(e.data.id=t,d()(1e3*e.data.startTime).format("YYYY-MM-DD")===d()(1e3*e.data.endTime).format("YYYY-MM-DD")?e.data.time=d()(1e3*e.data.startTime).format("YYYY-MM-DD HH:mm")+" ~ "+d()(1e3*e.data.endTime).format("HH:mm"):e.data.time=d()(1e3*e.data.startTime).format("YYYY-MM-DD HH:mm")+" ~ "+d()(1e3*e.data.endTime).format("YYYY-MM-DD HH:mm"),e.data.eventDesc&&(e.data.eventDescList=e.data.eventDesc.split("\r\n")),a.detail=e.data,a.getCommentList(),a.getHasLike(),a.getLikeList(),a.isSelf=e.data.createUser.userId===a.$store.state.user.user.jwtClaims.id,a.footerView="button",a.dialogVisible=!0,a.acceptButtons=!1,e.data.eventUsers.map((function(e){e.eventUser.userName===a.self&&(a.acceptButtons=!0)})),i&&a.$emit("REFRESH_EVENT"))})).catch((function(e){console.log(e)}))},deleteEvent:function(){var e=this;this.$confirm("即将删除日程，是否继续？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){n["a"].deleteEvent(e.detail.id).then((function(t){200===t.code&&(e.$message.success({message:"删除成功!",duration:1500}),e.closeDialog(),e.$emit("REFRESH_EVENT"))})).catch((function(e){console.log(e)}))})).catch((function(e){console.log(e)}))},setReminder:function(e){var t=this,i={enable:e};n["a"].setReminder(i,this.detail.id).then((function(i){200===i.code&&(t.$message.success({message:e?"开启提醒":"关闭提醒!",duration:1500}),t.getDetail(t.isSubscribe,t.detail.id))})).catch((function(e){console.log(e)}))},setReceiveState:function(e){var t=this,i={receiveState:e};n["a"].setReceiveState(i,this.detail.id).then((function(e){200===e.code&&(t.$message.success({message:"操作成功!",duration:1500}),t.getDetail(t.isSubscribe,t.detail.id))})).catch((function(e){console.log(e)}))},setCompleteState:function(e){var t=this,i={completeState:e};n["a"].setCompleteState(i,this.detail.id).then((function(e){200===e.code&&(t.$message.success({message:"操作成功!",duration:1500}),t.getDetail(t.isSubscribe,t.detail.id))})).catch((function(e){console.log(e)}))},shareEvent:function(e){var t=this,i=[];e.map((function(e){i.push(e.id||e.userId)}));var a={userId:i};n["a"].shareEvent(a,this.detail.id).then((function(e){200===e.code&&(t.$message.success({message:"分享成功!",duration:1500}),t.shareMembers.dialogVisible=!1)})).catch((function(e){console.log(e)}))},saveScore:function(){var e=this;if(0===this.score.curScore)this.$message.warning({message:"分数不能为0!",duration:1500});else{var t={score:this.score.curScore};n["a"].saveScore(t,this.detail.id).then((function(t){200===t.code&&(e.$message.success({message:"评分成功!",duration:1500}),e.score.dialogVisible=!1,e.getDetail(e.isSubscribe,e.detail.id))})).catch((function(e){console.log(e)}))}},getCommentList:function(){var e=this,t={bizType:"schedule",pageNum:this.comment.pageNum,pageSize:this.comment.pageSize};n["a"].commentList(t,this.detail.id).then((function(t){if(200===t.code){for(var i in t.data.list)t.data.list[i].content=t.data.list[i].content.replace(/\n/g,"<br/>");e.comment.list=t.data.list,e.comment.total=t.data.total,e.footerView="button"}})).catch((function(e){console.log(e)}))},deleteComment:function(e){var t=this;this.$confirm("即将删除评论，是否继续？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){n["a"].deleteComment(e).then((function(e){200===e.code&&(t.getCommentList(),t.$message.success({message:"评论删除成功!",duration:1500}))})).catch((function(e){console.log(e)}))})).catch((function(e){console.log(e)}))},replyUser:function(e){var t=this;console.log(e),this.footerView="comment",this.$nextTick((function(){t.$refs.dialog.replyUser(e)}))},handleSizeChange:function(e){this.comment.pageSize=e,this.comment.pageNum=1,this.getCommentList()},handleCurrentChange:function(e){this.comment.pageNum=e,this.getCommentList()},showShareMembers:function(){this.$refs.transfer.show()},getHasLike:function(){var e=this,t={bizType:"schedule"};n["a"].getHasLike(t,this.detail.id).then((function(t){200===t.code&&(e.like=t.data)})).catch((function(e){console.log(e)}))},getLikeList:function(){var e=this,t={pageNum:1,pageSize:150,bizType:"schedule"};n["a"].getLikeList(t,this.detail.id).then((function(t){200===t.code&&(e.likeList=t.data.list)})).catch((function(e){console.log(e)}))},setLike:function(){var e=this;this.like=!this.like;var t={bizType:"schedule"};n["a"].setLike(this.like,t,this.detail.id).then((function(t){200===t.code&&e.getLikeList()})).catch((function(e){console.log(e)}))},showMap:function(){if(this.detail.coordinate){var e=".";this.map.src=e+"/map/location.html?center="+this.detail.coordinate+","+this.detail.location,this.map.dialogVisible=!0}}}},p=f,h=(i("e443"),i("4ac2")),v=Object(h["a"])(p,a,s,!1,null,"37f93c67",null);t["default"]=v.exports}}]);