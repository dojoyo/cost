(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4672e6d8","chunk-2d22c102"],{"1ef8":function(t,e,s){"use strict";s("fcaf")},"29d3":function(t,e,s){"use strict";s.r(e);var i=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("el-container",[i("el-header",{staticClass:"header"},[i("div",{staticClass:"header-wrap",staticStyle:{display:"flex"}},[i("div",{staticClass:"title"},[i("i",{staticClass:"iconfont icon-canyin"}),t._v(" 餐补统计-统计报表\n      ")]),i("div",{staticStyle:{"margin-left":"auto"}})])]),i("el-main",{staticClass:"main"},[i("div",{staticClass:"w-100p"},[i("el-date-picker",{staticStyle:{width:"200px","margin-right":"20px"},attrs:{"value-format":"yyyy-MM",type:"month",placeholder:"周期"},model:{value:t.search.period,callback:function(e){t.$set(t.search,"period",e)},expression:"search.period"}}),i("el-select",{staticStyle:{"margin-right":"20px"},attrs:{placeholder:"部门"},model:{value:t.search.deptId,callback:function(e){t.$set(t.search,"deptId",e)},expression:"search.deptId"}},t._l(t.deptList,(function(e){return i("el-option",{key:e.deptId,attrs:{label:e.deptName,value:e.deptId}},[i("span",{style:{paddingLeft:10*e.level+"px"}},[t._v(t._s(e.deptName))])])})),1),i("el-input",{staticStyle:{width:"200px","margin-right":"20px"},attrs:{size:"medium",placeholder:"输入部门或人员姓名搜索"},model:{value:t.search.filter,callback:function(e){t.$set(t.search,"filter",e)},expression:"search.filter"}}),i("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(e){return t.getList(!0)}}},[t._v("查询")]),i("el-button",{staticStyle:{float:"right"},attrs:{type:"text"},on:{click:function(e){return t.exportExcel()}}},[i("i",{staticClass:"iconfont icon-xiazai fs-12"}),t._v(" 导出数据")])],1),t.list&&t.list.length>0?i("div",{staticClass:"catering-table"},[i("div",{staticClass:"row title"},[i("div",{staticClass:"td",staticStyle:{width:"20%"}},[t._v("姓名")]),i("div",{staticClass:"td",staticStyle:{width:"14%"}},[t._v("所属部门")]),i("div",{staticClass:"td",staticStyle:{width:"14%"}},[t._v("状态")]),i("div",{staticClass:"td",staticStyle:{width:"14%"}},[t._v("出差时长")]),i("div",{staticClass:"td",staticStyle:{width:"14%"}},[t._v("餐补次数")]),i("div",{staticClass:"td",staticStyle:{width:"14%"}},[t._v("餐补金额")]),i("div",{staticClass:"td",staticStyle:{width:"10%"}},[t._v("操作")])]),t._l(t.list,(function(e,s){return i("div",{key:s,staticClass:"row flex-wrap"},[i("div",{staticClass:"td pointer",staticStyle:{width:"20%"},on:{click:function(t){e.isOpen=!e.isOpen}}},[i("i",{staticClass:"iconfont",class:{"icon-gengduo":e.isOpen,"icon-shouqi4":!e.isOpen}}),t._v(t._s(e.userName)+"\n        ")]),i("div",{staticClass:"td",staticStyle:{width:"28%"}},[t._v(t._s(e.deptName))]),i("div",{staticClass:"td",staticStyle:{width:"14%"}},[t._v(t._s(e.tripHours)+"小时")]),i("div",{staticClass:"td",staticStyle:{width:"14%"}},[t._v(t._s(e.cbCount)+"次")]),i("div",{staticClass:"td",staticStyle:{width:"14%"}},[t._v(t._s(e.cbAmt)+"元")]),i("div",{staticClass:"td",staticStyle:{width:"10%"}}),t._l(e.statDetails,(function(a,n){return i("div",{directives:[{name:"show",rawName:"v-show",value:e.isOpen,expression:"user.isOpen"}],key:n,staticClass:"w-100p row flex-wrap space-between"},[i("div",{staticClass:"td pointer",staticStyle:{width:"34%","padding-left":"30px"},on:{click:function(t){a.isOpen=!a.isOpen}}},[i("i",{staticClass:"iconfont",class:{"icon-gengduo":a.isOpen,"icon-shouqi4":!a.isOpen}}),t._v(t._s(a.statPeriod)+"\n          ")]),i("div",{staticClass:"td",staticStyle:{width:"14%"}},[t._v(t._s(a.cbState.name))]),i("div",{staticClass:"td",staticStyle:{width:"14%"}},[t._v(t._s(a.tripHours)+"小时")]),i("div",{staticClass:"td",staticStyle:{width:"14%"}},[t._v(t._s(a.cbCount)+"次")]),i("div",{staticClass:"td",staticStyle:{width:"14%"}},[t._v(t._s(a.cbAmt)+"元")]),i("div",{staticClass:"td",staticStyle:{width:"10%"}},[i("el-button",{attrs:{type:"text"},on:{click:function(e){return t.showRemark(s,n)}}},[t._v("备注")]),"CF"===a.cbState.value?i("el-button",{attrs:{type:"text"},on:{click:function(e){return t.showDetail(a)}}},[t._v("编辑")]):t._e()],1),t._l(a.statDates,(function(e,s){return i("div",{directives:[{name:"show",rawName:"v-show",value:a.isOpen,expression:"month.isOpen"}],key:s,staticClass:"w-100p row flex-wrap space-between"},[i("div",{staticClass:"td pointer",staticStyle:{width:"48%","padding-left":"60px"},on:{click:function(t){e.isOpen=!e.isOpen}}},[i("i",{staticClass:"iconfont",class:{"icon-gengduo":e.isOpen,"icon-shouqi4":!e.isOpen}}),t._v(t._s(t._f("DateTime")(e.cbDate))+"\n            ")]),i("div",{staticClass:"td",staticStyle:{width:"14%"}},[t._v(t._s(e.tripHours)+"小时")]),i("div",{staticClass:"td",staticStyle:{width:"14%"}},[t._v(t._s(e.actualCbCount)+"次")]),i("div",{staticClass:"td",staticStyle:{width:"14%"}},[t._v(t._s(e.cbAmt)+"元")]),i("div",{staticClass:"td",staticStyle:{width:"10%"}}),t._l(e.statItems,(function(s,a){return i("div",{directives:[{name:"show",rawName:"v-show",value:e.isOpen,expression:"day.isOpen"}],key:a,staticClass:"w-100p row flex-wrap space-between"},[i("div",{staticClass:"td",staticStyle:{width:"20%","padding-left":"60px"}},[t._v(t._s(s.tripTime))]),i("div",{staticClass:"td",staticStyle:{width:"14%"}},[t._v(t._s(s.tripCity))]),i("div",{staticClass:"td pointer",staticStyle:{width:"66%"}},[t._v("【"+t._s(s.eventType)+"】"+t._s(s.eventName))])])}))],2)}))],2)}))],2)}))],2):t._e(),i("div",{staticClass:"txt-right"},[t.list&&t.list.length>0?i("el-pagination",{staticStyle:{"margin-top":"20px"},attrs:{"current-page":t.pageNum,"page-sizes":[5,10,20],"page-size":t.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:t.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}}):t._e()],1),i("div",{directives:[{name:"show",rawName:"v-show",value:t.list&&0===t.list.length,expression:"list && list.length===0"}],staticClass:"w-100p gray",staticStyle:{"text-align":"center"}},[i("img",{attrs:{src:s("f244")}}),i("br"),i("span",{staticStyle:{"font-size":"14px"}},[t._v("暂无数据")]),i("br"),i("br")])]),i("el-dialog",{attrs:{visible:t.remark.dialogVisible,width:"500px","append-to-body":!0,"show-close":!1,top:"50px","close-on-click-modal":!1,"close-on-press-escape":!1},on:{"update:visible":function(e){return t.$set(t.remark,"dialogVisible",e)}}},[i("div",{staticClass:"header",attrs:{slot:"title"},slot:"title"},[i("div",{staticClass:"title"},[i("i",{staticClass:"iconfont icon-gongzitiao1"}),t._v(" 备注详情\n      ")]),i("div",{staticClass:"options"},[i("i",{staticClass:"iconfont icon-guanbi pointer fs-22",on:{click:function(e){t.remark.dialogVisible=!1}}})]),i("div",{staticClass:"clear"})]),i("div",{staticClass:"title-block"},[t._v("个人备注")]),i("div",{staticClass:"wrap",staticStyle:{"margin-top":"10px","min-height":"100px"}},[t._v("\n      "+t._s(t.remark.self||"无")+"\n    ")]),i("div",{staticClass:"title-block",staticStyle:{"margin-top":"20px"}},[t._v("部门总备注")]),i("div",{staticClass:"wrap",staticStyle:{"margin-top":"10px","min-height":"100px"}},[t._v("\n      "+t._s(t.remark.dept||"无")+"\n    ")])]),i("el-dialog",{attrs:{visible:t.detail.dialogVisible,width:"500px","append-to-body":!0,"show-close":!1,top:"50px","close-on-click-modal":!1,"close-on-press-escape":!1},on:{"update:visible":function(e){return t.$set(t.detail,"dialogVisible",e)}}},[i("div",{staticClass:"header",attrs:{slot:"title"},slot:"title"},[i("div",{staticClass:"title"},[i("i",{staticClass:"iconfont icon-gongzitiao1"}),t._v(" 餐补调整\n      ")]),i("div",{staticClass:"options"},[i("i",{staticClass:"iconfont icon-guanbi pointer fs-22",on:{click:function(e){t.detail.dialogVisible=!1}}})]),i("div",{staticClass:"clear"})]),i("el-scrollbar",{staticStyle:{height:"350px",width:"100%"}},t._l(t.detail.detail.statDates,(function(e,s){return i("div",{key:s,staticClass:"statistics"},[i("div",{staticClass:"w-100p w-100p flex space-between"},[i("div",[t._v(t._s(t._f("DateTime")(e.cbDate)))]),i("div",{staticClass:"operation"},[i("span",{staticClass:"info"},[t._v("餐补次数")]),i("span",{staticClass:"change"},[t._v(t._s(e.statCbCount))]),i("span",{staticClass:"icn",on:{click:function(e){return t.reduceCount(s)}}},[t._v("-")]),i("span",{staticClass:"num"},[t._v(t._s(e.actualCbCount))]),i("span",{staticClass:"icn",staticStyle:{"margin-right":"0"},on:{click:function(e){return t.addCount(s)}}},[t._v("+")])])]),t._l(e.statItems,(function(e,s){return i("div",{key:s,staticClass:"w-100p flex mt-10"},[i("div",{staticStyle:{width:"120px"}},[t._v(t._s(e.tripTime))]),i("div",[t._v("【"+t._s(e.eventType)+"】"+t._s(e.eventName))])])}))],2)})),0),i("div",{staticClass:"footer-block"},[i("el-button",{attrs:{type:"text"},on:{click:t.save}},[i("i",{staticClass:"iconfont icon-queren1",staticStyle:{"margin-right":"10px"}}),t._v(" 确认\n      ")])],1)],1)],1)},a=[],n=(s("d91d"),s("cd05")),c={name:"",components:{},props:{},data:function(){return{enumType:{},deptList:[],search:{deptId:"",filter:"",period:""},list:[],pageNum:1,pageSize:10,total:10,remark:{dialogVisible:!1,detail:""},detail:{dialogVisible:!1,detail:{}}}},mounted:function(){this.getEnum("ArchiveApp",!0),this.getList(!0),this.getDeptTree()},destroyed:function(){},methods:{getEnum:function(t,e){var s=this;n["a"].getEnum(t).then((function(i){200===i.code&&(e&&i.data.unshift({name:"全部",value:""}),s.$set(s.enumType,t,i.data))})).catch((function(t){console.log(t)}))},getDeptTree:function(){var t=this,e={withEntRoot:!0};n["a"].deptTree(e).then((function(e){if(200===e.code){var s=function t(e,s){for(var i in e)e[i].level=s,e[i].subDepts&&(e[i].subDepts=t(e[i].subDepts,s+1));return e},i=s(e.data,0);t.deptList=t.setSelectDept(Object.assign([],i),0),t.deptList.unshift({deptId:"",deptName:"全部"})}})).catch((function(t){console.log(t)}))},setSelectDept:function(t,e){var s=[];for(var i in t)s.push({deptName:t[i].deptName,deptId:t[i].deptId,level:e}),t[i].subDepts&&(t[i].subDepts=this.setSelectDept(t[i].subDepts,e+1)),s=s.concat(t[i].subDepts);return s},getList:function(t){var e=this,s={deptId:this.search.deptId,period:this.search.period,filter:this.search.filter,pageNum:this.pageNum,pageSize:this.pageSize};n["a"].getStatFinanceList(s).then((function(s){200===s.code&&(t?s.data.list.map((function(t,e){t.isOpen=!1,t.statDetails.map((function(t,e){t.isOpen=!1,t.statDates.map((function(t,e){t.isOpen=!1,t.statItems.map((function(t,e){t.isOpen=!1}))}))}))})):s.data.list.map((function(t,s){t.isOpen=e.list[s].isOpen,t.statDetails.map((function(t,i){t.isOpen=e.list[s].statDetails[i].isOpen,t.statDates.map((function(t,a){t.isOpen=e.list[s].statDetails[i].statDates[a].isOpen,t.statItems.map((function(t,n){t.isOpen=e.list[s].statDetails[i].statDates[a].statItems[n].isOpen}))}))}))})),e.list=s.data.list,e.total=s.data.total)})).catch((function(t){console.log(t)}))},handleSizeChange:function(t){this.pageSize=t,this.pageNum=1,this.getList(!0)},handleCurrentChange:function(t){this.pageNum=t,this.getList(!0)},showRemark:function(t,e){this.remark={dialogVisible:!0,self:this.list[t].statDetails[e].remark,dept:this.list[t].statDetails[e].deptRemark}},showDetail:function(t){console.log(t),this.detail={dialogVisible:!0,detail:t}},addCount:function(t){this.detail.detail.statDates[t].actualCbCount=3===this.detail.detail.statDates[t].actualCbCount?3:this.detail.detail.statDates[t].actualCbCount+1},reduceCount:function(t){this.detail.detail.statDates[t].actualCbCount=0===this.detail.detail.statDates[t].actualCbCount?0:this.detail.detail.statDates[t].actualCbCount-1},save:function(){var t=this,e={statCbDates:[]};this.detail.detail.statDates.map((function(t){e.statCbDates.push({cbCount:t.actualCbCount,cbStatDateId:t.cbStatDateId})})),n["a"].updateStatFinanceList(e,this.detail.detail.statId).then((function(e){200===e.code&&(t.$message.success({message:"操作成功！",duration:1500}),t.detail.dialogVisible=!1,t.getList())})).catch((function(t){console.log(t)}))},exportExcel:function(){var t={deptId:this.search.deptId,period:this.search.period,filter:this.search.filter,pageNum:this.pageNum,pageSize:this.pageSize};n["a"].exportExcelCatering(t).then((function(t){var e=t.headers,s=decodeURIComponent(e["x-file-name"])||"餐补统计数据.xlsx",i=new Blob([t.data],{type:e["content-type"]}),a=document.createElement("a");a.href=window.URL.createObjectURL(i),a.download=s,a.click()})).catch((function(t){console.log(t)}))}}},l=c,d=(s("1ef8"),s("4ac2")),o=Object(d["a"])(l,i,a,!1,null,"309bcc58",null);e["default"]=o.exports},"69b0":function(t,e){t.exports=Object.is||function(t,e){return t===e?0!==t||1/t===1/e:t!=t&&e!=e}},cd05:function(t,e,s){"use strict";var i=s("b775");e["a"]={getEnum:function(t){return Object(i["a"])({url:"/enum/"+t,method:"get"})},deptTree:function(t){return Object(i["a"])({url:"/contacts/deptUserTree",method:"get",params:t})},getStatFinanceList:function(t){return Object(i["a"])({url:"/schedule/stat/cb/finance/list",method:"post",data:t})},updateStatFinanceList:function(t,e){return Object(i["a"])({url:"/schedule/stat/cb/finance/"+e+"/update",method:"post",data:t,headers:{"Content-Type":"application/json; charset=utf-8"}})},exportExcelCatering:function(t){return Object(i["a"])({url:"/schedule/stat/cb/finance/export",method:"get",params:t,responseType:"arraybuffer"})}}},d91d:function(t,e,s){"use strict";var i=s("a86f"),a=s("69b0"),n=s("f417");s("c46f")("search",1,(function(t,e,s,c){return[function(s){var i=t(this),a=void 0==s?void 0:s[e];return void 0!==a?a.call(s,i):new RegExp(s)[e](String(i))},function(t){var e=c(s,t,this);if(e.done)return e.value;var l=i(t),d=String(this),o=l.lastIndex;a(o,0)||(l.lastIndex=0);var r=n(l,d);return a(l.lastIndex,o)||(l.lastIndex=o),null===r?-1:r.index}]}))},f244:function(t,e){t.exports="data:image/png;base64,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"},fcaf:function(t,e,s){}}]);