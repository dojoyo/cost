(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-83d49fc4","chunk-d81f416c","chunk-2d22c102"],{"328f":function(e,t,s){"use strict";var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"users-wrap"},[e._l(e.users,(function(t,a){return s("div",{key:a,staticClass:"avatar",class:{step:e.step,last:a===e.users.length-1}},[s("span",{staticClass:"close",on:{click:function(e){e.stopPropagation()}}},[s("i",{directives:[{name:"show",rawName:"v-show",value:e.edit,expression:"edit"}],staticClass:"iconfont icon-guanbi",on:{click:function(t){return e.removeUser(a)}}})]),s("el-tooltip",{attrs:{content:t.userName,effect:"dark",placement:"top"}},[s("avatar",{attrs:{user:t}})],1),e.tags?s("div",{staticStyle:{"line-height":"16px","padding-top":"8px"}},[e._v(e._s(t.userTag||t.userName))]):e._e(),s("div",{staticClass:"line"})],1)})),s("div",{directives:[{name:"show",rawName:"v-show",value:e.edit,expression:"edit"}]},[s("i",{staticClass:"iconfont icon-tianjia pointer fs-22",on:{click:function(t){return e.showMemberTransfer("transfer")}}})]),s("members-transfer",{ref:"transfer",attrs:{multi:e.multi,role:e.role,step:e.step,users:e.users,invest:e.invest},on:{SAVE_USERS:e.setUsers}})],2)},i=[],r=s("7150"),n=s("8995"),l={components:{avatar:r["a"],membersTransfer:n["a"]},model:{prop:"users",event:"change"},props:{users:Array,step:{type:Boolean,default:function(){return!1}},edit:{type:Boolean,default:function(){return!0}},multi:{type:Boolean,default:function(){return!0}},placement:{type:String,default:function(){return"top"}},role:{type:Boolean,default:function(){return!1}},tags:{type:Boolean,default:function(){return!1}},invest:{type:Boolean,default:function(){return!1}}},computed:{},data:function(){return{}},methods:{setUsers:function(e){this.$emit("change",e),this.$emit("SET_USERS",e)},showMemberTransfer:function(e){this.$refs[""+e].show()},removeUser:function(e){var t=this.users;t.splice(e,1)}}},o=l,u=(s("44df"),s("4ac2")),c=Object(u["a"])(o,a,i,!1,null,"45d72c07",null);t["a"]=c.exports},"44df":function(e,t,s){"use strict";s("bfe1")},"69b0":function(e,t){e.exports=Object.is||function(e,t){return e===t?0!==e||1/e===1/t:e!=e&&t!=t}},bfe1:function(e,t,s){},d91d:function(e,t,s){"use strict";var a=s("a86f"),i=s("69b0"),r=s("f417");s("c46f")("search",1,(function(e,t,s,n){return[function(s){var a=e(this),i=void 0==s?void 0:s[t];return void 0!==i?i.call(s,a):new RegExp(s)[t](String(a))},function(e){var t=n(s,e,this);if(t.done)return t.value;var l=a(e),o=String(this),u=l.lastIndex;i(u,0)||(l.lastIndex=0);var c=r(l,o);return i(l.lastIndex,u)||(l.lastIndex=u),null===c?-1:c.index}]}))},dae9:function(e,t,s){"use strict";s.r(t);var a=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-container",[a("el-header",{staticClass:"header"},[a("div",{staticClass:"header-wrap",staticStyle:{display:"flex"}},[a("div",{staticClass:"title"},[a("i",{staticClass:"iconfont icon-woshenqingde"}),e._v(" 汇报关系\n      ")]),a("div",{staticStyle:{"margin-left":"auto"}},[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){return e.showEditor()}}},[e._v("新建")])],1)])]),a("el-main",{staticClass:"main"},[a("div",{staticClass:"w-100p"},[a("el-select",{staticStyle:{"margin-right":"20px"},attrs:{placeholder:"汇报关系类型"},on:{change:function(t){return e.getList()}},model:{value:e.search.relType,callback:function(t){e.$set(e.search,"relType",t)},expression:"search.relType"}},e._l(e.enumType.UserReportingRelType,(function(e){return a("el-option",{key:e.value,attrs:{label:e.name,value:e.value}})})),1),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){return e.getList()}}},[e._v("查询")]),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){return e.generate()}}},[e._v("生成实例")])],1),e.list&&e.list.length>0?a("el-table",{staticStyle:{width:"100%","margin-top":"10px"},attrs:{data:e.list,"header-cell-style":{background:"#fdfdfd"}}},[a("el-table-column",{attrs:{prop:"visitSubject",label:"排序",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n          "+e._s(t.$index+1+(e.pageNum-1)*e.pageSize)+"\n        ")]}}],null,!1,2430471702)}),a("el-table-column",{attrs:{prop:"",label:"汇报对象",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{directives:[{name:"show",rawName:"v-show",value:t.row.dept&&t.row.dept.deptId,expression:"scope.row.dept && scope.row.dept.deptId"}]},[e._v("\n            "+e._s(t.row.dept&&t.row.dept.deptName)+"\n          ")]),a("div",{directives:[{name:"show",rawName:"v-show",value:t.row.user&&t.row.user.userId,expression:"scope.row.user && scope.row.user.userId"}]},[e._v("\n            "+e._s(t.row.user&&t.row.user.userName)+"\n          ")])]}}],null,!1,920819584)}),a("el-table-column",{attrs:{prop:"supervisor.userName",label:"上级",width:"150"}}),a("el-table-column",{attrs:{prop:"reportingType.name",label:"汇报类型",width:"200"}}),a("el-table-column",{attrs:{prop:"remark",label:"备注"}}),a("el-table-column",{attrs:{label:"操作",width:"150",fixed:"right","header-align":"center",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text"},on:{click:function(s){return e.deleteRow(t.row)}}},[e._v("删除")])]}}],null,!1,812953094)})],1):e._e(),a("div",{staticClass:"txt-right"},[e.list&&e.list.length>0?a("el-pagination",{staticStyle:{"margin-top":"20px"},attrs:{"current-page":e.pageNum,"page-sizes":[5,10,20],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}):e._e()],1),a("div",{directives:[{name:"show",rawName:"v-show",value:e.list&&0===e.list.length,expression:"list && list.length===0"}],staticClass:"w-100p gray",staticStyle:{"text-align":"center"}},[a("img",{attrs:{src:s("f244")}}),a("br"),a("span",{staticStyle:{"font-size":"14px"}},[e._v("暂无数据")]),a("br"),a("br")])],1),a("el-dialog",{attrs:{visible:e.detail.dialogVisible,width:"450px","append-to-body":!0,"show-close":!1,top:"50px","close-on-click-modal":!1,"close-on-press-escape":!1},on:{"update:visible":function(t){return e.$set(e.detail,"dialogVisible",t)}}},[a("div",{staticClass:"header",attrs:{slot:"title"},slot:"title"},[a("div",{staticClass:"title"},[a("i",{staticClass:"iconfont icon-shenpi_normal"}),e._v(" 汇报关系\n      ")]),a("div",{staticClass:"options"},[a("i",{staticClass:"iconfont icon-guanbi pointer fs-22",on:{click:function(t){e.detail.dialogVisible=!1}}})]),a("div",{staticClass:"clear"})]),a("el-form",{ref:"detail",attrs:{model:e.detail,"label-width":"120px"}},[a("el-form-item",{attrs:{label:"关系类型",prop:"relType",rules:{required:!0,message:"请选择关系类型"}}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"汇报关系类型"},model:{value:e.detail.relType,callback:function(t){e.$set(e.detail,"relType",t)},expression:"detail.relType"}},e._l(e.enumType.UserReportingRelType,(function(t){return t.value?a("el-option",{key:t.value,attrs:{label:t.name,value:t.value}}):e._e()})),1)],1),"user"===e.detail.type?a("el-form-item",{attrs:{label:"汇报对象",prop:"user",rules:{required:!0,message:"请选择汇报对象"}}},[a("div",{staticStyle:{display:"flex","align-items":"center"}},[a("el-select",{staticStyle:{"margin-right":"20px"},attrs:{placeholder:"汇报关系类型",disabled:!e.detail.typeSelected},model:{value:e.detail.type,callback:function(t){e.$set(e.detail,"type",t)},expression:"detail.type"}},e._l(e.enumType.typeList,(function(e){return a("el-option",{key:e.value,attrs:{label:e.name,value:e.value}})})),1),a("user-select",{attrs:{multi:!1,users:e.detail.user},on:{SET_USERS:function(t){e.detail.user=t}}})],1)]):e._e(),"dept"===e.detail.type?a("el-form-item",{attrs:{label:"汇报对象",prop:"deptId",rules:{required:!0,message:"请选择汇报对象"}}},[a("div",{staticStyle:{display:"flex","align-items":"center"}},[a("el-select",{staticStyle:{"margin-right":"20px"},attrs:{placeholder:"汇报关系类型",disabled:!e.detail.typeSelected},model:{value:e.detail.type,callback:function(t){e.$set(e.detail,"type",t)},expression:"detail.type"}},e._l(e.enumType.typeList,(function(e){return a("el-option",{key:e.value,attrs:{label:e.name,value:e.value}})})),1),a("el-select",{attrs:{placeholder:"请选择部门"},model:{value:e.detail.deptId,callback:function(t){e.$set(e.detail,"deptId",t)},expression:"detail.deptId"}},e._l(e.deptList,(function(t){return a("el-option",{key:t.deptId,attrs:{label:t.deptName,value:t.deptId}},[a("span",{style:{paddingLeft:10*t.level+"px"}},[e._v(e._s(t.deptName))])])})),1)],1)]):e._e(),a("el-form-item",{attrs:{label:"汇报上级",prop:"supervisor",rules:{required:!0,message:"请选择汇报上级"}}},[a("user-select",{attrs:{users:e.detail.supervisor,multi:!1},on:{SET_USERS:function(t){e.detail.supervisor=t}}})],1),a("el-form-item",{attrs:{label:"汇报类型",prop:"reportingType"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"汇报关系类型"},on:{change:e.setType},model:{value:e.detail.reportingType,callback:function(t){e.$set(e.detail,"reportingType",t)},expression:"detail.reportingType"}},e._l(e.enumType.UserReportingType,(function(t){return t.value?a("el-option",{key:t.value,attrs:{label:t.name,value:t.value}}):e._e()})),1)],1),a("el-form-item",{attrs:{label:"排序",prop:"relOrder"}},[a("el-input",{attrs:{placeholder:""},model:{value:e.detail.relOrder,callback:function(t){e.$set(e.detail,"relOrder",t)},expression:"detail.relOrder"}})],1),a("el-form-item",{attrs:{label:"备注",prop:"remark"}},[a("el-input",{attrs:{placeholder:"",type:"textarea",autosize:{minRows:2,maxRows:4}},model:{value:e.detail.remark,callback:function(t){e.$set(e.detail,"remark",t)},expression:"detail.remark"}})],1),a("el-form-item",{attrs:{label:""}},[a("div",{staticClass:"w-100p",staticStyle:{"text-align":"left"}},[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.save}},[e._v("确认")]),a("el-button",{attrs:{type:"default",size:"mini"},on:{click:function(t){e.detail.dialogVisible=!1}}},[e._v("取消")])],1)])],1)],1)],1)},i=[],r=(s("d91d"),s("b775")),n={getEnum:function(e){return Object(r["a"])({url:"/enum/"+e,method:"get"})},getList:function(e){return Object(r["a"])({url:"/admin/reportingRel/query",method:"post",data:e})},deptTree:function(e){return Object(r["a"])({url:"/admin/dept/tree",method:"get",params:e})},createReportingRel:function(e){return Object(r["a"])({url:"/admin/reportingRel/add",method:"post",params:e})},getDetail:function(e){return Object(r["a"])({url:"/admin/reportingRel/get",method:"post",data:e})},deleteRow:function(e){return Object(r["a"])({url:"/admin/reportingRel/delete/"+e,method:"post"})},generate:function(e){return Object(r["a"])({url:"/admin/reportingRel/instance/generate",method:"post",data:e})}},l=s("328f"),o={name:"",components:{userSelect:l["a"]},data:function(){return{enumType:{typeList:[{name:"人",value:"user"},{name:"部门",value:"dept"}]},search:{relType:"A"},deptList:[],list:[],pageNum:1,pageSize:10,total:10,detail:{dialogVisible:!1,supervisor:[],user:[],reportingType:"",remark:"",relType:"",relOrder:"",deptId:"",userId:"",type:"user",typeSelected:!0}}},mounted:function(){this.getList(),this.getDeptTree(),this.getEnum("UserReportingRelType"),this.getEnum("UserReportingType")},methods:{getEnum:function(e,t){var s=this;n.getEnum(e).then((function(a){200===a.code&&(t&&a.data.unshift({name:"全部",value:""}),s.$set(s.enumType,e,a.data))})).catch((function(e){console.log(e)}))},getList:function(){var e=this,t={relType:this.search.relType,pageNum:this.pageNum,pageSize:this.pageSize};n.getList(t).then((function(t){200===t.code&&(e.list=t.data.list,e.total=t.data.total)})).catch((function(e){console.log(e)}))},handleSizeChange:function(e){this.pageSize=e,this.pageNum=1,this.getList()},handleCurrentChange:function(e){this.pageNum=e,this.getList()},showEditor:function(e){this.detail={dialogVisible:!0,supervisor:[],user:[],reportingType:"",remark:"",relType:"",relOrder:"",deptId:"",userId:"",type:"user",typeSelected:!0}},getDeptTree:function(){var e=this,t={withEntRoot:!0};n.deptTree(t).then((function(t){if(200===t.code){var s=function e(t,s){for(var a in t)t[a].level=s,t[a].subDepts&&(t[a].subDepts=e(t[a].subDepts,s+1));return t};t.data.push({deptName:"外部人员",operationVisible:!1,userCount:0,subDepts:[],outerUser:!0}),t.data[0].subDepts.push({deptId:"-1",deptName:"未分配部门",operationVisible:!1,userCount:0,subDepts:[]});var a=s(t.data,0);e.deptList=e.setSelectDept(Object.assign({},a),0)}})).catch((function(e){console.log(e)}))},setSelectDept:function(e,t){var s=[];for(var a in e)s.push({deptName:e[a].deptName,deptId:e[a].deptId,level:t}),e[a].subDepts&&(e[a].subDepts=this.setSelectDept(e[a].subDepts,t+1)),s=s.concat(e[a].subDepts);return s},setType:function(){"DM"===this.detail.reportingType?(this.detail.type="dept",this.detail.typeSelected=!1):this.detail.typeSelected=!0},save:function(){var e=this,t={relOrder:this.detail.relOrder,relType:this.detail.relType,remark:this.detail.remark,reportingType:this.detail.reportingType,supervisorId:this.detail.supervisor[0].id||this.detail.supervisor[0].userId};"user"===this.detail.type?t.userId=this.detail.user[0].id||this.detail.user[0].userId:t.deptId=this.detail.deptId,n.createReportingRel(t).then((function(t){200===t.code&&(e.$message.success({message:"新增汇报关系成功",duration:1500}),e.detail.dialogVisible=!1,e.getList())})).catch((function(e){console.log(e)}))},deleteRow:function(e){var t=this;this.$confirm("即将删除汇报关系，是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){n.deleteRow(e.id).then((function(e){200===e.code&&(t.$message.success({message:"汇报关系删除成功",duration:1500}),t.getList())})).catch((function(e){console.log(e)}))})).catch((function(e){console.log(e)}))},generate:function(){var e=this,t={entId:"",relType:this.search.relType};n.generate(t).then((function(t){200===t.code&&(e.$message.success({message:"操作成功",duration:1500}),e.getList())})).catch((function(e){console.log(e)}))}}},u=o,c=s("4ac2"),d=Object(c["a"])(u,a,i,!1,null,"dc7f03dc",null);t["default"]=d.exports},f244:function(e,t){e.exports="data:image/png;base64,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"}}]);