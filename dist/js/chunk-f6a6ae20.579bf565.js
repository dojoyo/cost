(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-f6a6ae20"],{"26aa":function(e,t,s){"use strict";var r=s("b775");t["a"]={getEnum:function(e){return Object(r["a"])({url:"/enum/"+e,method:"get"})},deptTree:function(e){return Object(r["a"])({url:"/admin/dept/tree",method:"get",params:e})},deptAdd:function(e){return Object(r["a"])({url:"/admin/dept/add",method:"post",data:e})},deptDelete:function(e){return Object(r["a"])({url:"/admin/dept/"+e+"/delete",method:"post"})},deptDetail:function(e){return Object(r["a"])({url:"/admin/dept/"+e+"/detail",method:"post"})},deptEdit:function(e,t){return Object(r["a"])({url:"/admin/dept/"+t+"/edit",method:"post",data:e})},deptMembers:function(e,t){return Object(r["a"])({url:"/admin/dept/"+t+"/moveUsers",method:"post",data:e})},deptMove:function(e,t){return Object(r["a"])({url:"/admin/dept/"+t+"/move",method:"post",data:e})},deptRename:function(e,t){return Object(r["a"])({url:"/admin/dept/"+t+"/rename",method:"post",data:e})},userAdd:function(e){return Object(r["a"])({url:"/admin/user/add",method:"post",data:e})},userImportTemplate:function(e){return Object(r["a"])({url:"/admin/user/importTemplate",method:"post",data:e,responseType:"arraybuffer"})},saveUserImport:function(e){return Object(r["a"])({url:"/admin/user/batchImport/save",method:"post",data:e,headers:{"Content-Type":"application/json; charset=utf-8"}})},exportMembers:function(){return Object(r["a"])({url:"/admin/user/batchExport",method:"post",responseType:"arraybuffer"})},userList:function(e){return Object(r["a"])({url:"/admin/user/list",method:"post",data:e})},userSearch:function(e){return Object(r["a"])({url:"/contacts/userSearch",method:"get",params:e})},userTeam:function(e){return Object(r["a"])({url:"/admin/user/team",method:"post",data:e})},userDept:function(e){return Object(r["a"])({url:"/admin/dept/users",method:"get",params:e})},userDeptTree:function(e){return Object(r["a"])({url:"/contacts/deptUserTree",method:"get",params:e})},userDisableList:function(e){return Object(r["a"])({url:"/admin/user/disabled/page",method:"post",data:e})},userDetail:function(e){return Object(r["a"])({url:"/admin/user/"+e,method:"get"})},userEdit:function(e,t){return Object(r["a"])({url:"/admin/user/"+t+"/edit",method:"post",data:e})},userDisable:function(e){return Object(r["a"])({url:"/admin/user/"+e+"/disable",method:"post"})},userEnable:function(e){return Object(r["a"])({url:"/admin/user/"+e+"/enable",method:"post"})},userResetPwd:function(e,t){return Object(r["a"])({url:"/admin/user/"+t+"/resetPwd",method:"post",data:e})},userAccountResetPwd:function(e){return Object(r["a"])({url:"/account/modify/password",method:"post",data:e})},jobsList:function(){return Object(r["a"])({url:"/admin/position/list",method:"post"})},jobsAdd:function(e){return Object(r["a"])({url:"/admin/position/add",method:"post",data:e})},jobsDelete:function(e){return Object(r["a"])({url:"/admin/position/"+e+"/delete",method:"post"})},jobsEdit:function(e,t){return Object(r["a"])({url:"/admin/position/"+t+"/edit",method:"post",data:e})},jobsMove:function(e,t){return Object(r["a"])({url:"/admin/position/"+t+"/sort",method:"post",data:e})},getInvestUser:function(e){return Object(r["a"])({url:"/ivf/user/list",method:"post",data:e})},getInvestDept:function(e){return Object(r["a"])({url:e||"/ivf/common/userTree",method:"get"})}}},3112:function(e,t,s){"use strict";s("3db8")},3528:function(e,t,s){"use strict";var r=s("b775");t["a"]={roleTree:function(e){return Object(r["a"])({url:"/admin/role/grantTree",method:"post",data:e})},roleAdd:function(e){return Object(r["a"])({url:"/admin/role/add",method:"post",data:e})},roleAddGroup:function(e){return Object(r["a"])({url:"/admin/role/addGroup",method:"post",data:e})},roleDetail:function(e){return Object(r["a"])({url:"/admin/role/"+e,method:"get"})},roleEdit:function(e,t){return Object(r["a"])({url:"/admin/role/"+t+"/edit",method:"post",data:e})},roleDelete:function(e){return Object(r["a"])({url:"/admin/role/"+e+"/delete",method:"post"})},roleMove:function(e,t){return Object(r["a"])({url:"/admin/role/"+t+"/move",method:"post",data:e})},roleUser:function(e){return Object(r["a"])({url:"/admin/role/"+e+"/users",method:"post"})},roleMembers:function(e,t){return Object(r["a"])({url:"/admin/role/"+t+"/assignUsers",method:"post",data:e})},roleMembersRemove:function(e,t){return Object(r["a"])({url:"/admin/role/"+t+"/removeUsers",method:"post",data:e})},roleResources:function(e){return Object(r["a"])({url:"/admin/role/"+e+"/grantResources",method:"get"})},roleScope:function(e){return Object(r["a"])({url:"/admin/role/"+e+"/grantScope",method:"get"})},saveResources:function(e,t){return Object(r["a"])({url:"/admin/role/"+t+"/resources/update",method:"post",data:e})},saveScope:function(e,t){return Object(r["a"])({url:"/admin/role/"+t+"/scope/update",method:"post",data:e,headers:{"Content-Type":"application/json; charset=utf-8"}})},groupRename:function(e,t){return Object(r["a"])({url:"/admin/role/renameGroup/"+t,method:"post",data:e})},groupDelete:function(e){return Object(r["a"])({url:"/admin/role/deleteGroup/"+e,method:"post"})}}},"3db8":function(e,t,s){},8995:function(e,t,s){"use strict";var r=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("el-dialog",{staticClass:"members-wrap",attrs:{visible:e.dialogVisible,width:"600px","show-close":!1,"append-to-body":!0,top:"50px","close-on-click-modal":!1,"close-on-press-escape":!1},on:{"update:visible":function(t){e.dialogVisible=t}}},[s("div",{staticClass:"header",attrs:{slot:"title"},slot:"title"},[s("div",{staticClass:"title"},[s("i",{staticClass:"iconfont icon-chengyuanjianbao1 primary"}),e._v(" 选择成员\n    ")]),s("div",{staticClass:"options"},[s("i",{staticClass:"iconfont icon-guanbi pointer fs-22",on:{click:function(t){e.dialogVisible=!1}}})]),s("div",{staticClass:"clear"})]),s("div",{staticClass:"members-body"},[s("div",{staticClass:"from"},[s("div",{staticClass:"tab"},e._l(e.tabs,(function(t,r){return t.visible?s("div",{key:r,staticClass:"title",class:{on:t.code===e.curTab.code},on:{click:function(t){return e.setTab(r)}}},[e._v(e._s(t.name)+"\n        ")]):e._e()})),0),s("div",{directives:[{name:"show",rawName:"v-show",value:"team"===e.curTab.code,expression:"curTab.code==='team'"}],staticClass:"content"},[s("div",{staticClass:"search"},[s("el-input",{attrs:{placeholder:"搜索成员","prefix-icon":"el-icon-search",size:"mini"},on:{input:e.resetUserList},model:{value:e.searchKey,callback:function(t){e.searchKey=t},expression:"searchKey"}})],1),s("div",{staticStyle:{width:"100%",height:"50px"}}),e._l(e.tabs[0].data,(function(t,r){return s("div",{key:r,staticClass:"item",on:{click:function(s){return e.pickUser(t,r)}}},[s("avatar",{attrs:{user:t}}),s("span",{staticClass:"name"},[e._v(e._s(t.userName))]),s("i",{directives:[{name:"show",rawName:"v-show",value:t.checked,expression:"item.checked"}],staticClass:"iconfont icon-wanchengx"})],1)}))],2),s("div",{directives:[{name:"show",rawName:"v-show",value:"dept"===e.curTab.code,expression:"curTab.code==='dept'"}],staticClass:"content"},[s("div",{staticStyle:{width:"100%",height:"15px"}}),e.curTab.showTree?s("el-tree",{ref:"dept",attrs:{data:e.tabs[1].data,props:e.defaultDeptProps,"node-key":"id"},on:{"node-click":e.pickUserDept},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.node,a=t.data;return s("div",{staticClass:"custom-tree-node"},[a.noAvatar?e._e():s("div",{staticClass:"short"},[s("avatar",{attrs:{user:a}})],1),s("div",{staticClass:"name"},[s("span",{staticStyle:{"margin-right":"auto"}},[e._v(e._s(r.label))]),s("span",{directives:[{name:"show",rawName:"v-show",value:a.deptId&&e.multi,expression:"data.deptId && multi"}],staticClass:"add",on:{click:function(e){e.stopPropagation()}}},[s("i",{staticClass:"iconfont icon-tianjia2",on:{click:function(t){return e.selectDept(a)}}})])]),s("div",{directives:[{name:"show",rawName:"v-show",value:a.checked,expression:"data.checked"}]},[s("i",{staticClass:"iconfont icon-check"})])])}}],null,!1,1788800427)}):e._e()],1),s("div",{directives:[{name:"show",rawName:"v-show",value:"role"===e.curTab.code,expression:"curTab.code==='role'"}],staticClass:"content"},[s("div",{staticStyle:{width:"100%",height:"15px"}}),e.curTab.showTree?s("el-tree",{ref:"role",attrs:{data:e.tabs[2].data,props:e.defaultRoleProps,"node-key":"id"},on:{"node-click":e.pickUserRole},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.node,a=t.data;return s("div",{staticClass:"custom-tree-node"},[s("span",[e._v(e._s(r.label))]),s("div",{directives:[{name:"show",rawName:"v-show",value:a.checked,expression:"data.checked"}],staticStyle:{"margin-left":"auto"}},[s("i",{staticClass:"iconfont icon-check"})])])}}],null,!1,37183184)}):e._e()],1)]),s("div",{staticClass:"result",class:{step:e.step}},[s("div",{staticClass:"tab"},[e._v("已选择成员")]),s("div",{staticClass:"content"},[s("div",{staticStyle:{width:"100%",height:"15px"}}),e._l(e.result,(function(t,r){return s("div",{key:r,staticClass:"item",class:{last:r===e.result.length-1}},[s("avatar",{attrs:{user:t}}),s("span",{staticClass:"name"},[e._v(e._s(t.userName))]),s("i",{staticClass:"iconfont icon-x1 pointer",on:{click:function(t){return e.removeResult(r)}}}),s("div",{staticClass:"line"})],1)}))],2)])]),s("div",{staticClass:"members-footer"},[s("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.save}},[e._v("确认")]),s("el-button",{attrs:{type:"default",size:"mini"},on:{click:e.cancel}},[e._v("取消")])],1)])},a=[],i=s("7150"),n=s("26aa"),o=s("3528"),u=s("ed08"),d={name:"MemberPanelTransfer",components:{avatar:i["a"]},props:{users:Array,multi:{type:Boolean,default:function(){return!0}},step:{type:Boolean,default:function(){return!1}},role:{type:Boolean,default:function(){return!1}},invest:{type:Boolean,default:function(){return!1}},filter:{type:Array,default:function(){return[]}}},computed:{userList:function(){return this.$store.getters.userList},userDeptList:function(){return this.$store.getters.userDeptList},userRoleList:function(){return this.$store.getters.userRoleList}},data:function(){return{searchKey:"",defaultDeptProps:{children:"children",label:"userName"},defaultRoleProps:{children:"roles",label:"groupName"},tabs:[{name:"团队",type:"list",code:"team",visible:!0,data:[]},{name:"部门",type:"tree",code:"dept",visible:!0,showTree:!0},{name:"角色",type:"tree",code:"role",visible:!1,showTree:!0}],curTab:{},result:[],showTree:!0,dialogVisible:!1}},mounted:function(){this.init()},methods:{init:function(){var e=this;if(this.invest){this.tabs=[{name:"团队",type:"list",code:"team",visible:!1,data:[]},{name:"部门",type:"tree",code:"dept",visible:!0,showTree:!0},{name:"角色",type:"tree",code:"role",visible:!1,showTree:!0}];var t="/ivf/common/userTree";this.filter&&this.filter.length>0&&(t+="?",this.filter.map((function(e){t+="filterUserIds="+e+"&"}))),n["a"].getInvestDept(t).then((function(t){200===t.code?(e.tabs[1].data=e.setDeptTree(t.data),e.setTab(1)):e.$message.warning({message:t.msg,duration:1500})})).catch((function(t){e.$message.error({message:JSON.stringify(t),duration:1500})}))}else{if(this.userList)this.tabs[0].data=JSON.parse(this.userList),this.setTab(0);else{var s={filter:""};n["a"].userSearch(s).then((function(t){200===t.code?(t.data.map((function(e){e.id=e.userId})),e.$store.dispatch("SetUserList",JSON.stringify(t.data)),e.tabs[0].data=t.data,e.setTab(0)):e.$message.warning({message:t.msg,duration:1500})})).catch((function(t){e.$message.error({message:JSON.stringify(t),duration:1500})}))}this.userDeptList?this.tabs[1].data=this.setDeptTree(JSON.parse(this.userDeptList)):n["a"].userDeptTree({}).then((function(t){200===t.code?(e.$store.dispatch("SetUserDeptList",JSON.stringify(t.data)),e.tabs[1].data=e.setDeptTree(t.data)):e.$message.warning({message:t.msg,duration:1500})})).catch((function(t){e.$message.error({message:JSON.stringify(t),duration:1500})})),this.role&&(this.tabs[2].visible=!0,this.userRoleList?this.tabs[2].data=this.setRoleTree(JSON.parse(this.userRoleList)):o["a"].roleTree({groupType:"AP"}).then((function(t){200===t.code?(e.$store.dispatch("SetUserRoleList",JSON.stringify(t.data)),e.tabs[2].data=e.setRoleTree(t.data)):e.$message.warning({message:t.msg,duration:1500})})).catch((function(t){e.$message.error({message:JSON.stringify(t),duration:1500})})))}},setDeptTree:function(e){var t=[];for(var s in e)if(e[s].subDepts&&e[s].subDepts.length>0&&(e[s].subDepts=this.setDeptTree(e[s].subDepts)),t.push({userName:e[s].deptName,noAvatar:!0,children:e[s].subDepts,deptId:e[s].deptId}),e[s].users&&e[s].users.length>0)for(var r in e[s].users)e[s].users.checked=!1,t[s].children.unshift(e[s].users[r]);return t},setRoleTree:function(e){for(var t in e)e[t].groupName=e[t].groupName||e[t].roleName,e[t].id=e[t].id||e[t].groupId,e[t].roles&&e[t].roles.length>0&&this.setRoleTree(e[t].roles);return e},setTab:function(e){this.curTab=this.tabs[e],this.setTags()},resetUserList:function(){var e=this,t={filter:this.searchKey};this.invest?(t={pageSize:500,pageNum:1,search:this.searchKey},n["a"].getInvestUser(t).then((function(t){200===t.code?(t.data.list.map((function(e){e.userId=e.id})),e.tabs[0].data=t.data.list,e.setTab(0)):e.$message.warning({message:t.msg,duration:1500})})).catch((function(t){e.$message.error({message:JSON.stringify(t),duration:1500})}))):n["a"].userSearch(t).then((function(t){200===t.code?(t.data.map((function(e){e.id=e.userId})),e.tabs[0].data=t.data,e.setTags()):e.$message.warning({message:t.msg,duration:1500})})).catch((function(t){e.$message.error({message:JSON.stringify(t),duration:1500})}))},setTags:function(){switch(this.curTab.code){case"team":this.resetTeamTags();break;case"dept":this.resetDeptTags();break;case"role":this.resetRoleTags();break}},resetTeamTags:function(){for(var e in this.tabs[0].data.map((function(e){e.checked=!1})),this.result)for(var t in this.tabs[0].data)this.tabs[0].data[t].checked||(this.tabs[0].data[t].checked=this.tabs[0].data[t].id===this.result[e].id||this.tabs[0].data[t].id===this.result[e].userId)},resetDeptTags:function(){this.tabs[1].data=this.setTreeChecked(this.tabs[1].data,!0),this.tabs[1].data=this.setTreeChecked(this.tabs[1].data,!1)},setTreeChecked:function(e,t){var s=e;for(var r in s)if(s[r].noAvatar&&s[r].children&&s[r].children.length>0)this.setTreeChecked(s[r].children,t);else if(t)s[r].checked=!1;else for(var a in this.result)s[r].checked||s[r].userId!==this.result[a].id&&s[r].userId!==this.result[a].userId||(s[r].checked=!0);return s},resetRoleTags:function(){this.tabs[2].data=this.setRoleTreeChecked(this.tabs[2].data,!0),this.tabs[2].data=this.setRoleTreeChecked(this.tabs[2].data,!1)},setRoleTreeChecked:function(e,t){var s=e;for(var r in s)if(s[r].groupId&&s[r].roles&&s[r].roles.length>0)this.setRoleTreeChecked(s[r].roles,t);else if(t)s[r].checked=!1;else for(var a in this.result)s[r].checked||s[r].id!==this.result[a].id&&s[r].id!==this.result[a].userId||(s[r].checked=!0);return s},pickUser:function(e,t){if(this.multi){for(var s in this.result)if(this.result[s].id===e.id||this.result[s].userId===e.id)return this.result.splice(s,1),void(this.tabs[0].data[t].checked=!1);this.result.push(e),this.tabs[0].data[t].checked=!0}else!this.result[0]||this.result[0].userId!==e.id&&this.result[0].id!==e.id?(this.result=[],this.result.push(e)):this.result=[],this.setTags()},pickUserDept:function(e){if(!e.noAvatar){if(this.curTab.showTree=!1,this.multi){for(var t in this.result)if(this.result[t].id===e.userId||this.result[t].userId===e.userId)return e.checked=!1,this.result.splice(t,1),void this.$set(this.curTab,"showTree",!0);e.checked=!0,this.result.push(e)}else!this.result[0]||this.result[0].userId!==e.userId&&this.result[0].id!==e.userId?(this.result=[],this.result.push(e)):this.result=[],this.setTags();this.$set(this.curTab,"showTree",!0)}},pickUserRole:function(e){if(!e.groupId){for(var t in this.result)if(this.result[t].id===e.id||this.result[t].userId===e.id)return e.checked=!1,void this.result.splice(t,1);e.checked=!0,e.userName=e.roleName,this.result.push(e)}},removeResult:function(e){this.result.splice(e,1),this.setTags()},selectDept:function(e){e=this.setDeptChildrenChecked(e),this.setTags()},setDeptChildrenChecked:function(e){if(e.children&&e.children.length>0)for(var t in e.children)if(e.children[t].noAvatar)this.setDeptChildrenChecked(e.children[t]);else{e.children[t].checked=!0;var s=!0;for(var r in this.result)this.result[r].id!==e.children[t].userId&&this.result[r].userId!==e.children[t].userId||(s=!1);s&&this.result.push(e.children[t])}return e},show:function(){this.result=u["a"].deepCopy(this.users)||[],this.init(),this.dialogVisible=!0},save:function(){this.dialogVisible=!1,this.$emit("SAVE_USERS",this.result)},cancel:function(){this.dialogVisible=!1}}},c=d,l=(s("3112"),s("4ac2")),h=Object(l["a"])(c,r,a,!1,null,null,null);t["a"]=h.exports}}]);