(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2f369b43","chunk-0ef90e38","chunk-2d0e4a8c"],{"0d08":function(t,e,a){"use strict";a("470a")},3087:function(t,e,a){"use strict";a("bca3")},"470a":function(t,e,a){},4721:function(t,e,a){},"69af":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"tips-title"},[t._v("\n    "+t._s(t.title)+"\n  ")]),a("div",{staticClass:"form-content",staticStyle:{"margin-top":"15px"}},[a("el-form",{ref:"data",attrs:{model:t.data,"label-width":"0"}},[a("el-form-item",{attrs:{label:"",prop:"description"}},[a("el-input",{attrs:{type:"textarea",autosize:{minRows:4,maxRows:6},placeholder:""},model:{value:t.data.description,callback:function(e){t.$set(t.data,"description",e)},expression:"data.description"}})],1)],1)],1)])},o=[],l={name:"",components:{},props:{data:{type:Object,default:function(){return{}}},title:{type:String,default:function(){return"相关说明"}}},methods:{}},s=l,n=(a("3087"),a("4ac2")),r=Object(n["a"])(s,i,o,!1,null,"2f60d672",null);e["default"]=r.exports},"8d4e":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-dialog",{attrs:{visible:t.dialogVisible,width:"850px","append-to-body":!0,"show-close":!1,top:"50px","close-on-click-modal":!1,"close-on-press-escape":!1},on:{"update:visible":function(e){t.dialogVisible=e}}},[a("div",{staticClass:"header",attrs:{slot:"title"},slot:"title"},[a("div",{staticClass:"title"},[a("i",{staticClass:"iconfont icon-xiangmuguanli"}),t._v(" "+t._s(t.detail.bizForm&&t.detail.bizForm.itemName||"内核申请")+"\n    ")]),a("div",{staticClass:"options",staticStyle:{display:"flex","align-items":"center"}},[a("el-button",{directives:[{name:"show",rawName:"v-show",value:!t.approveDetail.approvalId,expression:"!approveDetail.approvalId"}],attrs:{type:"default",size:"small"},on:{click:function(e){return t.submit("TS")}}},[t._v("暂存")]),a("el-button",{directives:[{name:"show",rawName:"v-show",value:!t.approveDetail.approvalId,expression:"!approveDetail.approvalId"}],staticStyle:{"margin-right":"20px"},attrs:{type:"primary",size:"small"},on:{click:function(e){return t.submit("CA")}}},[t._v("提交")]),a("el-button",{directives:[{name:"show",rawName:"v-show",value:t.approveDetail.approvalId,expression:"approveDetail.approvalId"}],staticStyle:{"margin-right":"20px"},attrs:{type:"primary",size:"small"},on:{click:function(e){t.submit(t.approveDetail.approvalState&&"DR"===t.approveDetail.approvalState.value?"CA":"RA")}}},[t._v("确认")]),a("i",{staticClass:"iconfont icon-guanbi pointer fs-22",on:{click:function(e){return t.hideDialog()}}})],1),a("div",{staticClass:"clear"})]),t.detail.bizForm?a("div",{staticClass:"main-wrap"},[a("el-scrollbar",{style:{height:t.height}},[a("el-form",{ref:"detail",attrs:{model:t.detail,"label-width":"140px"}},[a("div",{staticClass:"wrap"},[a("div",{staticClass:"center-title",staticStyle:{display:"flex","align-items":"center",padding:"0 15px 15px"}},[a("div",{staticStyle:{"word-break":"keep-all"}},[t._v("标题：")]),a("el-input",{attrs:{placeholder:""},model:{value:t.detail.approvalTitle,callback:function(e){t.$set(t.detail,"approvalTitle",e)},expression:"detail.approvalTitle"}})],1),a("div",{staticClass:"tips-title"},[t._v("基本信息")]),a("el-row",{staticClass:"msg-table",staticStyle:{"padding-top":"15px"}},[a("el-col",{staticClass:"label",attrs:{span:4}},[t._v("项目名称：")]),a("el-col",{staticClass:"content",attrs:{span:6}},[t._v("   "+t._s(t.detail.bizForm.projectName))]),a("el-col",{staticClass:"label",attrs:{span:6}},[t._v("项目类型：")]),a("el-col",{staticClass:"content",attrs:{span:8}},[t._v("  "+t._s(t.detail.bizForm.projectType&&t.detail.bizForm.projectType.name))])],1)],1),a("div",{staticClass:"wrap"},[a("files",{attrs:{files:t.detail.bizForm.ddDrafts,title:"尽调底稿"},on:{UPLOAD_FILE:function(e){t.detail.bizForm.ddDrafts=e}}})],1),a("div",{staticClass:"wrap",staticStyle:{"margin-top":"15px"}},[a("div",{staticClass:"tips-title"},[t._v("内核资料")]),a("div",{staticClass:"table-wrap"},[a("div",{staticClass:"header"},[a("div",{staticStyle:{width:"30%","text-align":"center"}},[t._v("资料分类")]),a("div",{staticStyle:{width:"50%","text-align":"center"}},[t._v("文档")]),a("div",{staticStyle:{width:"20%","text-align":"center"}},[t._v("操作")])]),t._l(t.detail.bizForm.materials,(function(e,i){return a("div",{key:i,staticClass:"content"},[a("div",{staticStyle:{width:"30%","justify-content":"center"}},[t._v(t._s(e.materialType&&e.materialType.name))]),a("div",{staticClass:"child-no-border",staticStyle:{width:"50%","justify-content":"center"}},[a("file-upload",{attrs:{icon:"none",files:e.materialAttachs},on:{UPLOAD_FILE:function(t){e.materialAttachs=t}}})],1),a("div",{staticClass:"child-no-border",staticStyle:{width:"20%"}},[a("file-upload",{attrs:{icon:"icon",list:!1,tag:"invest",files:e.materialAttachs},on:{UPLOAD_FILE:function(t){e.materialAttachs=t}}})],1)])}))],2)]),a("div",{staticClass:"wrap"},[a("remark",{attrs:{data:t.detail.bizForm}})],1),a("div",{directives:[{name:"show",rawName:"v-show",value:"MA"!==t.detail.bizForm.projectInvestType.value&&"PE"!==t.detail.bizForm.projectInvestType.value&&"VC"!==t.detail.bizForm.projectInvestType.value,expression:"detail.bizForm.projectInvestType.value!=='MA' && detail.bizForm.projectInvestType.value!=='PE' && detail.bizForm.projectInvestType.value!=='VC'"}],staticClass:"wrap"},[a("files",{attrs:{files:t.detail.bizForm.attaches},on:{UPLOAD_FILE:function(e){t.detail.bizForm.attaches=e}}}),a("div",{staticClass:"file-example-wrap"},[a("div",{staticClass:"title"},[t._v("参考模版")]),a("file-upload",{attrs:{edit:!1,files:t.formTemplates}})],1)],1),a("div",{staticClass:"wrap"},[a("approve",{attrs:{data:t.detail},on:{SET_NODE_USERS:function(e){t.detail.approvalNodes=e},SET_CC_USERS:function(e){t.detail.ccUsers=e}}})],1)])],1)],1):t._e(),t.showInnerDialog?a("recall-dialog",{attrs:{visible:t.showInnerDialog},on:{"update:visible":function(e){t.showInnerDialog=e},confirm:function(e){return t.submit("RA",e)}}}):t._e()],1)},o=[],l=a("b62b"),s=a("90ba"),n=a("7218"),r=a("69af"),c=a("ff5a"),p=a("0a92"),d=a("328f"),u=a("ed08"),m={name:"",components:{RecallDialog:s["default"],fileUpload:n["a"],remark:r["default"],files:c["default"],approve:p["default"],userSelect:d["a"]},props:{id:{type:String,default:function(){return""}},templateCode:{type:String,default:function(){return"DD04"}}},data:function(){return{enumType:{},itemId:"",dialogVisible:!1,detail:{},height:"",formTemplates:[],approveDetail:{},showInnerDialog:!1}},mounted:function(){this.height=document.body.clientHeight-200+"px",this.getEnum("InvestWay"),this.getEnum("ProjectFundSource"),this.getEnum("InvestCcy"),this.getEnum("ProjectFundSource")},methods:{getEnum:function(t,e){var a=this;l["a"].getEnum(t).then((function(i){200===i.code&&(e&&i.data.unshift({name:"全部",value:""}),a.$set(a.enumType,t,i.data))})).catch((function(t){console.log(t)}))},show:function(t){t.itemId?(this.itemId=t.itemId,t.completeStatus&&"DR"===t.completeStatus.value?this.initParamsByDraft(t):this.initParams(t)):(this.approveDetail=t,this.initParamsByBiz(t.bizForm.bizId))},initParams:function(t){var e=this;this.itemId=t.itemId;var a={itemId:t.itemId,projectId:this.id,templateCode:t.templateCode};l["a"].initProjectCoreApply(a).then((function(t){if(200===t.code){var a=[];t.data.approvalNodes.map((function(t){t.nodeType&&"CN"!==t.nodeType.value&&a.push({userName:t.approvalUser&&t.approvalUser.userName||t.nodeName,nodeRefId:t.approvalUser&&t.approvalUser.userId,nodeId:t.nodeInstanceId,nodeType:t.nodeType&&t.nodeType.value,userId:t.nodeRefId||t.id,userTag:t.nodeName,nodeName:t.nodeName})})),t.data.approvalNodes=a,t.data.urgencyLvl=t.data.urgencyLvl.value,e.detail=t.data,e.dialogVisible=!0,e.getFormTemplates()}})).catch((function(t){console.log(t)}))},initParamsByDraft:function(t){var e=this;l["a"].initProjectCoreApplyDraft(t.itemId).then((function(t){200===t.code&&e.formatData(t)})).catch((function(t){console.log(t)}))},initParamsByBiz:function(t){var e=this;l["a"].initProjectCoreApplyBiz(t).then((function(t){if(200===t.code){var a={data:{approvalTitle:e.approveDetail.approvalTitle,approvalId:e.approveDetail.approvalId,approvalNodes:e.approveDetail.approvalNodes,ccUsers:e.approveDetail.ccUsers,templateCode:e.approveDetail.templateCode,urgencyLvl:e.approveDetail.urgencyLvl,approvalType:e.approveDetail.approvalType,bizForm:t.data}};e.formatData(a)}})).catch((function(t){console.log(t)}))},formatData:function(t){var e=[];t.data.approvalNodes.map((function(t){t.nodeType&&"CN"!==t.nodeType.value&&e.push({userName:t.approvalUser&&t.approvalUser.userName||t.nodeName,nodeRefId:t.approvalUser&&t.approvalUser.userId,nodeId:t.nodeInstanceId,nodeType:t.nodeType&&t.nodeType.value,userId:t.nodeRefId||t.id,userTag:t.nodeName,nodeName:t.nodeName})})),t.data.approvalNodes=e,t.data.urgencyLvl=t.data.urgencyLvl.value,this.detail=t.data,this.dialogVisible=!0,this.getFormTemplates()},hideDialog:function(){this.$refs["detail"].clearValidate(),this.dialogVisible=!1},setApprovalNodes:function(t){for(var e in t)t[e].nodeRefId=t[e].nodeRefId||t[e].id||t[e].userId,t[e].nodeType=t[e].nodeType||"UN",t[e].userId=t[e].nodeRefId||t[e].id,t[e].userTag=t[e].userTag||"审批人",t[e].nodeName=t[e].userTag||"审批人";this.detail.approvalNodes=t},getFormTemplates:function(){var t=this,e={projectType:this.detail.bizForm.projectInvestType.value,templateCode:this.templateCode};l["a"].getFormTemplates(e).then((function(e){200===e.code&&(t.formTemplates=e.data)})).catch((function(t){console.log(t)}))},submit:function(t,e){var a=this;this.$refs["detail"].validate((function(i){if(i){var o=u["a"].deepCopy(a.detail),s={};s.submitType=t,s.templateCode=a.templateCode,s.urgencyLvl=o.urgencyLvl,o.approvalId&&(s.approvalId=o.approvalId),o.approvalTitle&&(s.approvalTitle=o.approvalTitle),o.approvalType&&"FX"!==o.approvalType.value&&(s.approvalNodes=o.approvalNodes,s.ccUserIds=function(){var t=[];return o.ccUsers.map((function(e){t.push(e.id||e.userId)})),t}()),o.bizForm.projectId=a.id||o.bizForm.projectId,o.bizForm.itemId=a.itemId||o.bizForm.itemId,o.bizForm.materials.map((function(t){t.materialType=t.materialType.value})),o.bizForm.coreMaterials=o.bizForm.materials,s.bizForm=o.bizForm,"RA"!==t||"RJ"!==a.approveDetail.currentNode.nodeState.value||e?"RA"===t&&"RJ"===a.approveDetail.currentNode.nodeState.value&&e?(s.resubmitOpt={nodeInstanceId:a.approveDetail.currentNode.nodeInstanceId,opinion:e.opinion,strategy:e.strategy},l["a"].createProjectCoreApply(s).then((function(t){200===t.code&&(a.$message.success({message:"重新提交成功！",duration:1500}),a.$emit("REFRESH"),a.hideDialog())})).catch((function(t){console.log(t)}))):l["a"].createProjectCoreApply(s).then((function(t){200===t.code&&(a.$message.success({message:"提交成功！",duration:1500}),a.$emit("REFRESH"),a.hideDialog())})).catch((function(t){console.log(t)})):a.showInnerDialog=!0}}))}}},v=m,f=(a("0d08"),a("9b6b"),a("4ac2")),h=Object(f["a"])(v,i,o,!1,null,"10c834a5",null);e["default"]=h.exports},"90ba":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-dialog",{attrs:{"append-to-body":!0,"close-on-click-modal":!1,"close-on-press-escape":!1,"show-close":!1,visible:t.dialogVisible,top:"50px",width:"500px"}},[a("div",{staticClass:"header",attrs:{slot:"title"},slot:"title"},[a("div",{staticClass:"title"},[t._v("驳回流程走向")]),a("div",{staticClass:"options"},[a("i",{staticClass:"iconfont icon-guanbi pointer fs-22",on:{click:t.close}})]),a("div",{staticClass:"clear"})]),a("el-form",{attrs:{model:t.form,"label-position":"left","label-width":"85px"}},[a("el-form-item",{attrs:{label:"","label-width":"0"}},[a("el-radio-group",{model:{value:t.form.strategy,callback:function(e){t.$set(t.form,"strategy",e)},expression:"form.strategy"}},t._l(t.recallWays,(function(e){return a("el-radio",{key:e.name,attrs:{label:e.label}},[t._v(t._s(e.name))])})),1)],1),a("el-form-item",{attrs:{label:"","label-width":"0"}},[a("el-input",{attrs:{autosize:{minRows:4,maxRows:6},placeholder:"请填写审批意见(非必填)",type:"textarea"},model:{value:t.form.opinion,callback:function(e){t.$set(t.form,"opinion",e)},expression:"form.opinion"}})],1)],1),a("div",{staticClass:"w-100p txt-right",staticStyle:{"margin-top":"20px"}},[a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:t.confirm}},[t._v("确定")])],1)],1)},o=[],l=(a("b429"),{name:"RecallDialog",props:{visible:{type:Boolean,default:!1},approvalId:{type:String,default:""},nodeInstanceId:{type:String,default:""}},computed:{dialogVisible:function(){return this.visible}},data:function(){return{recallWays:[{name:"回到原驳回人",label:"RN"},{name:"重新依次审批",label:"SN"}],form:{strategy:"RN",opinion:""}}},methods:{confirm:function(){this.$emit("confirm",this.form),this.close()},close:function(){this.$emit("update:visible",!1)}}}),s=l,n=a("4ac2"),r=Object(n["a"])(s,i,o,!1,null,null,null);e["default"]=r.exports},"9b6b":function(t,e,a){"use strict";a("d993")},"9efb":function(t,e,a){"use strict";a("4721")},bca3:function(t,e,a){},d993:function(t,e,a){},ff5a:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"tips-title"},[t._v("\n    "+t._s(t.title)+"\n    "),a("div",{staticClass:"button"},[a("file-upload",{attrs:{icon:"icon",files:t.files,list:!1,tag:"invest"},on:{UPLOAD_FILE:function(e){return t.$emit("UPLOAD_FILE",e)}}})],1)]),a("div",{staticClass:"form-content",staticStyle:{"margin-top":"15px"}},[a("file-upload",{attrs:{icon:"none",files:t.files}})],1)])},o=[],l=a("7218"),s={name:"",components:{fileUpload:l["a"]},props:{data:{type:Object,default:function(){return{}}},title:{type:String,default:function(){return"相关附件"}},files:{type:Array,default:function(){return[]}}}},n=s,r=(a("9efb"),a("4ac2")),c=Object(r["a"])(n,i,o,!1,null,"528bda6b",null);e["default"]=c.exports}}]);